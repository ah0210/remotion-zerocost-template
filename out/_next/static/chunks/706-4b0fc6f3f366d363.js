"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{662:(e,t,r)=>{r.d(t,{V:()=>i});let i=e=>{let t=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isWebM?"webm":"x-matroska");if(e.codecStrings.length>0){let r=[...new Set(e.codecStrings.filter(Boolean))];t+=`; codecs="${r.join(", ")}"`}return t}},815:(e,t,r)=>{r.d(t,{ai:()=>eQ});var i=r(5155),a=r(697),n=r(2115),s=r(3722),o=()=>(0,i.jsx)("svg",{width:25,height:25,viewBox:"0 0 25 25",fill:"none",children:(0,i.jsx)("path",{d:"M8 6.375C7.40904 8.17576 7.06921 10.2486 7.01438 12.3871C6.95955 14.5255 7.19163 16.6547 7.6875 18.5625C9.95364 18.2995 12.116 17.6164 14.009 16.5655C15.902 15.5147 17.4755 14.124 18.6088 12.5C17.5158 10.8949 15.9949 9.51103 14.1585 8.45082C12.3222 7.3906 10.2174 6.68116 8 6.375Z",fill:"white",stroke:"white",strokeWidth:"6.25",strokeLinejoin:"round"})}),l=()=>(0,i.jsxs)("svg",{viewBox:"0 0 100 100",width:25,height:25,children:[(0,i.jsx)("rect",{x:"25",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"}),(0,i.jsx)("rect",{x:"55",y:"20",width:"20",height:"60",fill:"#fff",ry:"5",rx:"5"})]}),c=e=>{let{isFullscreen:t}=e,r=3*!t,a=t?9.600000000000001:3,n=t?9.600000000000001:12;return(0,i.jsxs)("svg",{viewBox:"0 0 ".concat(32," ").concat(32),height:16,width:16,children:[(0,i.jsx)("path",{d:"\n				M ".concat(r," ").concat(n,"\n				L ").concat(a," ").concat(a,"\n				L ").concat(n," ").concat(r,"\n				"),stroke:"#fff",strokeWidth:6,fill:"none"}),(0,i.jsx)("path",{d:"\n				M ".concat(32-r," ").concat(n,"\n				L ").concat(32-a," ").concat(a,"\n				L ").concat(32-n," ").concat(r,"\n				"),stroke:"#fff",strokeWidth:6,fill:"none"}),(0,i.jsx)("path",{d:"\n				M ".concat(r," ").concat(32-n,"\n				L ").concat(a," ").concat(32-a,"\n				L ").concat(n," ").concat(32-r,"\n				"),stroke:"#fff",strokeWidth:6,fill:"none"}),(0,i.jsx)("path",{d:"\n				M ".concat(32-r," ").concat(32-n,"\n				L ").concat(32-a," ").concat(32-a,"\n				L ").concat(32-n," ").concat(32-r,"\n				"),stroke:"#fff",strokeWidth:6,fill:"none"})]})},d=()=>(0,i.jsx)("svg",{width:25,height:25,viewBox:"0 0 24 24",children:(0,i.jsx)("path",{d:"M3.63 3.63a.996.996 0 000 1.41L7.29 8.7 7 9H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z",fill:"#fff"})}),u=()=>(0,i.jsx)("svg",{width:25,height:25,viewBox:"0 0 24 24",children:(0,i.jsx)("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2A4.5 4.5 0 0014 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z",fill:"#fff"})}),h="__remotion_buffering_indicator",f="__remotion_buffering_animation",m={width:25,height:25,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},p={width:14,height:14,overflow:"hidden",lineHeight:"normal",fontSize:"inherit"},g=e=>{let{type:t}=e,r="player"===t?m:p;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("style",{type:"text/css",children:"\n				@keyframes ".concat(f," {\n          0% {\n            rotate: 0deg;\n          }\n          100% {\n            rotate: 360deg;\n          }\n        }\n        \n        .").concat(h," {\n            animation: ").concat(f," 1s linear infinite;\n        }        \n			")}),(0,i.jsx)("div",{style:r,children:(0,i.jsx)("svg",{viewBox:"player"===t?"0 0 22 22":"0 0 18 18",style:r,className:h,children:(0,i.jsx)("path",{d:"player"===t?"M 11 4 A 7 7 0 0 1 15.1145 16.66312":"M 9 2 A 7 7 0 0 1 13.1145 14.66312",stroke:"white",strokeLinecap:"round",fill:"none",strokeWidth:3})})})]})},y=e=>{let{currentSize:t,width:r,height:i,compositionWidth:a,compositionHeight:n}=e;return void 0!==r&&void 0===i||void 0!==i&&void 0===r?{aspectRatio:[a,n].join("/")}:{width:a,height:n}},b=e=>{let{previewSize:t,compositionWidth:r,compositionHeight:i,canvasSize:n}=e,s=a.Xp.calculateScale({canvasSize:n,compositionHeight:i,compositionWidth:r,previewSize:t}),o=0-(1-s)/2,l=o*r,c=o*i,d=r*s,u=i*s;return{centerX:n.width/2-d/2,centerY:n.height/2-u/2,xCorrection:l,yCorrection:c,scale:s}},k=e=>{let{config:t,style:r,canvasSize:i,overflowVisible:a,layout:n}=e;return t?{position:"relative",overflow:a?"visible":"hidden",...y({compositionHeight:t.height,compositionWidth:t.width,currentSize:i,height:null==r?void 0:r.height,width:null==r?void 0:r.width}),opacity:+!!n,...r}:{}},w=e=>{let{config:t,layout:r,scale:i,overflowVisible:a}=e;return t?r?{position:"absolute",width:t.width,height:t.height,display:"flex",transform:"scale(".concat(i,")"),marginLeft:r.xCorrection,marginTop:r.yCorrection,overflow:a?"visible":"hidden"}:{position:"absolute",width:t.width,height:t.height,display:"flex",transform:"scale(".concat(i,")"),overflow:a?"visible":"hidden"}:{}},v=e=>{let{layout:t,scale:r,config:i,overflowVisible:a}=e;if(!i)return{};if(!t)return{width:i.width*r,height:i.height*r,display:"flex",flexDirection:"column",position:"absolute",overflow:a?"visible":"hidden"};let{centerX:n,centerY:s}=t;return{width:i.width*r,height:i.height*r,display:"flex",flexDirection:"column",position:"absolute",left:n,top:s,overflow:a?"visible":"hidden"}},x=n.createContext(void 0),T=n.createContext(void 0);class S{addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}dispatchEvent(e,t){this.listeners[e].forEach(e=>{e({detail:t})})}constructor(){this.listeners={ended:[],error:[],pause:[],play:[],ratechange:[],scalechange:[],seeked:[],timeupdate:[],frameupdate:[],fullscreenchange:[],volumechange:[],mutechange:[],waiting:[],resume:[]},this.dispatchSeek=e=>{this.dispatchEvent("seeked",{frame:e})},this.dispatchVolumeChange=e=>{this.dispatchEvent("volumechange",{volume:e})},this.dispatchPause=()=>{this.dispatchEvent("pause",void 0)},this.dispatchPlay=()=>{this.dispatchEvent("play",void 0)},this.dispatchEnded=()=>{this.dispatchEvent("ended",void 0)},this.dispatchRateChange=e=>{this.dispatchEvent("ratechange",{playbackRate:e})},this.dispatchScaleChange=e=>{this.dispatchEvent("scalechange",{scale:e})},this.dispatchError=e=>{this.dispatchEvent("error",{error:e})},this.dispatchTimeUpdate=e=>{this.dispatchEvent("timeupdate",e)},this.dispatchFrameUpdate=e=>{this.dispatchEvent("frameupdate",e)},this.dispatchFullscreenChange=e=>{this.dispatchEvent("fullscreenchange",e)},this.dispatchMuteChange=e=>{this.dispatchEvent("mutechange",e)},this.dispatchWaiting=e=>{this.dispatchEvent("waiting",e)},this.dispatchResume=e=>{this.dispatchEvent("resume",e)}}}class C{addEventListener(e,t){this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}dispatchEvent(e,t){this.listeners[e].forEach(e=>{e({detail:t})})}constructor(){this.listeners={error:[],waiting:[],resume:[]},this.dispatchError=e=>{this.dispatchEvent("error",{error:e})},this.dispatchWaiting=e=>{this.dispatchEvent("waiting",e)},this.dispatchResume=e=>{this.dispatchEvent("resume",e)}}}var P=e=>{let t=(0,n.useContext)(a.Xp.BufferingContextReact);if(!t)throw Error("BufferingContextReact not found");(0,n.useLayoutEffect)(()=>{let r=t.listenForBuffering(()=>{t.buffering.current=!0,e.dispatchWaiting({})}),i=t.listenForResume(()=>{t.buffering.current=!1,e.dispatchResume({})});return()=>{r.remove(),i.remove()}},[t,e])},I=e=>{let{children:t,currentPlaybackRate:r}=e,[s]=(0,n.useState)(()=>new S);if(!(0,n.useContext)(a.Xp.BufferingContextReact))throw Error("BufferingContextReact not found");return(0,n.useEffect)(()=>{r&&s.dispatchRateChange(r)},[s,r]),P(s),(0,i.jsx)(x.Provider,{value:s,children:t})},E=(e,t)=>{let[r,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let r;let{current:a}=e;if(!a)return;let n=()=>{t&&(clearTimeout(r),r=setTimeout(()=>{i(!1)},!0===t?3e3:t))},s=()=>{i(!0),n()},o=()=>{i(!1),clearTimeout(r)},l=()=>{i(!0),n()};return a.addEventListener("mouseenter",s),a.addEventListener("mouseleave",o),a.addEventListener("mousemove",l),()=>{a.removeEventListener("mouseenter",s),a.removeEventListener("mouseleave",o),a.removeEventListener("mousemove",l),clearTimeout(r)}},[t,e]),r},A=()=>{var e;let[t,r,i]=a.Xp.Timeline.usePlayingState(),[s,o]=(0,n.useState)(!1),l=a.Xp.Timeline.useTimelinePosition(),c=(0,n.useRef)(l),d=a.Xp.Timeline.useTimelineSetFrame(),u=a.Xp.Timeline.useTimelineSetFrame(),h=(0,n.useContext)(a.Xp.SharedAudioContext),{audioAndVideoTags:f}=(0,n.useContext)(a.Xp.TimelineContext),m=(0,n.useRef)(l);m.current=l;let p=a.Xp.useVideo(),g=a.Xp.useUnsafeVideoConfig(),y=(0,n.useContext)(x),b=(null!==(e=null==g?void 0:g.durationInFrames)&&void 0!==e?e:1)-1,k=l===b,w=0===l;if(!y)throw TypeError("Expected Player event emitter context");let v=(0,n.useContext)(a.Xp.BufferingContextReact);if(!v)throw Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");let{buffering:T}=v,S=(0,n.useCallback)(e=>{(null==p?void 0:p.id)&&u(t=>({...t,[p.id]:e})),m.current=e,y.dispatchSeek(e)},[y,u,null==p?void 0:p.id]),C=(0,n.useCallback)(e=>{var t;!i.current&&(o(!0),k&&S(0),null==h||null===(t=h.audioContext)||void 0===t||t.resume(),h&&h.numberOfAudioTags>0&&e&&h.playAllAudios(),f.current.forEach(e=>e.play("player play() was called and playing audio from a click")),i.current=!0,r(!0),c.current=m.current,y.dispatchPlay())},[i,k,h,r,y,S,f]),P=(0,n.useCallback)(()=>{if(i.current){var e;i.current=!1,r(!1),y.dispatchPause(),null==h||null===(e=h.audioContext)||void 0===e||e.suspend()}},[y,i,r,h]),I=(0,n.useCallback)(()=>{i.current&&(i.current=!1,m.current=c.current,g&&(u(e=>({...e,[g.id]:c.current})),r(!1),y.dispatchPause()))},[g,y,i,r,u]),E=null==p?void 0:p.id,A=(0,n.useCallback)(e=>{if(!E)return null;!i.current&&d(t=>{var r,i;let a=null!==(i=null!==(r=t[E])&&void 0!==r?r:window.remotion_initialFrame)&&void 0!==i?i:0,n=Math.max(0,a-e);return a===n?t:{...t,[E]:n}})},[i,d,E]),M=(0,n.useCallback)(e=>{if(!E)return null;!i.current&&d(t=>{var r,i;let a=null!==(i=null!==(r=t[E])&&void 0!==r?r:window.remotion_initialFrame)&&void 0!==i?i:0,n=Math.min(b,a+e);return a===n?t:{...t,[E]:n}})},[E,i,b,d]),F=(0,n.useCallback)(e=>{i.current?P():C(e)},[i,P,C]),B=(0,n.useCallback)(()=>i.current,[i]),L=(0,n.useCallback)(()=>m.current,[m]),U=(0,n.useCallback)(()=>T.current,[T]);return(0,n.useMemo)(()=>({frameBack:A,frameForward:M,isLastFrame:k,emitter:y,playing:t,play:C,pause:P,seek:S,isFirstFrame:w,getCurrentFrame:L,isPlaying:B,isBuffering:U,pauseAndReturnToPlayStart:I,hasPlayed:s,toggle:F}),[y,A,M,s,w,k,L,P,I,C,t,S,F,B,U])},M=e=>{let{browserMediaControlsBehavior:t,videoConfig:r,playbackRate:i}=e,{playing:a,pause:s,play:o,emitter:l,getCurrentFrame:c,seek:d}=A();(0,n.useEffect)(()=>{navigator.mediaSession&&"do-nothing"!==t.mode&&(a?navigator.mediaSession.playbackState="playing":navigator.mediaSession.playbackState="paused")},[t.mode,a]),(0,n.useEffect)(()=>{if(!navigator.mediaSession||"do-nothing"===t.mode)return;let e=()=>{r&&navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:r.durationInFrames/r.fps,playbackRate:i,position:c()/r.fps})};return l.addEventListener("timeupdate",e),()=>{l.removeEventListener("timeupdate",e)}},[t.mode,l,c,i,r]),(0,n.useEffect)(()=>{if(navigator.mediaSession&&"do-nothing"!==t.mode)return navigator.mediaSession.setActionHandler("play",()=>{"register-media-session"===t.mode&&o()}),navigator.mediaSession.setActionHandler("pause",()=>{"register-media-session"===t.mode&&s()}),navigator.mediaSession.setActionHandler("seekto",e=>{"register-media-session"===t.mode&&void 0!==e.seekTime&&r&&d(Math.round(e.seekTime*r.fps))}),navigator.mediaSession.setActionHandler("seekbackward",()=>{"register-media-session"===t.mode&&r&&d(Math.max(0,Math.round((c()-10)*r.fps)))}),navigator.mediaSession.setActionHandler("seekforward",()=>{"register-media-session"===t.mode&&r&&d(Math.max(r.durationInFrames-1,Math.round((c()+10)*r.fps)))}),navigator.mediaSession.setActionHandler("previoustrack",()=>{"register-media-session"===t.mode&&d(0)}),()=>{navigator.mediaSession.metadata=null,navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("seekto",null),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null)}},[t.mode,c,s,o,d,r])},F=e=>{let{time:t,currentFrame:r,playbackSpeed:i,fps:a,actualLastFrame:n,actualFirstFrame:s,framesAdvanced:o,shouldLoop:l}=e,c=(i<0?Math.ceil:Math.floor)(t*i/(1e3/a))-o,d=c+r,u=d>n||d<s,h=!l&&u&&!(r>n||r<s);return i>0?u?{nextFrame:s,framesToAdvance:c,hasEnded:h}:{nextFrame:d,framesToAdvance:c,hasEnded:h}:u?{nextFrame:n,framesToAdvance:c,hasEnded:h}:{nextFrame:d,framesToAdvance:c,hasEnded:h}},B=()=>"undefined"!=typeof document&&"hidden"===document.visibilityState,L=()=>{let e=(0,n.useRef)(B());return(0,n.useEffect)(()=>{let t=()=>{e.current=B()};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[]),e},U=e=>{let{loop:t,playbackRate:r,moveToBeginningWhenEnded:i,inFrame:s,outFrame:o,browserMediaControlsBehavior:l,getCurrentFrame:c}=e,d=a.Xp.useUnsafeVideoConfig(),u=a.Xp.Timeline.useTimelinePosition(),{playing:h,pause:f,emitter:m,isPlaying:p}=A(),g=a.Xp.Timeline.useTimelineSetFrame(),y=L(),b=(0,n.useRef)(null),k=(0,n.useContext)(a.Xp.BufferingContextReact);if(!k)throw Error("Missing the buffering context. Most likely you have a Remotion version mismatch.");M({browserMediaControlsBehavior:l,playbackRate:r,videoConfig:d}),(0,n.useEffect)(()=>{if(!d||!h)return;let e=!1,a=null,n=performance.now(),l=0,u=()=>{null!==a&&("raf"===a.type?cancelAnimationFrame(a.id):clearTimeout(a.id))},b=()=>{e=!0,u()},w=()=>{if(e||!p())return;let a=performance.now()-n,u=null!=o?o:d.durationInFrames-1,{nextFrame:h,framesToAdvance:y,hasEnded:k}=F({time:a,currentFrame:c(),playbackSpeed:r,fps:d.fps,actualFirstFrame:null!=s?s:0,actualLastFrame:u,framesAdvanced:l,shouldLoop:t});if(l+=y,h!==c()&&(!k||i)&&g(e=>({...e,[d.id]:h})),k){b(),f(),m.dispatchEnded();return}v()},v=()=>{if(k.buffering.current){let e=k.listenForResume(()=>{e.remove(),n=performance.now(),l=0,v()});return}if(y.current){a={type:"timeout",id:setTimeout(w,1e3/d.fps)};return}a={type:"raf",id:requestAnimationFrame(w)}};v();let x=()=>{"visible"!==document.visibilityState&&(u(),w())};return window.addEventListener("visibilitychange",x),()=>{window.removeEventListener("visibilitychange",x),b()}},[d,t,f,h,g,m,r,s,o,i,y,c,k,p]),(0,n.useEffect)(()=>{let e=setInterval(()=>{b.current!==c()&&(m.dispatchTimeUpdate({frame:c()}),b.current=c())},250);return()=>clearInterval(e)},[m,c]),(0,n.useEffect)(()=>{m.dispatchFrameUpdate({frame:u})},[m,u])},R=[],D=(e,t)=>{let[r,i]=(0,n.useState)(()=>{if(!e.current)return null;let t=e.current.getClientRects();return t[0]?{width:t[0].width,height:t[0].height,left:t[0].x,top:t[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}}:null}),a=(0,n.useMemo)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(e=>{let{contentRect:r,target:a}=e[0],n=a.getClientRects();if(!(null==n?void 0:n[0])){i(null);return}let s=0===r.width?1:n[0].width/r.width,o=t.shouldApplyCssTransforms||0===s?n[0].width:n[0].width*(1/s),l=t.shouldApplyCssTransforms||0===s?n[0].height:n[0].height*(1/s);i(e=>e&&e.width===o&&e.height===l&&e.left===n[0].x&&e.top===n[0].y&&e.windowSize.height===window.innerHeight&&e.windowSize.width===window.innerWidth?e:{width:o,height:l,left:n[0].x,top:n[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})}),[t.shouldApplyCssTransforms]),s=(0,n.useCallback)(()=>{if(!e.current)return;let t=e.current.getClientRects();if(!t[0]){i(null);return}i(e=>e&&e.width===t[0].width&&e.height===t[0].height&&e.left===t[0].x&&e.top===t[0].y&&e.windowSize.height===window.innerHeight&&e.windowSize.width===window.innerWidth?e:{width:t[0].width,height:t[0].height,left:t[0].x,top:t[0].y,windowSize:{height:window.innerHeight,width:window.innerWidth}})},[e]);return(0,n.useEffect)(()=>{if(!a)return;let{current:t}=e;return t&&a.observe(t),()=>{t&&a.unobserve(t)}},[a,e,s]),(0,n.useEffect)(()=>{if(t.triggerOnWindowResize)return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[t.triggerOnWindowResize,s]),(0,n.useEffect)(()=>(R.push(s),()=>{R=R.filter(e=>e!==s)}),[s]),(0,n.useMemo)(()=>r?{...r,refresh:s}:null,[r,s])},N=e=>{let{playing:t,buffering:r}=e;return t&&r?(0,i.jsx)(g,{type:"player"}):t?(0,i.jsx)(l,{}):(0,i.jsx)(o,{})},_=e=>{let{volume:t,isVertical:r,onBlur:s,inputRef:o,setVolume:l}=e,c=(0,n.useMemo)(()=>{let e={paddingLeft:5,height:25,width:O,display:"inline-flex",alignItems:"center"};return r?{...e,position:"absolute",transform:"rotate(-90deg) translateX(".concat(O/2+12.5,"px)")}:{...e}},[r]),d=void 0===n.useId?"volume-slider":n.useId(),[u]=(0,n.useState)(()=>"__remotion-volume-slider-".concat((0,a.yT)(d)).replace(".","")),h=(0,n.useCallback)(e=>{l(parseFloat(e.target.value))},[l]),f=(0,n.useMemo)(()=>{let e={WebkitAppearance:"none",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:2.5,cursor:"pointer",height:5,width:O,backgroundImage:"linear-gradient(\n				to right,\n				white ".concat(100*t,"%, rgba(255, 255, 255, 0) ").concat(100*t,"%\n			)")};return r?{...e,bottom:25+O/2}:e},[r,t]),m="\n	.".concat(u,"::-webkit-slider-thumb {\n		-webkit-appearance: none;\n		background-color: white;\n		border-radius: ").concat(6,"px;\n		box-shadow: 0 0 2px black;\n		height: ").concat(12,"px;\n		width: ").concat(12,"px;\n	}\n\n	.").concat(u,"::-moz-range-thumb {\n		-webkit-appearance: none;\n		background-color: white;\n		border-radius: ").concat(6,"px;\n		box-shadow: 0 0 2px black;\n		height: ").concat(12,"px;\n		width: ").concat(12,"px;\n	}\n");return(0,i.jsxs)("div",{style:c,children:[(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:m}}),(0,i.jsx)("input",{ref:o,"aria-label":"Change volume",className:u,max:1,min:0,onBlur:s,onChange:h,step:.01,type:"range",value:t,style:f})]})},z=e=>(0,i.jsx)(_,{...e}),O=100,V=e=>{let{displayVerticalVolumeSlider:t,renderMuteButton:r,renderVolumeSlider:s}=e,[o,l]=a.Xp.useMediaMutedState(),[c,h]=a.Xp.useMediaVolumeState(),[f,m]=(0,n.useState)(!1),p=(0,n.useRef)(null),g=(0,n.useRef)(null),y=E(p,!1),b=(0,n.useCallback)(()=>{setTimeout(()=>{g.current&&document.activeElement!==g.current&&m(!1)},10)},[]),k=0===c,w=(0,n.useCallback)(()=>{if(k){h(1),l(!1);return}l(e=>!e)},[k,l,h]),v=(0,n.useMemo)(()=>({display:"inline-flex",background:"none",border:"none",justifyContent:"center",alignItems:"center",touchAction:"none",...t&&{position:"relative"}}),[t]),x=(0,n.useMemo)(()=>({display:"inline",width:25,height:25,cursor:"pointer",appearance:"none",background:"none",border:"none",padding:0}),[]),T=(0,n.useCallback)(e=>{let{muted:t,volume:r}=e,a=t||0===r;return(0,i.jsx)("button",{"aria-label":a?"Unmute sound":"Mute sound",title:a?"Unmute sound":"Mute sound",onClick:w,onBlur:b,onFocus:()=>m(!0),style:x,type:"button",children:a?(0,i.jsx)(d,{}):(0,i.jsx)(u,{})})},[b,w,x]),S=(0,n.useMemo)(()=>r?r({muted:o,volume:c}):T({muted:o,volume:c}),[o,c,T,r]),C=(0,n.useMemo)(()=>(f||y)&&!o&&!a.Xp.isIosSafari()?(null!=s?s:z)({isVertical:t,volume:c,onBlur:()=>m(!1),inputRef:g,setVolume:h}):null,[t,f,y,o,c,s,h]);return(0,i.jsxs)("div",{ref:p,style:v,children:[S,C]})},$={height:30,paddingRight:15,paddingLeft:12,display:"flex",flexDirection:"row",alignItems:"center"},j={width:22,display:"flex",alignItems:"center"},H={width:14,height:14,color:"black"},q=()=>(0,i.jsx)("svg",{viewBox:"0 0 512 512",style:H,children:(0,i.jsx)("path",{fill:"currentColor",d:"M435.848 83.466L172.804 346.51l-96.652-96.652c-4.686-4.686-12.284-4.686-16.971 0l-28.284 28.284c-4.686 4.686-4.686 12.284 0 16.971l133.421 133.421c4.686 4.686 12.284 4.686 16.971 0l299.813-299.813c4.686-4.686 4.686-12.284 0-16.971l-28.284-28.284c-4.686-4.686-12.284-4.686-16.97 0z"})}),K=e=>{let t=e.toString();return t.includes(".")?t:t+".0"},W=e=>{let{rate:t,onSelect:r,selectedRate:a,keyboardSelectedRate:s}=e,o=(0,n.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),r(t)},[r,t]),[l,c]=(0,n.useState)(!1),d=(0,n.useCallback)(()=>{c(!0)},[]),u=(0,n.useCallback)(()=>{c(!1)},[]),h=s===t,f=(0,n.useMemo)(()=>({...$,backgroundColor:l||h?"#eee":"transparent"}),[l,h]);return(0,i.jsxs)("div",{onPointerEnter:d,onPointerLeave:u,tabIndex:0,style:f,onClick:o,children:[(0,i.jsx)("div",{style:j,children:t===a?(0,i.jsx)(q,{}):null}),K(t),"x"]},t)},X=e=>{let{setIsComponentVisible:t,playbackRates:r,canvasSize:s}=e,{setPlaybackRate:o,playbackRate:l}=(0,n.useContext)(a.Xp.TimelineContext),[c,d]=(0,n.useState)(l);(0,n.useEffect)(()=>{let e=e=>{if(e.preventDefault(),"ArrowUp"===e.key){let e=r.findIndex(e=>e===c);0!==e&&(-1===e?d(r[0]):d(r[e-1]))}else if("ArrowDown"===e.key){let e=r.findIndex(e=>e===c);if(e===r.length-1)return;-1===e?d(r[r.length-1]):d(r[e+1])}else"Enter"===e.key&&(o(c),t(!1))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,c,o,t]);let u=(0,n.useCallback)(e=>{o(e),t(!1)},[t,o]),h=(0,n.useMemo)(()=>({position:"absolute",right:0,width:125,maxHeight:s.height-70-35,bottom:35,background:"#fff",borderRadius:4,overflow:"auto",color:"black",textAlign:"left"}),[s.height]);return(0,i.jsx)("div",{style:h,children:r.map(e=>(0,i.jsx)(W,{selectedRate:l,onSelect:u,rate:e,keyboardSelectedRate:c},e))})},Q={fontSize:13,fontWeight:"bold",color:"white",border:"2px solid white",borderRadius:20,paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2},J={appearance:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",paddingLeft:0,paddingRight:0,paddingTop:6,paddingBottom:6,height:37,display:"inline-flex",marginBottom:0,marginTop:0,alignItems:"center"},Z={...J,position:"relative"},G=e=>{let{playbackRates:t,canvasSize:r}=e,{ref:s,isComponentVisible:o,setIsComponentVisible:l}=function(e){let[t,r]=(0,n.useState)(e),i=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=e=>{i.current&&!i.current.contains(e.target)&&r(!1)};return document.addEventListener("pointerup",e,!0),()=>{document.removeEventListener("pointerup",e,!0)}},[]),{ref:i,isComponentVisible:t,setIsComponentVisible:r}}(!1),{playbackRate:c}=(0,n.useContext)(a.Xp.TimelineContext),d=(0,n.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),l(e=>!e)},[l]);return(0,i.jsx)("div",{ref:s,children:(0,i.jsxs)("button",{type:"button","aria-label":"Change playback rate",style:Z,onClick:d,children:[(0,i.jsxs)("div",{style:Q,children:[c,"x"]}),o&&(0,i.jsx)(X,{canvasSize:r,playbackRates:t,setIsComponentVisible:l})]})})},Y=(e,t,r)=>Math.round((0,a.GW)(e,[0,r],[0,t-1],{extrapolateLeft:"clamp",extrapolateRight:"clamp"})),ee={userSelect:"none",WebkitUserSelect:"none",paddingTop:4,paddingBottom:4,boxSizing:"border-box",cursor:"pointer",position:"relative",touchAction:"none"},et={height:5,backgroundColor:"rgba(255, 255, 255, 0.25)",width:"100%",borderRadius:2.5},er=e=>{let t=e;for(;t.parentElement;)t=t.parentElement;return t},ei=e=>{var t;let{durationInFrames:r,onSeekEnd:s,onSeekStart:o,inFrame:l,outFrame:c}=e,d=(0,n.useRef)(null),u=E(d,!1),h=D(d,{triggerOnWindowResize:!0,shouldApplyCssTransforms:!0}),{seek:f,play:m,pause:p,playing:g}=A(),y=a.Xp.Timeline.useTimelinePosition(),[b,k]=(0,n.useState)({dragging:!1}),w=null!==(t=null==h?void 0:h.width)&&void 0!==t?t:0,v=(0,n.useCallback)(e=>{var t;if(0!==e.button)return;let i=null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect().left,a=Y(e.clientX-i,r,w);p(),f(a),k({dragging:!0,wasPlaying:g}),o()},[r,w,p,f,g,o]),x=(0,n.useCallback)(e=>{var t;if(!h)throw Error("Player has no size");if(!b.dragging)return;let i=null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect().left;f(Y(e.clientX-i,r,h.width))},[b.dragging,r,f,h]),T=(0,n.useCallback)(()=>{k({dragging:!1}),b.dragging&&(b.wasPlaying?m():p(),s())},[b,s,p,m]);(0,n.useEffect)(()=>{if(!b.dragging)return;let e=er(d.current);return e.addEventListener("pointermove",x),e.addEventListener("pointerup",T),()=>{e.removeEventListener("pointermove",x),e.removeEventListener("pointerup",T)}},[b.dragging,x,T]);let S=(0,n.useMemo)(()=>({height:12,width:12,borderRadius:6,position:"absolute",top:.5,backgroundColor:"white",left:Math.max(0,y/Math.max(1,r-1)*w-6),boxShadow:"0 0 2px black",opacity:Number(u||b.dragging)}),[u,b.dragging,r,y,w]),C=(0,n.useMemo)(()=>({height:5,backgroundColor:"rgba(255, 255, 255, 1)",width:(y-(null!=l?l:0))/(r-1)*w,marginLeft:(null!=l?l:0)/(r-1)*w,borderRadius:2.5}),[r,y,l,w]),P=(0,n.useMemo)(()=>({height:5,backgroundColor:"rgba(255, 255, 255, 0.25)",width:((null!=c?c:r-1)-(null!=l?l:0))/(r-1)*100+"%",marginLeft:(null!=l?l:0)/(r-1)*100+"%",borderRadius:2.5,position:"absolute"}),[r,l,c]);return(0,i.jsxs)("div",{ref:d,onPointerDown:v,style:ee,children:[(0,i.jsxs)("div",{style:et,children:[(0,i.jsx)("div",{style:P}),(0,i.jsx)("div",{style:C})]}),(0,i.jsx)("div",{style:S})]})},ea=e=>{let t=Math.floor(e/60),r=Math.floor(e-60*t);return"".concat(String(t),":").concat(String(r).padStart(2,"0"))},en=e=>{let{durationInFrames:t,maxTimeLabelWidth:r,fps:s}=e,o=a.Xp.Timeline.useTimelinePosition(),l=(0,n.useMemo)(()=>({color:"white",fontFamily:"sans-serif",fontSize:14,maxWidth:null===r?void 0:r,overflow:"hidden",textOverflow:"ellipsis"}),[r]);return(0,i.jsxs)("div",{style:l,children:[ea((o===t-1?o+1:o)/s)," / ",ea(t/s)]})},es=e=>{let{allowFullscreen:t,playerWidth:r}=e;return(0,n.useMemo)(()=>{let e=50+16*!!t+24+20,i=Math.max(r-e,0),a=i-O,n=r<(a<O?i:a)+e+O;return{maxTimeLabelWidth:0===i?null:i,displayVerticalVolumeSlider:n}},[t,r])},eo=[0,8.1,15.5,22.5,29,35.3,41.2,47.1,52.9,58.8,64.7,71,77.5,84.5,91.9],el=1/.7,ec={boxSizing:"border-box",position:"absolute",bottom:0,width:"100%",paddingTop:40,paddingBottom:10,backgroundImage:"linear-gradient(to bottom,".concat([0,.013,.049,.104,.175,.259,.352,.45,.55,.648,.741,.825,.896,.951,.987].map((e,t)=>"hsla(0, 0%, 0%, ".concat(e,") ").concat(eo[t]*el,"%")).join(", "),", hsl(0, 0%, 0%) 100%)"),backgroundSize:"auto 145px",display:"flex",paddingRight:12,paddingLeft:12,flexDirection:"column",transition:"opacity 0.3s"},ed={display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none"},eu={display:"flex",flexDirection:"row",userSelect:"none",WebkitUserSelect:"none",alignItems:"center"},eh={width:12},ef={height:8},em={flex:1},ep={},eg=e=>{var t,r;let{durationInFrames:a,isFullscreen:s,fps:o,showVolumeControls:l,onFullscreenButtonClick:d,allowFullscreen:u,onExitFullscreenButtonClick:h,spaceKeyToPlayOrPause:f,onSeekEnd:m,onSeekStart:p,inFrame:g,outFrame:y,initiallyShowControls:b,canvasSize:k,renderPlayPauseButton:w,renderFullscreenButton:v,alwaysShowControls:x,showPlaybackRateControl:T,containerRef:S,buffering:C,hideControlsWhenPointerDoesntMove:P,onPointerDown:I,onDoubleClick:A,renderMuteButton:M,renderVolumeSlider:F,playing:B,toggle:L}=e,U=(0,n.useRef)(null),[R,D]=(0,n.useState)(!1),_=E(S,P),{maxTimeLabelWidth:z,displayVerticalVolumeSlider:O}=es({allowFullscreen:u,playerWidth:null!==(t=null==k?void 0:k.width)&&void 0!==t?t:0}),[$,j]=(0,n.useState)(()=>{if("boolean"==typeof b)return b;if("number"==typeof b){if(b%1!=0)throw Error("initiallyShowControls must be an integer or a boolean");if(Number.isNaN(b))throw Error("initiallyShowControls must not be NaN");if(!Number.isFinite(b))throw Error("initiallyShowControls must be finite");if(b<=0)throw Error("initiallyShowControls must be a positive integer");return b}throw TypeError("initiallyShowControls must be a number or a boolean")}),H=(0,n.useMemo)(()=>{let e=_||!B||$||x;return{...ec,opacity:Number(e)}},[_,$,B,x]);(0,n.useEffect)(()=>{U.current&&f&&U.current.focus({preventScroll:!0})},[B,f]),(0,n.useEffect)(()=>{var e;D(null!==(e="undefined"!=typeof document&&(document.fullscreenEnabled||document.webkitFullscreenEnabled))&&void 0!==e&&e)},[]),(0,n.useEffect)(()=>{if(!1===$)return;let e=setTimeout(()=>{j(!1)},!0===$?2e3:$);return()=>{clearInterval(e)}},[$]);let q=(0,n.useMemo)(()=>{if(!0===T)return[.5,.8,1,1.2,1.5,1.8,2,2.5,3];if(Array.isArray(T)){for(let e of T){if("number"!=typeof e)throw Error("Every item in showPlaybackRateControl must be a number");if(e<=0)throw Error("Every item in showPlaybackRateControl must be positive")}return T}return null},[T]),K=(0,n.useRef)(null),W=(0,n.useRef)(null),X=(0,n.useCallback)(e=>{(e.target===K.current||e.target===W.current)&&(null==I||I(e))},[I]),Q=(0,n.useCallback)(e=>{(e.target===K.current||e.target===W.current)&&(null==A||A(e))},[A]);return(0,i.jsxs)("div",{ref:K,style:H,onPointerDown:X,onDoubleClick:Q,children:[(0,i.jsxs)("div",{ref:W,style:ed,children:[(0,i.jsxs)("div",{style:eu,children:[(0,i.jsx)("button",{ref:U,type:"button",style:J,onClick:L,"aria-label":B?"Pause video":"Play video",title:B?"Pause video":"Play video",children:null===w?(0,i.jsx)(N,{buffering:C,playing:B}):null!==(r=w({playing:B,isBuffering:C}))&&void 0!==r?r:(0,i.jsx)(N,{buffering:C,playing:B})}),l?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:eh}),(0,i.jsx)(V,{renderMuteButton:M,renderVolumeSlider:F,displayVerticalVolumeSlider:O})]}):null,(0,i.jsx)("div",{style:eh}),(0,i.jsx)(en,{durationInFrames:a,fps:o,maxTimeLabelWidth:z}),(0,i.jsx)("div",{style:eh})]}),(0,i.jsx)("div",{style:em}),q&&k&&(0,i.jsx)(G,{canvasSize:k,playbackRates:q}),q&&R&&u?(0,i.jsx)("div",{style:eh}):null,(0,i.jsx)("div",{style:ep,children:R&&u?(0,i.jsx)("button",{type:"button","aria-label":s?"Exit fullscreen":"Enter Fullscreen",title:s?"Exit fullscreen":"Enter Fullscreen",style:J,onClick:s?h:d,children:null===v?(0,i.jsx)(c,{isFullscreen:s}):v({isFullscreen:s})}):null})]}),(0,i.jsx)("div",{style:ef}),(0,i.jsx)(ei,{onSeekEnd:m,onSeekStart:p,durationInFrames:a,inFrame:g,outFrame:y})]})},ey={display:"flex",justifyContent:"center",alignItems:"center",flex:1,height:"100%",width:"100%"};class eb extends n.Component{static getDerivedStateFromError(e){return{hasError:e}}componentDidCatch(e){this.props.onError(e)}render(){return this.state.hasError?(0,i.jsx)("div",{style:ey,children:this.props.errorFallback({error:this.state.hasError})}):this.props.children}constructor(...e){super(...e),this.state={hasError:null}}}var ek=async()=>{if("undefined"==typeof window||void 0===window.crypto||void 0===window.crypto.subtle)return null;try{let e=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(window.location.hostname));return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(e){return null}},ew={backgroundColor:"red",position:"absolute",padding:12,fontFamily:"Arial"},ev=["28d262b44cc61fa750f1686b16ad0604dabfe193fbc263eec05c89b7ad4c2cd6","4db1b0a94be33165dfefcb3ba03d04c7a2666dd27c496d3dc9fa41858e94925e","fbc48530bbf245da790f63675e84e06bab38c3b114fab07eb350025119922bdc","7baf10a8932757b1b3a22b3fce10a048747ac2f8eaf638603487e3705b07eb83","8a6c21a598d8c667272b5207c051b85997bf5b45d5fb712378be3f27cd72c6a6","a2f7aaac9c50a9255e7fc376110c4e0bfe153722dc66ed3c5d3bf2a135f65518"],ex=!1,eT=()=>{let[e,t]=n.useState(!1);return((0,n.useEffect)(()=>{!ex&&(ex=!0,ek().then(e=>{e&&ev.includes(e)&&t(!0)}).catch(()=>{}))},[]),(0,n.useEffect)(()=>{if(!e)return;let t=()=>{if(!document.querySelector(".warning-banner")){let e=document.createElement("div");e.className="warning-banner",Object.assign(e.style,ew,{zIndex:"9999",cssText:"".concat(ew.cssText," !important;")}),e.innerHTML='\n	        <a href="https://github.com/remotion-dev/remotion/pull/4589" style="color: white;">\n	          Remotion Unlicensed – Contact hi@remotion.dev\n	        </a>\n	      ',document.body.appendChild(e)}},r=new MutationObserver(()=>t());return r.observe(document.body,{childList:!0,subtree:!0}),()=>{r.disconnect()}},[e]),e)?(0,i.jsx)("div",{style:ew,className:"warning-banner",children:(0,i.jsx)("a",{style:{color:"white"},href:"https://github.com/remotion-dev/remotion/pull/4589",children:"Remotion Unlicensed – Contact hi@remotion.dev"})}):null},eS=e=>null!=e?e:"__remotion-player",eC="undefined"==typeof document,eP=e=>{let t=!1;return{promise:new Promise((r,i)=>{e.then(e=>{if(t){i({isCanceled:t,value:e});return}r(e)}).catch(e=>{i({isCanceled:t,error:e})})}),cancel:()=>{t=!0}}},eI=e=>new Promise(t=>setTimeout(t,e)),eE=()=>{let e=(0,n.useRef)([]),t=(0,n.useCallback)(t=>{e.current=[...e.current,t]},[]),r=(0,n.useCallback)(t=>{e.current=e.current.filter(e=>e!==t)},[]),i=(0,n.useCallback)(()=>e.current.map(e=>e.cancel()),[]);return(0,n.useMemo)(()=>({appendPendingPromise:t,removePendingPromise:r,clearPendingPromises:i}),[t,i,r])},eA=(e,t,r)=>{let i=eE(),a=(0,n.useCallback)(async t=>{if(t instanceof PointerEvent?"touch"===t.pointerType:"touch"===t.nativeEvent.pointerType){e(t);return}i.clearPendingPromises();let r=eP(eI(200));i.appendPendingPromise(r);try{await r.promise,i.removePendingPromise(r),e(t)}catch(e){if(i.removePendingPromise(r),!e.isCanceled)throw e.error}},[i,e]),s=(0,n.useCallback)(()=>{document.addEventListener("pointerup",e=>{a(e)},{once:!0})},[a]),o=(0,n.useCallback)(()=>{i.clearPendingPromises(),t()},[i,t]);return(0,n.useMemo)(()=>r?{handlePointerDown:s,handleDoubleClick:o}:{handlePointerDown:e,handleDoubleClick:()=>{}},[r,o,s,e])},eM=n.version.split(".")[0];if("0"===eM)throw Error("Version ".concat(eM,' of "react" is not supported by Remotion'));var eF=parseInt(eM,10)>=18,eB=(0,n.forwardRef)((e,t)=>{var r,s,o;let{controls:l,style:c,loop:d,autoPlay:u,allowFullscreen:h,inputProps:f,clickToPlay:m,showVolumeControls:p,doubleClickToFullscreen:g,spaceKeyToPlayOrPause:y,errorFallback:x,playbackRate:T,renderLoading:S,renderPoster:C,className:P,moveToBeginningWhenEnded:I,showPosterWhenUnplayed:E,showPosterWhenEnded:M,showPosterWhenPaused:F,showPosterWhenBuffering:B,showPosterWhenBufferingAndPaused:L,inFrame:R,outFrame:N,initiallyShowControls:_,renderFullscreen:z,renderPlayPauseButton:O,renderMuteButton:V,renderVolumeSlider:$,alwaysShowControls:j,showPlaybackRateControl:H,posterFillMode:q,bufferStateDelayInMilliseconds:K,hideControlsWhenPointerDoesntMove:W,overflowVisible:X,browserMediaControlsBehavior:Q,overrideInternalClassName:J,noSuspense:Z}=e,G=a.Xp.useUnsafeVideoConfig(),Y=a.Xp.useVideo(),ee=(0,n.useRef)(null),et=D(ee,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),[er,ei]=(0,n.useState)(!1),[ea,en]=(0,n.useState)(u),[es,eo]=(0,n.useState)(()=>!1),[el,ec]=(0,n.useState)(!1),ed=(0,n.useMemo)(()=>"undefined"!=typeof document&&!!(document.fullscreenEnabled||document.webkitFullscreenEnabled),[]),eu=A(),eh=eu.toggle;U({loop:d,playbackRate:T,moveToBeginningWhenEnded:I,inFrame:R,outFrame:N,getCurrentFrame:eu.getCurrentFrame,browserMediaControlsBehavior:Q}),(0,n.useEffect)(()=>{er&&!eu.playing&&(ei(!1),eu.play())},[er,eu]),(0,n.useEffect)(()=>{let{current:e}=ee;if(!e)return;let t=()=>{eo(document.fullscreenElement===e||document.webkitFullscreenElement===e)};return document.addEventListener("fullscreenchange",t),document.addEventListener("webkitfullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t),document.removeEventListener("webkitfullscreenchange",t)}},[]);let ef=(0,n.useCallback)(e=>{eh(e)},[eh]),em=(0,n.useCallback)(()=>{if(!h)throw Error("allowFullscreen is false");if(!ed)throw Error("Browser doesnt support fullscreen");if(!ee.current)throw Error("No player ref found");ee.current.webkitRequestFullScreen?ee.current.webkitRequestFullScreen():ee.current.requestFullscreen()},[h,ed]),ep=(0,n.useCallback)(()=>{document.webkitExitFullscreen?document.webkitExitFullscreen():document.exitFullscreen()},[]);(0,n.useEffect)(()=>{let{current:e}=ee;if(!e)return;let t=()=>{var e;let t=null!==(e=document.webkitFullscreenElement)&&void 0!==e?e:document.fullscreenElement;t&&t===ee.current?eu.emitter.dispatchFullscreenChange({isFullscreen:!0}):eu.emitter.dispatchFullscreenChange({isFullscreen:!1})};return e.addEventListener("webkitfullscreenchange",t),e.addEventListener("fullscreenchange",t),()=>{e.removeEventListener("webkitfullscreenchange",t),e.removeEventListener("fullscreenchange",t)}},[eu.emitter]);let ey=null!==(r=null==G?void 0:G.durationInFrames)&&void 0!==r?r:1,ek=(0,n.useMemo)(()=>G&&et?b({canvasSize:et,compositionHeight:G.height,compositionWidth:G.width,previewSize:"auto"}):null,[et,G]),ew=null!==(s=null==ek?void 0:ek.scale)&&void 0!==s?s:1,ev=(0,n.useRef)(!1);(0,n.useEffect)(()=>{if(!ev.current){ev.current=!0;return}eu.emitter.dispatchScaleChange(ew)},[eu.emitter,ew]);let{setMediaVolume:ex,setMediaMuted:eP}=(0,n.useContext)(a.Xp.SetMediaVolumeContext),{mediaMuted:eI,mediaVolume:eE}=(0,n.useContext)(a.Xp.MediaVolumeContext);(0,n.useEffect)(()=>{eu.emitter.dispatchVolumeChange(eE)},[eu.emitter,eE]);let eM=eI||0===eE;(0,n.useEffect)(()=>{eu.emitter.dispatchMuteChange({isMuted:eM})},[eu.emitter,eM]);let[eB,eL]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=null,t=!1,r=()=>{t=!1,requestAnimationFrame(()=>{0===K?eL(!0):e=setTimeout(()=>{t||eL(!0)},K)})},i=()=>{requestAnimationFrame(()=>{t=!0,eL(!1),e&&clearTimeout(e)})};return eu.emitter.addEventListener("waiting",r),eu.emitter.addEventListener("resume",i),()=>{eu.emitter.removeEventListener("waiting",r),eu.emitter.removeEventListener("resume",i),eL(!1),e&&clearTimeout(e),t=!0}},[K,eu.emitter]),(0,n.useImperativeHandle)(t,()=>{let e={play:eu.play,pause:()=>{ei(!1),eu.pause()},toggle:ef,getContainerNode:()=>ee.current,getCurrentFrame:eu.getCurrentFrame,isPlaying:eu.isPlaying,seekTo:e=>{let t=ey-1,r=Math.max(0,Math.min(t,e));eu.isPlaying()&&(ei(r!==t||d),eu.pause()),r!==t||d||eu.emitter.dispatchEnded(),eu.seek(r)},isFullscreen:()=>{let{current:e}=ee;return!!e&&(document.fullscreenElement===e||document.webkitFullscreenElement===e)},requestFullscreen:em,exitFullscreen:ep,getVolume:()=>eI?0:eE,setVolume:e=>{if("number"!=typeof e)throw TypeError("setVolume() takes a number, got value of type ".concat(typeof e));if(isNaN(e))throw TypeError("setVolume() got a number that is NaN. Volume must be between 0 and 1.");if(e<0||e>1)throw TypeError("setVolume() got a number that is out of range. Must be between 0 and 1, got ".concat(typeof e));ex(e)},isMuted:()=>eM,mute:()=>{eP(!0)},unmute:()=>{eP(!1)},getScale:()=>ew,pauseAndReturnToPlayStart:()=>{eu.pauseAndReturnToPlayStart()}};return Object.assign(eu.emitter,e)},[ey,ep,d,eI,eM,eE,eu,em,eP,ex,ef,ew]);let eU=Y?Y.component:null,eR=(0,n.useMemo)(()=>k({canvasSize:et,config:G,style:c,overflowVisible:X,layout:ek}),[et,G,ek,X,c]),eD=(0,n.useMemo)(()=>v({config:G,layout:ek,scale:ew,overflowVisible:X}),[G,ek,X,ew]),eN=(0,n.useMemo)(()=>w({config:G,layout:ek,scale:ew,overflowVisible:X}),[G,ek,X,ew]),e_=eu.pause,ez=eu.emitter.dispatchError,eO=(0,n.useCallback)(e=>{e_(),ez(e)},[ez,e_]),eV=(0,n.useCallback)(e=>{e.stopPropagation(),em()},[em]),e$=(0,n.useCallback)(e=>{e.stopPropagation(),ep()},[ep]),ej=(0,n.useCallback)(e=>{(e instanceof MouseEvent?2!==e.button:!e.nativeEvent.button)&&ef(e)},[ef]),eH=(0,n.useCallback)(()=>{ec(!0)},[]),eq=(0,n.useCallback)(()=>{ec(!1)},[]),{handlePointerDown:eK,handleDoubleClick:eW}=eA(ej,(0,n.useCallback)(()=>{es?ep():em()},[ep,es,em]),g&&h&&ed);(0,n.useEffect)(()=>{ea&&(eu.play(),en(!1))},[ea,eu]);let eX=(0,n.useMemo)(()=>S?S({height:eR.height,width:eR.width,isBuffering:eB}):null,[eR.height,eR.width,S,eB]),eQ=(0,n.useMemo)(()=>({type:"scale",scale:ew}),[ew]);if(!G)return null;let eJ=C?C({height:"player-size"===q?eR.height:G.height,width:"player-size"===q?eR.width:G.width,isBuffering:eB}):null;if(void 0===eJ)throw TypeError("renderPoster() must return a React element, but undefined was returned");let eZ=eJ&&[F&&!eu.isPlaying()&&!el,M&&eu.isLastFrame&&!eu.isPlaying(),E&&!eu.hasPlayed&&!eu.isPlaying(),B&&eB&&eu.isPlaying(),L&&eB&&!eu.isPlaying()].some(Boolean),{left:eG,top:eY,width:e0,height:e1,...e2}=eD,e3=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:eD,onPointerDown:m?eK:void 0,onDoubleClick:g?eW:void 0,children:[(0,i.jsxs)("div",{style:eN,className:eS(J),children:[eU?(0,i.jsx)(eb,{onError:eO,errorFallback:x,children:(0,i.jsx)(a.Xp.CurrentScaleContext.Provider,{value:eQ,children:(0,i.jsx)(eU,{...null!==(o=null==Y?void 0:Y.props)&&void 0!==o?o:{},...null!=f?f:{}})})}):null,eZ&&"composition-size"===q?(0,i.jsx)("div",{style:{...e2,width:G.width,height:G.height},onPointerDown:m?eK:void 0,onDoubleClick:g?eW:void 0,children:eJ}):null]}),(0,i.jsx)(eT,{})]}),eZ&&"player-size"===q?(0,i.jsx)("div",{style:eD,onPointerDown:m?eK:void 0,onDoubleClick:g?eW:void 0,children:eJ}):null,l?(0,i.jsx)(eg,{fps:G.fps,playing:eu.playing,toggle:eu.toggle,durationInFrames:G.durationInFrames,containerRef:ee,onFullscreenButtonClick:eV,isFullscreen:es,allowFullscreen:h,showVolumeControls:p,onExitFullscreenButtonClick:e$,spaceKeyToPlayOrPause:y,onSeekEnd:eq,onSeekStart:eH,inFrame:R,outFrame:N,initiallyShowControls:_,canvasSize:et,renderFullscreenButton:z,renderPlayPauseButton:O,alwaysShowControls:j,showPlaybackRateControl:H,buffering:eB,hideControlsWhenPointerDoesntMove:W,onDoubleClick:g?eW:void 0,onPointerDown:m?eK:void 0,renderMuteButton:V,renderVolumeSlider:$}):null]});return Z||eC&&!eF?(0,i.jsx)("div",{ref:ee,style:eR,className:P,children:e3}):(0,i.jsx)("div",{ref:ee,style:eR,className:P,children:(0,i.jsx)(n.Suspense,{fallback:eX,children:e3})})}),eL="remotion.volumePreference",eU=(e,t,r)=>{if("undefined"!=typeof window)try{window.localStorage.setItem(null!=r?r:eL,String(e))}catch(e){a.Xp.Log.error({logLevel:t,tag:null},"Could not persist volume",e)}},eR=e=>{if("undefined"==typeof window)return 1;try{let t=window.localStorage.getItem(null!=e?e:eL);return t?Number(t):1}catch(e){return 1}},eD="player-comp",eN=e=>{let{children:t,timelineContext:r,fps:s,compositionHeight:o,compositionWidth:l,durationInFrames:c,component:d,numberOfSharedAudioTags:u,initiallyMuted:h,logLevel:f,audioLatencyHint:m,volumePersistenceKey:p,inputProps:g,audioEnabled:y}=e,b=(0,n.useMemo)(()=>({compositions:[{component:d,durationInFrames:c,height:o,width:l,fps:s,id:eD,nonce:777,folderName:null,parentFolderName:null,schema:null,calculateMetadata:null}],folders:[],currentCompositionMetadata:{defaultCodec:null,defaultOutName:null,defaultPixelFormat:null,defaultProResProfile:null,defaultVideoImageFormat:null,durationInFrames:c,fps:s,height:o,width:l,props:g},canvasContent:{type:"composition",compositionId:"player-comp"}}),[d,c,o,l,s,g]),[k,w]=(0,n.useState)(()=>h),[v,x]=(0,n.useState)(()=>eR(null!=p?p:null)),T=(0,n.useMemo)(()=>({mediaMuted:k,mediaVolume:v}),[k,v]),S=(0,n.useCallback)(e=>{x(e),eU(e,f,null!=p?p:null)},[f,p]),C=(0,n.useMemo)(()=>({setMediaMuted:w,setMediaVolume:S}),[S]),P=(0,n.useMemo)(()=>({logLevel:f,mountTime:Date.now()}),[f]),I=(0,n.useMemo)(()=>({isPlayer:!0,isRendering:!1,isStudio:!1,isClientSideRendering:!1,isReadOnlyStudio:!1}),[]);return(0,i.jsx)(a.Xp.RemotionEnvironmentContext.Provider,{value:I,children:(0,i.jsx)(a.Xp.LogLevelContext.Provider,{value:P,children:(0,i.jsx)(a.Xp.CanUseRemotionHooksProvider,{children:(0,i.jsx)(a.Xp.TimelineContext.Provider,{value:r,children:(0,i.jsx)(a.Xp.CompositionManager.Provider,{value:b,children:(0,i.jsx)(a.Xp.PrefetchProvider,{children:(0,i.jsx)(a.Xp.DurationsContextProvider,{children:(0,i.jsx)(a.Xp.MediaVolumeContext.Provider,{value:T,children:(0,i.jsx)(a.Xp.SetMediaVolumeContext.Provider,{value:C,children:(0,i.jsx)(a.Xp.SharedAudioContextProvider,{numberOfAudioTags:u,audioLatencyHint:m,audioEnabled:y,children:(0,i.jsx)(a.Xp.BufferingProvider,{children:t})})})})})})})})})})})},e_=!1,ez=(e,t)=>{!e&&!e_&&(e_=!0,a.Xp.Log.warn({logLevel:t,tag:null},"Note: Some companies are required to obtain a license to use Remotion. See: https://remotion.dev/license\nPass the `acknowledgeRemotionLicense` prop to `<Player />` function to make this message disappear."))},eO=(e,t)=>{if(null==e)return null!=e?e:null;if("number"!=typeof e)throw TypeError('"'.concat(t,'" must be a number, but is ').concat(JSON.stringify(e)));if(Number.isNaN(e))throw TypeError('"'.concat(t,'" must not be NaN, but is ').concat(JSON.stringify(e)));if(!Number.isFinite(e))throw TypeError('"'.concat(t,'" must be finite, but is ').concat(JSON.stringify(e)));if(e%1!=0)throw TypeError('"'.concat(t,'" must be an integer, but is ').concat(JSON.stringify(e)));return e},eV=e=>{let{inFrame:t,durationInFrames:r,outFrame:i}=e,a=eO(t,"inFrame"),n=eO(i,"outFrame");if(null!==a||null!==n){if(null!==a&&a>r-1)throw Error("inFrame must be less than (durationInFrames - 1), but is "+a);if(null!==n&&n>r-1)throw Error("outFrame must be less than (durationInFrames - 1), but is "+n);if(null!==a&&a<0)throw Error("inFrame must be greater than 0, but is "+a);if(null!==n&&n<=0)throw Error("outFrame must be greater than 0, but is ".concat(n,". If you want to render a single frame, use <Thumbnail /> instead."));if(null!==n&&null!==a&&n<=a)throw Error("outFrame must be greater than inFrame, but is "+n+" <= "+a)}},e$=e=>{let{initialFrame:t,durationInFrames:r}=e;if("number"!=typeof r)throw Error("`durationInFrames` must be a number, but is ".concat(JSON.stringify(r)));if(void 0!==t){if("number"!=typeof t)throw Error("`initialFrame` must be a number, but is ".concat(JSON.stringify(t)));if(Number.isNaN(t))throw Error("`initialFrame` must be a number, but is NaN");if(!Number.isFinite(t))throw Error("`initialFrame` must be a number, but is Infinity");if(t%1!=0)throw Error("`initialFrame` must be an integer, but is ".concat(JSON.stringify(t)));if(t>r-1)throw Error("`initialFrame` must be less or equal than `durationInFrames - 1`, but is ".concat(JSON.stringify(t)))}},ej=e=>{if(void 0!==e){if(e>4)throw Error("The highest possible playback rate is 4. You passed: ".concat(e));if(e<-4)throw Error("The lowest possible playback rate is -4. You passed: ".concat(e));if(0===e)throw Error("A playback rate of 0 is not supported.")}},eH=s.JC.validateFps,eq=s.JC.validateDimension,eK=s.JC.validateDurationInFrames,eW=s.JC.validateDefaultAndInputProps,eX=e=>"component"in e?e.component:null,eQ=(0,n.forwardRef)((e,t)=>{let{durationInFrames:r,compositionHeight:s,compositionWidth:o,fps:l,inputProps:c,style:d,controls:u=!1,loop:h=!1,autoPlay:f=!1,showVolumeControls:m=!0,allowFullscreen:p=!0,clickToPlay:g,doubleClickToFullscreen:y=!1,spaceKeyToPlayOrPause:b=!0,moveToBeginningWhenEnded:k=!0,numberOfSharedAudioTags:w=5,errorFallback:v=()=>"⚠️",playbackRate:x=1,renderLoading:T,className:S,showPosterWhenUnplayed:C,showPosterWhenEnded:P,showPosterWhenPaused:E,showPosterWhenBuffering:A,showPosterWhenBufferingAndPaused:M,initialFrame:F,renderPoster:B,inFrame:L,outFrame:U,initiallyShowControls:R,renderFullscreenButton:D,renderPlayPauseButton:N,renderVolumeSlider:_,alwaysShowControls:z=!1,initiallyMuted:O=!1,showPlaybackRateControl:V=!1,posterFillMode:$="player-size",bufferStateDelayInMilliseconds:j,hideControlsWhenPointerDoesntMove:H=!0,overflowVisible:q=!1,renderMuteButton:K,browserMediaControlsBehavior:W,overrideInternalClassName:X,logLevel:Q="info",noSuspense:J,acknowledgeRemotionLicense:Z,audioLatencyHint:G="interactive",volumePersistenceKey:Y,...ee}=e;if("undefined"!=typeof window&&(window.remotion_isPlayer=!0),void 0!==ee.defaultProps)throw Error("The <Player /> component does not accept `defaultProps`, but some were passed. Use `inputProps` instead.");let et=eX(ee);if((null==et?void 0:et.type)===a.BO)throw TypeError("'component' should not be an instance of <Composition/>. Pass the React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");if(et===a.BO)throw TypeError("'component' must not be the 'Composition' component. Pass your own React component directly, and set the duration, fps and dimensions as separate props. See https://www.remotion.dev/docs/player/examples for an example.");(0,n.useState)(()=>ez(!!Z,Q));let er=a.Xp.useLazyComponent({compProps:ee,componentName:"Player",noSuspense:!!J});e$({initialFrame:F,durationInFrames:r});let[ei,ea]=(0,n.useState)(()=>({[eD]:null!=F?F:0})),[en,es]=(0,n.useState)(!1),[eo]=(0,n.useState)("player-comp"),el=(0,n.useRef)(null),ec=(0,n.useRef)([]),ed=(0,n.useRef)(!1),[eu,eh]=(0,n.useState)(x);if("number"!=typeof s)throw TypeError("'compositionHeight' must be a number but got '".concat(typeof s,"' instead"));if("number"!=typeof o)throw TypeError("'compositionWidth' must be a number but got '".concat(typeof o,"' instead"));if(eq(s,"compositionHeight","of the <Player /> component"),eq(o,"compositionWidth","of the <Player /> component"),eK(r,{component:"of the <Player/> component",allowFloats:!1}),eH(l,"as a prop of the <Player/> component",!1),eW(c,"inputProps",null),eV({durationInFrames:r,inFrame:L,outFrame:U}),"boolean"!=typeof u&&void 0!==u)throw TypeError("'controls' must be a boolean or undefined but got '".concat(typeof u,"' instead"));if("boolean"!=typeof f&&void 0!==f)throw TypeError("'autoPlay' must be a boolean or undefined but got '".concat(typeof f,"' instead"));if("boolean"!=typeof h&&void 0!==h)throw TypeError("'loop' must be a boolean or undefined but got '".concat(typeof h,"' instead"));if("boolean"!=typeof y&&void 0!==y)throw TypeError("'doubleClickToFullscreen' must be a boolean or undefined but got '".concat(typeof y,"' instead"));if("boolean"!=typeof m&&void 0!==m)throw TypeError("'showVolumeControls' must be a boolean or undefined but got '".concat(typeof m,"' instead"));if("boolean"!=typeof p&&void 0!==p)throw TypeError("'allowFullscreen' must be a boolean or undefined but got '".concat(typeof p,"' instead"));if("boolean"!=typeof g&&void 0!==g)throw TypeError("'clickToPlay' must be a boolean or undefined but got '".concat(typeof g,"' instead"));if("boolean"!=typeof b&&void 0!==b)throw TypeError("'spaceKeyToPlayOrPause' must be a boolean or undefined but got '".concat(typeof b,"' instead"));if("number"!=typeof w||w%1!=0||!Number.isFinite(w)||Number.isNaN(w)||w<0)throw TypeError("'numberOfSharedAudioTags' must be an integer but got '".concat(w,"' instead"));ej(eu),(0,n.useEffect)(()=>{eh(x)},[x]),(0,n.useImperativeHandle)(t,()=>el.current,[]),(0,n.useState)(()=>{a.Xp.playbackLogging({logLevel:Q,message:"[player] Mounting <Player>. User agent = ".concat("undefined"==typeof navigator?"server":navigator.userAgent),tag:"player",mountTime:Date.now()})});let ef=(0,n.useMemo)(()=>({frame:ei,playing:en,rootId:eo,playbackRate:eu,imperativePlaying:ed,setPlaybackRate:e=>{eh(e)},audioAndVideoTags:ec}),[ei,eu,en,eo]),em=(0,n.useMemo)(()=>({setFrame:ea,setPlaying:es}),[ea]);"undefined"!=typeof window&&(0,n.useLayoutEffect)(()=>{a.Xp.CSSUtils.injectCSS(a.Xp.CSSUtils.makeDefaultPreviewCSS(".".concat(eS(X)),"#fff"))},[X]);let ep=(0,n.useMemo)(()=>null!=c?c:{},[c]),eg=(0,n.useMemo)(()=>null!=W?W:{mode:"prevent-media-session"},[W]);return(0,i.jsx)(a.Xp.IsPlayerContextProvider,{children:(0,i.jsx)(eN,{timelineContext:ef,component:er,compositionHeight:s,compositionWidth:o,durationInFrames:r,fps:l,numberOfSharedAudioTags:w,initiallyMuted:O,logLevel:Q,audioLatencyHint:G,volumePersistenceKey:Y,inputProps:ep,audioEnabled:!0,children:(0,i.jsx)(a.Xp.SetTimelineContext.Provider,{value:em,children:(0,i.jsx)(I,{currentPlaybackRate:eu,children:(0,i.jsx)(eB,{ref:el,posterFillMode:$,renderLoading:T,autoPlay:!!f,loop:!!h,controls:!!u,errorFallback:v,style:d,inputProps:ep,allowFullscreen:!!p,moveToBeginningWhenEnded:!!k,clickToPlay:"boolean"==typeof g?g:!!u,showVolumeControls:!!m,doubleClickToFullscreen:!!y,spaceKeyToPlayOrPause:!!b,playbackRate:eu,className:null!=S?S:void 0,showPosterWhenUnplayed:!!C,showPosterWhenEnded:!!P,showPosterWhenPaused:!!E,showPosterWhenBuffering:!!A,showPosterWhenBufferingAndPaused:!!M,renderPoster:B,inFrame:null!=L?L:null,outFrame:null!=U?U:null,initiallyShowControls:null==R||R,renderFullscreen:null!=D?D:null,renderPlayPauseButton:null!=N?N:null,renderMuteButton:null!=K?K:null,renderVolumeSlider:null!=_?_:null,alwaysShowControls:z,showPlaybackRateControl:V,bufferStateDelayInMilliseconds:null!=j?j:300,hideControlsWhenPointerDoesntMove:H,overflowVisible:q,browserMediaControlsBehavior:eg,overrideInternalClassName:null!=X?X:void 0,noSuspense:!!J})})})})})}),eJ=()=>{let e=(0,n.useContext)(T);if(!e)throw TypeError("Expected Player event emitter context");return(0,n.useMemo)(()=>({emitter:e}),[e])},eZ=n.version.split(".")[0];if("0"===eZ)throw Error("Version ".concat(eZ,' of "react" is not supported by Remotion'));var eG=parseInt(eZ,10)>=18,eY=(0,n.forwardRef)((e,t)=>{var r,s;let{style:o,inputProps:l,errorFallback:c,renderLoading:d,className:u,overflowVisible:h,noSuspense:f,overrideInternalClassName:m}=e,p=a.Xp.useUnsafeVideoConfig(),g=a.Xp.useVideo(),y=(0,n.useRef)(null),x=D(y,{triggerOnWindowResize:!1,shouldApplyCssTransforms:!1}),T=(0,n.useMemo)(()=>p&&x?b({canvasSize:x,compositionHeight:p.height,compositionWidth:p.width,previewSize:"auto"}):null,[x,p]),S=null!==(r=null==T?void 0:T.scale)&&void 0!==r?r:1,C=eJ();P(C.emitter),(0,n.useImperativeHandle)(t,()=>Object.assign(C.emitter,{getContainerNode:()=>y.current,getScale:()=>S}),[S,C.emitter]);let I=g?g.component:null,E=(0,n.useMemo)(()=>k({config:p,style:o,canvasSize:x,overflowVisible:h,layout:T}),[x,p,T,h,o]),A=(0,n.useMemo)(()=>v({config:p,layout:T,scale:S,overflowVisible:h}),[p,T,h,S]),M=(0,n.useMemo)(()=>w({config:p,layout:T,scale:S,overflowVisible:h}),[p,T,h,S]),F=(0,n.useCallback)(e=>{C.emitter.dispatchError(e)},[C.emitter]),B=(0,n.useMemo)(()=>d?d({height:E.height,width:E.width,isBuffering:!1}):null,[E.height,E.width,d]),L=(0,n.useMemo)(()=>({type:"scale",scale:S}),[S]);if(!p)return null;let U=(0,i.jsx)("div",{style:A,children:(0,i.jsx)("div",{style:M,className:eS(m),children:I?(0,i.jsx)(eb,{onError:F,errorFallback:c,children:(0,i.jsx)(a.Xp.CurrentScaleContext.Provider,{value:L,children:(0,i.jsx)(I,{...null!==(s=null==g?void 0:g.props)&&void 0!==s?s:{},...null!=l?l:{}})})}):null})});return f||eC&&!eG?(0,i.jsx)("div",{ref:y,style:E,className:u,children:U}):(0,i.jsx)("div",{ref:y,style:E,className:u,children:(0,i.jsx)(n.Suspense,{fallback:B,children:U})})});(0,n.forwardRef)((e,t)=>{let{frameToDisplay:r,style:s,inputProps:o,compositionHeight:l,compositionWidth:c,durationInFrames:d,fps:u,className:h,errorFallback:f=()=>"⚠️",renderLoading:m,overflowVisible:p=!1,overrideInternalClassName:g,logLevel:y="info",noSuspense:b,...k}=e;"undefined"!=typeof window&&(0,n.useLayoutEffect)(()=>{window.remotion_isPlayer=!0},[]);let[w]=(0,n.useState)(()=>String((0,a.yT)(null))),v=(0,n.useRef)(null),x=(0,n.useMemo)(()=>({playing:!1,frame:{[eD]:r},rootId:w,imperativePlaying:{current:!1},playbackRate:1,setPlaybackRate:()=>{throw Error("thumbnail")},audioAndVideoTags:{current:[]}}),[r,w]);(0,n.useImperativeHandle)(t,()=>v.current,[]);let S=a.Xp.useLazyComponent({compProps:k,componentName:"Thumbnail",noSuspense:!!b}),[P]=(0,n.useState)(()=>new C),I=(0,n.useMemo)(()=>null!=o?o:{},[o]);return(0,i.jsx)(a.Xp.IsPlayerContextProvider,{children:(0,i.jsx)(eN,{timelineContext:x,component:S,compositionHeight:l,compositionWidth:c,durationInFrames:d,fps:u,numberOfSharedAudioTags:0,initiallyMuted:!0,logLevel:y,audioLatencyHint:"playback",inputProps:I,audioEnabled:!1,children:(0,i.jsx)(T.Provider,{value:P,children:(0,i.jsx)(eY,{ref:v,className:h,errorFallback:f,inputProps:I,renderLoading:m,style:s,overflowVisible:p,overrideInternalClassName:g,noSuspense:!!b})})})})})},1154:(e,t,r)=>{r.d(t,{O8:()=>P,Yy:()=>x,kQ:()=>p,lc:()=>v,qw:()=>C});var i=r(3468),a=r(5799),n=r(2925),s=r(6194),o=r(8244),l=r(8734),c=r(5854),d=r(7914),u=r(5356);let h=e=>{if(!e||"object"!=typeof e)throw TypeError("options must be an object.");if(void 0!==e.metadataOnly&&"boolean"!=typeof e.metadataOnly)throw TypeError("options.metadataOnly, when defined, must be a boolean.");if(void 0!==e.verifyKeyPackets&&"boolean"!=typeof e.verifyKeyPackets)throw TypeError("options.verifyKeyPackets, when defined, must be a boolean.");if(e.verifyKeyPackets&&e.metadataOnly)throw TypeError("options.verifyKeyPackets and options.metadataOnly cannot be enabled together.")},f=e=>{if(!(0,l.Et)(e))throw TypeError("timestamp must be a number.")},m=(e,t,r)=>r.verifyKeyPackets?t.then(async t=>{if(!t||"delta"===t.type)return t;let r=await e.determinePacketType(t);return r&&(t.type=r),t}):t;class p{constructor(e){if(!(e instanceof o.Kh))throw TypeError("track must be an InputTrack.");this._track=e}getFirstPacket(e={}){if(h(e),this._track.input._disposed)throw new s.Q;return m(this._track,this._track._backing.getFirstPacket(e),e)}getPacket(e,t={}){if(f(e),h(t),this._track.input._disposed)throw new s.Q;return m(this._track,this._track._backing.getPacket(e,t),t)}getNextPacket(e,t={}){if(!(e instanceof c.Z))throw TypeError("packet must be an EncodedPacket.");if(h(t),this._track.input._disposed)throw new s.Q;return m(this._track,this._track._backing.getNextPacket(e,t),t)}async getKeyPacket(e,t={}){if(f(e),h(t),this._track.input._disposed)throw new s.Q;if(!t.verifyKeyPackets)return this._track._backing.getKeyPacket(e,t);let r=await this._track._backing.getKeyPacket(e,t);return r&&((0,l.vA)("key"===r.type),"delta"===await this._track.determinePacketType(r))?this.getKeyPacket(r.timestamp-1/this._track.timeResolution,t):r}async getNextKeyPacket(e,t={}){if(!(e instanceof c.Z))throw TypeError("packet must be an EncodedPacket.");if(h(t),this._track.input._disposed)throw new s.Q;if(!t.verifyKeyPackets)return this._track._backing.getNextKeyPacket(e,t);let r=await this._track._backing.getNextKeyPacket(e,t);return r&&((0,l.vA)("key"===r.type),"delta"===await this._track.determinePacketType(r))?this.getNextKeyPacket(r,t):r}packets(e,t,r={}){if(void 0!==e&&!(e instanceof c.Z))throw TypeError("startPacket must be an EncodedPacket.");if(void 0!==e&&e.isMetadataOnly&&!r?.metadataOnly)throw TypeError("startPacket can only be metadata-only if options.metadataOnly is enabled.");if(void 0!==t&&!(t instanceof c.Z))throw TypeError("endPacket must be an EncodedPacket.");if(h(r),this._track.input._disposed)throw new s.Q;let i=[],{promise:a,resolve:n}=(0,l.nJ)(),{promise:o,resolve:d}=(0,l.nJ)(),u=!1,f=!1,m=null,p=[],g=()=>Math.max(2,p.length);(async()=>{let s=e??await this.getFirstPacket(r);for(;s&&!f&&!this._track.input._disposed&&!(t&&s.sequenceNumber>=t?.sequenceNumber);){if(i.length>g()){({promise:o,resolve:d}=(0,l.nJ)()),await o;continue}i.push(s),n(),({promise:a,resolve:n}=(0,l.nJ)()),s=await this.getNextPacket(s,r)}u=!0,n()})().catch(e=>{m||(m=e,n())});let y=this._track;return{async next(){for(;;){if(y.input._disposed)throw new s.Q;if(f)return{value:void 0,done:!0};if(m)throw m;else if(i.length>0){let e=i.shift(),t=performance.now();for(p.push(t);p.length>0&&t-p[0]>=1e3;)p.shift();return d(),{value:e,done:!1}}else{if(u)return{value:void 0,done:!0};await a}}},return:async()=>(f=!0,d(),n(),{value:void 0,done:!0}),async throw(e){throw e},[Symbol.asyncIterator](){return this}}}}class g{constructor(e,t){this.onSample=e,this.onError=t}}class y{mediaSamplesInRange(e=0,t=1/0){f(e),f(t);let r=[],i=!1,a=null,{promise:n,resolve:o}=(0,l.nJ)(),{promise:c,resolve:d}=(0,l.nJ)(),u=!1,h=!1,m=!1,p=null;(async()=>{let s=await this._createDecoder(s=>{if(d(),s.timestamp>=t&&(h=!0),h){s.close();return}a&&(s.timestamp>e?(r.push(a),i=!0):a.close()),s.timestamp>=e&&(r.push(s),i=!0),a=i?null:s,r.length>0&&(o(),{promise:n,resolve:o}=(0,l.nJ)())},e=>{p||(p=e,o())}),f=this._createPacketSink(),g=await f.getKeyPacket(e,{verifyKeyPackets:!0})??await f.getFirstPacket(),y=g,k=f.packets(g??void 0,void 0);for(await k.next();y&&!h&&!this._track.input._disposed;){let e=b(r.length);if(r.length+s.getDecodeQueueSize()>e){({promise:c,resolve:d}=(0,l.nJ)()),await c;continue}s.decode(y);let t=await k.next();if(t.done)break;y=t.value}await k.return(),m||this._track.input._disposed||await s.flush(),s.close(),!i&&a&&r.push(a),u=!0,o()})().catch(e=>{p||(p=e,o())});let g=this._track,y=()=>{for(let e of(a?.close(),r))e.close()};return{async next(){for(;;){if(g.input._disposed)throw y(),new s.Q;if(m)return{value:void 0,done:!0};if(p)throw y(),p;else if(r.length>0){let e=r.shift();return d(),{value:e,done:!1}}else{if(u)return{value:void 0,done:!0};await n}}},return:async()=>(m=!0,h=!0,d(),o(),y(),{value:void 0,done:!0}),async throw(e){throw e},[Symbol.asyncIterator](){return this}}}mediaSamplesAtTimestamps(e){(0,l.D5)(e);let t=(0,l.i1)(e),r=[],i=[],{promise:a,resolve:n}=(0,l.nJ)(),{promise:o,resolve:c}=(0,l.nJ)(),d=!1,u=!1,h=null,m=e=>{i.push(e),n(),{promise:a,resolve:n}=(0,l.nJ)()};(async()=>{let e=await this._createDecoder(e=>{if(c(),u){e.close();return}let t=0;for(;r.length>0&&e.timestamp-r[0]>-1e-10;)t++,r.shift();if(t>0)for(let r=0;r<t;r++)m(r<t-1?e.clone():e);else e.close()},e=>{h||(h=e,n())}),a=this._createPacketSink(),s=null,p=null,g=-1,y=async()=>{(0,l.vA)(p);let t=p;for(e.decode(t);t.sequenceNumber<g;){let r=b(i.length);for(;i.length+e.getDecodeQueueSize()>r&&!u;)({promise:o,resolve:c}=(0,l.nJ)()),await o;if(u)break;let n=await a.getNextPacket(t);(0,l.vA)(n),e.decode(n),t=n}g=-1},k=async()=>{await e.flush();for(let e=0;e<r.length;e++)m(null);r.length=0};for await(let e of t){if(f(e),u||this._track.input._disposed)break;let t=await a.getPacket(e),i=t&&await a.getKeyPacket(e,{verifyKeyPackets:!0});if(!i){-1!==g&&(await y(),await k()),m(null),s=null;continue}s&&(i.sequenceNumber!==p.sequenceNumber||t.timestamp<s.timestamp)&&(await y(),await k()),r.push(t.timestamp),g=Math.max(t.sequenceNumber,g),s=t,p=i}u||this._track.input._disposed||(-1!==g&&await y(),await k()),e.close(),d=!0,n()})().catch(e=>{h||(h=e,n())});let p=this._track,g=()=>{for(let e of i)e?.close()};return{async next(){for(;;){if(p.input._disposed)throw g(),new s.Q;if(u)return{value:void 0,done:!0};if(h)throw g(),h;else if(i.length>0){let e=i.shift();return(0,l.vA)(void 0!==e),c(),{value:e,done:!1}}else{if(d)return{value:void 0,done:!0};await a}}},return:async()=>(u=!0,c(),n(),g(),{value:void 0,done:!0}),async throw(e){throw e},[Symbol.asyncIterator](){return this}}}}let b=e=>0===e?40:8;class k extends g{constructor(e,t,r,i,s,o){super(e,t),this.codec=r,this.decoderConfig=i,this.rotation=s,this.timeResolution=o,this.decoder=null,this.customDecoder=null,this.customDecoderCallSerializer=new l.dY,this.customDecoderQueueSize=0,this.inputTimestamps=[],this.sampleQueue=[],this.currentPacketIndex=0,this.raslSkipped=!1,this.alphaDecoder=null,this.alphaHadKeyframe=!1,this.colorQueue=[],this.alphaQueue=[],this.merger=null,this.mergerCreationFailed=!1,this.decodedAlphaChunkCount=0,this.alphaDecoderQueueSize=0,this.nullAlphaFrameQueue=[],this.currentAlphaPacketIndex=0,this.alphaRaslSkipped=!1;let c=n.wb.find(e=>e.supports(r,i));if(c)this.customDecoder=new c,this.customDecoder.codec=r,this.customDecoder.config=i,this.customDecoder.onSample=e=>{if(!(e instanceof u.U2))throw TypeError("The argument passed to onSample must be a VideoSample.");this.finalizeAndEmitSample(e)},this.customDecoderCallSerializer.call(()=>this.customDecoder.init());else{let e=e=>{if(this.alphaQueue.length>0){let t=this.alphaQueue.shift();(0,l.vA)(void 0!==t),this.mergeAlpha(e,t)}else this.colorQueue.push(e)};if("avc"===r&&this.decoderConfig.description&&(0,l.F2)()){let e=(0,a.BP)((0,l.Fo)(this.decoderConfig.description));if(e&&e.sequenceParameterSets.length>0){let t=(0,a.eM)(e.sequenceParameterSets[0]);t&&0===t.frameMbsOnlyFlag&&(this.decoderConfig={...this.decoderConfig,hardwareAcceleration:"prefer-software"})}}let t=Error("Decoding error").stack;this.decoder=new VideoDecoder({output:t=>{try{e(t)}catch(e){this.onError(e)}},error:e=>{e.stack=t,this.onError(e)}}),this.decoder.configure(this.decoderConfig)}}getDecodeQueueSize(){return this.customDecoder?this.customDecoderQueueSize:((0,l.vA)(this.decoder),Math.max(this.decoder.decodeQueueSize,this.alphaDecoder?.decodeQueueSize??0))}decode(e){if("hevc"===this.codec&&this.currentPacketIndex>0&&!this.raslSkipped){if(this.hasHevcRaslPicture(e.data))return;this.raslSkipped=!0}if(this.customDecoder)this.customDecoderQueueSize++,this.customDecoderCallSerializer.call(()=>this.customDecoder.decode(e)).then(()=>this.customDecoderQueueSize--);else{if((0,l.vA)(this.decoder),(0,l.Tc)()||(0,l.h8)(this.inputTimestamps,e.timestamp,e=>e),(0,l.F2)()&&0===this.currentPacketIndex&&"avc"===this.codec){let t=[];for(let r of(0,a.RO)(e.data,this.decoderConfig)){let i=(0,a.uN)(e.data[r.offset]);i>=20&&i<=31||t.push(e.data.subarray(r.offset,r.offset+r.length))}let r=(0,a.Zi)(t,this.decoderConfig);e=new c.Z(r,e.type,e.timestamp,e.duration)}this.decoder.decode(e.toEncodedVideoChunk()),this.decodeAlphaData(e)}this.currentPacketIndex++}decodeAlphaData(e){if(!e.sideData.alpha||this.mergerCreationFailed){this.pushNullAlphaFrame();return}if(!this.merger)try{this.merger=new w}catch(t){console.error("Due to an error, only color data will be decoded.",t),this.mergerCreationFailed=!0,this.decodeAlphaData(e);return}if(!this.alphaDecoder){let e=e=>{if(this.alphaDecoderQueueSize--,this.colorQueue.length>0){let t=this.colorQueue.shift();(0,l.vA)(void 0!==t),this.mergeAlpha(t,e)}else this.alphaQueue.push(e);for(this.decodedAlphaChunkCount++;this.nullAlphaFrameQueue.length>0&&this.nullAlphaFrameQueue[0]===this.decodedAlphaChunkCount;)if(this.nullAlphaFrameQueue.shift(),this.colorQueue.length>0){let e=this.colorQueue.shift();(0,l.vA)(void 0!==e),this.mergeAlpha(e,null)}else this.alphaQueue.push(null)},t=Error("Decoding error").stack;this.alphaDecoder=new VideoDecoder({output:t=>{try{e(t)}catch(e){this.onError(e)}},error:e=>{e.stack=t,this.onError(e)}}),this.alphaDecoder.configure(this.decoderConfig)}let t=(0,a.PR)(this.codec,this.decoderConfig,e.sideData.alpha);if(this.alphaHadKeyframe||(this.alphaHadKeyframe="key"===t),this.alphaHadKeyframe){if("hevc"===this.codec&&this.currentAlphaPacketIndex>0&&!this.alphaRaslSkipped){if(this.hasHevcRaslPicture(e.sideData.alpha)){this.pushNullAlphaFrame();return}this.alphaRaslSkipped=!0}this.currentAlphaPacketIndex++,this.alphaDecoder.decode(e.alphaToEncodedVideoChunk(t??e.type)),this.alphaDecoderQueueSize++}else this.pushNullAlphaFrame()}pushNullAlphaFrame(){0===this.alphaDecoderQueueSize?this.alphaQueue.push(null):this.nullAlphaFrameQueue.push(this.decodedAlphaChunkCount+this.alphaDecoderQueueSize)}hasHevcRaslPicture(e){for(let t of(0,a.RF)(e,this.decoderConfig)){let r=(0,a.O9)(e[t.offset]);if(r===a.iJ.RASL_N||r===a.iJ.RASL_R)return!0}return!1}sampleHandler(e){if((0,l.Tc)()){if(this.sampleQueue.length>0&&e.timestamp>=(0,l._g)(this.sampleQueue).timestamp){for(let e of this.sampleQueue)this.finalizeAndEmitSample(e);this.sampleQueue.length=0}(0,l.h8)(this.sampleQueue,e,e=>e.timestamp)}else{let t=this.inputTimestamps.shift();(0,l.vA)(void 0!==t),e.setTimestamp(t),this.finalizeAndEmitSample(e)}}finalizeAndEmitSample(e){e.setTimestamp(Math.round(e.timestamp*this.timeResolution)/this.timeResolution),e.setDuration(Math.round(e.duration*this.timeResolution)/this.timeResolution),e.setRotation(this.rotation),this.onSample(e)}mergeAlpha(e,t){if(!t){let t=new u.U2(e);this.sampleHandler(t);return}(0,l.vA)(this.merger),this.merger.update(e,t),e.close(),t.close();let r=new VideoFrame(this.merger.canvas,{timestamp:e.timestamp,duration:e.duration??void 0}),i=new u.U2(r);this.sampleHandler(i)}async flush(){if(this.customDecoder?await this.customDecoderCallSerializer.call(()=>this.customDecoder.flush()):((0,l.vA)(this.decoder),await Promise.all([this.decoder.flush(),this.alphaDecoder?.flush()]),this.colorQueue.forEach(e=>e.close()),this.colorQueue.length=0,this.alphaQueue.forEach(e=>e?.close()),this.alphaQueue.length=0,this.alphaHadKeyframe=!1,this.decodedAlphaChunkCount=0,this.alphaDecoderQueueSize=0,this.nullAlphaFrameQueue.length=0,this.currentAlphaPacketIndex=0,this.alphaRaslSkipped=!1),(0,l.Tc)()){for(let e of this.sampleQueue)this.finalizeAndEmitSample(e);this.sampleQueue.length=0}this.currentPacketIndex=0,this.raslSkipped=!1}close(){for(let e of(this.customDecoder?this.customDecoderCallSerializer.call(()=>this.customDecoder.close()):((0,l.vA)(this.decoder),this.decoder.close(),this.alphaDecoder?.close(),this.colorQueue.forEach(e=>e.close()),this.colorQueue.length=0,this.alphaQueue.forEach(e=>e?.close()),this.alphaQueue.length=0,this.merger?.close()),this.sampleQueue))e.close();this.sampleQueue.length=0}}class w{constructor(){"undefined"!=typeof OffscreenCanvas?this.canvas=new OffscreenCanvas(300,150):this.canvas=document.createElement("canvas");let e=this.canvas.getContext("webgl2",{premultipliedAlpha:!1});if(!e)throw Error("Couldn't acquire WebGL 2 context.");this.gl=e,this.program=this.createProgram(),this.vao=this.createVAO(),this.colorTexture=this.createTexture(),this.alphaTexture=this.createTexture(),this.gl.useProgram(this.program),this.gl.uniform1i(this.gl.getUniformLocation(this.program,"u_colorTexture"),0),this.gl.uniform1i(this.gl.getUniformLocation(this.program,"u_alphaTexture"),1)}createProgram(){let e=this.createShader(this.gl.VERTEX_SHADER,`#version 300 es
			in vec2 a_position;
			in vec2 a_texCoord;
			out vec2 v_texCoord;
			
			void main() {
				gl_Position = vec4(a_position, 0.0, 1.0);
				v_texCoord = a_texCoord;
			}
		`),t=this.createShader(this.gl.FRAGMENT_SHADER,`#version 300 es
			precision highp float;
			
			uniform sampler2D u_colorTexture;
			uniform sampler2D u_alphaTexture;
			in vec2 v_texCoord;
			out vec4 fragColor;
			
			void main() {
				vec3 color = texture(u_colorTexture, v_texCoord).rgb;
				float alpha = texture(u_alphaTexture, v_texCoord).r;
				fragColor = vec4(color, alpha);
			}
		`),r=this.gl.createProgram();return this.gl.attachShader(r,e),this.gl.attachShader(r,t),this.gl.linkProgram(r),r}createShader(e,t){let r=this.gl.createShader(e);return this.gl.shaderSource(r,t),this.gl.compileShader(r),r}createVAO(){let e=this.gl.createVertexArray();this.gl.bindVertexArray(e);let t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),r=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW);let i=this.gl.getAttribLocation(this.program,"a_position"),a=this.gl.getAttribLocation(this.program,"a_texCoord");return this.gl.enableVertexAttribArray(i),this.gl.vertexAttribPointer(i,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(a),this.gl.vertexAttribPointer(a,2,this.gl.FLOAT,!1,16,8),e}createTexture(){let e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}update(e,t){(e.displayWidth!==this.canvas.width||e.displayHeight!==this.canvas.height)&&(this.canvas.width=e.displayWidth,this.canvas.height=e.displayHeight),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.alphaTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindVertexArray(this.vao),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}close(){this.gl.getExtension("WEBGL_lose_context")?.loseContext(),this.gl=null}}class v extends y{constructor(e){if(!(e instanceof o.N0))throw TypeError("videoTrack must be an InputVideoTrack.");super(),this._track=e}async _createDecoder(e,t){if(!await this._track.canDecode())throw Error("This video track cannot be decoded by this browser. Make sure to check decodability before using a track.");let r=this._track.codec,i=this._track.rotation,a=await this._track.getDecoderConfig(),n=this._track.timeResolution;return(0,l.vA)(r&&a),new k(e,t,r,a,i,n)}_createPacketSink(){return new p(this._track)}async getSample(e){for await(let t of(f(e),this.mediaSamplesAtTimestamps([e])))return t;throw Error("Internal error: Iterator returned nothing.")}samples(e=0,t=1/0){return this.mediaSamplesInRange(e,t)}samplesAtTimestamps(e){return this.mediaSamplesAtTimestamps(e)}}class x{constructor(e,t={}){if(this._nextCanvasIndex=0,!(e instanceof o.N0))throw TypeError("videoTrack must be an InputVideoTrack.");if(t&&"object"!=typeof t)throw TypeError("options must be an object.");if(void 0!==t.alpha&&"boolean"!=typeof t.alpha)throw TypeError("options.alpha, when provided, must be a boolean.");if(void 0!==t.width&&(!Number.isInteger(t.width)||t.width<=0))throw TypeError("options.width, when defined, must be a positive integer.");if(void 0!==t.height&&(!Number.isInteger(t.height)||t.height<=0))throw TypeError("options.height, when defined, must be a positive integer.");if(void 0!==t.fit&&!["fill","contain","cover"].includes(t.fit))throw TypeError('options.fit, when provided, must be one of "fill", "contain", or "cover".');if(void 0!==t.width&&void 0!==t.height&&void 0===t.fit)throw TypeError("When both options.width and options.height are provided, options.fit must also be provided.");if(void 0!==t.rotation&&![0,90,180,270].includes(t.rotation))throw TypeError("options.rotation, when provided, must be 0, 90, 180 or 270.");if(void 0!==t.crop&&(0,u.wS)(t.crop,"options."),void 0!==t.poolSize&&("number"!=typeof t.poolSize||!Number.isInteger(t.poolSize)||t.poolSize<0))throw TypeError("poolSize must be a non-negative integer.");let r=t.rotation??e.rotation,[i,a]=r%180==0?[e.codedWidth,e.codedHeight]:[e.codedHeight,e.codedWidth],n=t.crop;n&&(0,u.px)(n,i,a);let[s,l]=n?[n.width,n.height]:[i,a],c=s/l;void 0!==t.width&&void 0===t.height?l=Math.round((s=t.width)/c):void 0===t.width&&void 0!==t.height?s=Math.round((l=t.height)*c):void 0!==t.width&&void 0!==t.height&&(s=t.width,l=t.height),this._videoTrack=e,this._alpha=t.alpha??!1,this._width=s,this._height=l,this._rotation=r,this._crop=n,this._fit=t.fit??"fill",this._videoSampleSink=new v(e),this._canvasPool=Array.from({length:t.poolSize??0},()=>null)}_videoSampleToWrappedCanvas(e){let t=this._canvasPool[this._nextCanvasIndex],r=!1;t||("undefined"!=typeof document?((t=document.createElement("canvas")).width=this._width,t.height=this._height):t=new OffscreenCanvas(this._width,this._height),this._canvasPool.length>0&&(this._canvasPool[this._nextCanvasIndex]=t),r=!0),this._canvasPool.length>0&&(this._nextCanvasIndex=(this._nextCanvasIndex+1)%this._canvasPool.length);let i=t.getContext("2d",{alpha:this._alpha||(0,l.gm)()});(0,l.vA)(i),i.resetTransform(),r||(!this._alpha&&(0,l.gm)()?(i.fillStyle="black",i.fillRect(0,0,this._width,this._height)):i.clearRect(0,0,this._width,this._height)),e.drawWithFit(i,{fit:this._fit,rotation:this._rotation,crop:this._crop});let a={canvas:t,timestamp:e.timestamp,duration:e.duration};return e.close(),a}async getCanvas(e){f(e);let t=await this._videoSampleSink.getSample(e);return t&&this._videoSampleToWrappedCanvas(t)}canvases(e=0,t=1/0){return(0,l.KY)(this._videoSampleSink.samples(e,t),e=>this._videoSampleToWrappedCanvas(e))}canvasesAtTimestamps(e){return(0,l.KY)(this._videoSampleSink.samplesAtTimestamps(e),e=>e&&this._videoSampleToWrappedCanvas(e))}}class T extends g{constructor(e,t,r,i){super(e,t),this.decoder=null,this.customDecoder=null,this.customDecoderCallSerializer=new l.dY,this.customDecoderQueueSize=0,this.currentTimestamp=null;let a=t=>{(null===this.currentTimestamp||Math.abs(t.timestamp-this.currentTimestamp)>=t.duration)&&(this.currentTimestamp=t.timestamp);let r=this.currentTimestamp;if(this.currentTimestamp+=t.duration,0===t.numberOfFrames){t.close();return}let a=i.sampleRate;t.setTimestamp(Math.round(r*a)/a),e(t)},s=n.zx.find(e=>e.supports(r,i));if(s)this.customDecoder=new s,this.customDecoder.codec=r,this.customDecoder.config=i,this.customDecoder.onSample=e=>{if(!(e instanceof u.B1))throw TypeError("The argument passed to onSample must be an AudioSample.");a(e)},this.customDecoderCallSerializer.call(()=>this.customDecoder.init());else{let e=Error("Decoding error").stack;this.decoder=new AudioDecoder({output:e=>{try{a(new u.B1(e))}catch(e){this.onError(e)}},error:t=>{t.stack=e,this.onError(t)}}),this.decoder.configure(i)}}getDecodeQueueSize(){return this.customDecoder?this.customDecoderQueueSize:((0,l.vA)(this.decoder),this.decoder.decodeQueueSize)}decode(e){this.customDecoder?(this.customDecoderQueueSize++,this.customDecoderCallSerializer.call(()=>this.customDecoder.decode(e)).then(()=>this.customDecoderQueueSize--)):((0,l.vA)(this.decoder),this.decoder.decode(e.toEncodedAudioChunk()))}flush(){return this.customDecoder?this.customDecoderCallSerializer.call(()=>this.customDecoder.flush()):((0,l.vA)(this.decoder),this.decoder.flush())}close(){this.customDecoder?this.customDecoderCallSerializer.call(()=>this.customDecoder.close()):((0,l.vA)(this.decoder),this.decoder.close())}}class S extends g{constructor(e,t,r){super(e,t),this.decoderConfig=r,this.currentTimestamp=null,(0,l.vA)(i.Wq.includes(r.codec)),this.codec=r.codec;let{dataType:a,sampleSize:n,littleEndian:s}=(0,i.Ei)(this.codec);switch(this.inputSampleSize=n,n){case 1:"unsigned"===a?this.readInputValue=(e,t)=>e.getUint8(t)-128:"signed"===a?this.readInputValue=(e,t)=>e.getInt8(t):"ulaw"===a?this.readInputValue=(e,t)=>(0,d.qS)(e.getUint8(t)):"alaw"===a?this.readInputValue=(e,t)=>(0,d.aw)(e.getUint8(t)):(0,l.vA)(!1);break;case 2:"unsigned"===a?this.readInputValue=(e,t)=>e.getUint16(t,s)-32768:"signed"===a?this.readInputValue=(e,t)=>e.getInt16(t,s):(0,l.vA)(!1);break;case 3:"unsigned"===a?this.readInputValue=(e,t)=>(0,l.dq)(e,t,s)-8388608:"signed"===a?this.readInputValue=(e,t)=>(0,l.Wh)(e,t,s):(0,l.vA)(!1);break;case 4:"unsigned"===a?this.readInputValue=(e,t)=>e.getUint32(t,s)-0x80000000:"signed"===a?this.readInputValue=(e,t)=>e.getInt32(t,s):"float"===a?this.readInputValue=(e,t)=>e.getFloat32(t,s):(0,l.vA)(!1);break;case 8:"float"===a?this.readInputValue=(e,t)=>e.getFloat64(t,s):(0,l.vA)(!1);break;default:(0,l.xb)(n),(0,l.vA)(!1)}switch(n){case 1:"ulaw"===a||"alaw"===a?(this.outputSampleSize=2,this.outputFormat="s16",this.writeOutputValue=(e,t,r)=>e.setInt16(t,r,!0)):(this.outputSampleSize=1,this.outputFormat="u8",this.writeOutputValue=(e,t,r)=>e.setUint8(t,r+128));break;case 2:this.outputSampleSize=2,this.outputFormat="s16",this.writeOutputValue=(e,t,r)=>e.setInt16(t,r,!0);break;case 3:this.outputSampleSize=4,this.outputFormat="s32",this.writeOutputValue=(e,t,r)=>e.setInt32(t,r<<8,!0);break;case 4:this.outputSampleSize=4,"float"===a?(this.outputFormat="f32",this.writeOutputValue=(e,t,r)=>e.setFloat32(t,r,!0)):(this.outputFormat="s32",this.writeOutputValue=(e,t,r)=>e.setInt32(t,r,!0));break;case 8:this.outputSampleSize=4,this.outputFormat="f32",this.writeOutputValue=(e,t,r)=>e.setFloat32(t,r,!0);break;default:(0,l.xb)(n),(0,l.vA)(!1)}}getDecodeQueueSize(){return 0}decode(e){let t=(0,l.Zc)(e.data),r=e.byteLength/this.decoderConfig.numberOfChannels/this.inputSampleSize,i=new ArrayBuffer(r*this.decoderConfig.numberOfChannels*this.outputSampleSize),a=new DataView(i);for(let e=0;e<r*this.decoderConfig.numberOfChannels;e++){let r=e*this.inputSampleSize,i=e*this.outputSampleSize,n=this.readInputValue(t,r);this.writeOutputValue(a,i,n)}let n=r/this.decoderConfig.sampleRate;(null===this.currentTimestamp||Math.abs(e.timestamp-this.currentTimestamp)>=n)&&(this.currentTimestamp=e.timestamp);let s=this.currentTimestamp;this.currentTimestamp+=n;let o=new u.B1({format:this.outputFormat,data:i,numberOfChannels:this.decoderConfig.numberOfChannels,sampleRate:this.decoderConfig.sampleRate,numberOfFrames:r,timestamp:s});this.onSample(o)}async flush(){}close(){}}class C extends y{constructor(e){if(!(e instanceof o.Yi))throw TypeError("audioTrack must be an InputAudioTrack.");super(),this._track=e}async _createDecoder(e,t){if(!await this._track.canDecode())throw Error("This audio track cannot be decoded by this browser. Make sure to check decodability before using a track.");let r=this._track.codec,a=await this._track.getDecoderConfig();return((0,l.vA)(r&&a),i.Wq.includes(a.codec))?new S(e,t,a):new T(e,t,r,a)}_createPacketSink(){return new p(this._track)}async getSample(e){for await(let t of(f(e),this.mediaSamplesAtTimestamps([e])))return t;throw Error("Internal error: Iterator returned nothing.")}samples(e=0,t=1/0){return this.mediaSamplesInRange(e,t)}samplesAtTimestamps(e){return this.mediaSamplesAtTimestamps(e)}}class P{constructor(e){if(!(e instanceof o.Yi))throw TypeError("audioTrack must be an InputAudioTrack.");this._audioSampleSink=new C(e)}_audioSampleToWrappedArrayBuffer(e){let t={buffer:e.toAudioBuffer(),timestamp:e.timestamp,duration:e.duration};return e.close(),t}async getBuffer(e){f(e);let t=await this._audioSampleSink.getSample(e);return t&&this._audioSampleToWrappedArrayBuffer(t)}buffers(e=0,t=1/0){return(0,l.KY)(this._audioSampleSink.samples(e,t),e=>this._audioSampleToWrappedArrayBuffer(e))}buffersAtTimestamps(e){return(0,l.KY)(this._audioSampleSink.samplesAtTimestamps(e),e=>e&&this._audioSampleToWrappedArrayBuffer(e))}}},2596:(e,t,r)=>{r.d(t,{$:()=>i});function i(){for(var e,t,r=0,i="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,i,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(r=0;r<n;r++)t[r]&&(i=e(t[r]))&&(a&&(a+=" "),a+=i)}else for(i in t)t[i]&&(a&&(a+=" "),a+=i)}return a}(e))&&(i&&(i+=" "),i+=t);return i}},2778:(e,t,r)=>{r.d(t,{Be:()=>d,Ld:()=>c,X7:()=>o,f6:()=>l,iv:()=>n,oP:()=>s});var i=r(8734),a=r(8113);let n=e=>{if(0===e)return null;if(1===e)return 192;if(e>=2&&e<=5)return 144*2**e;if(6===e)return"uncommon-u8";if(7===e)return"uncommon-u16";else if(e>=8&&e<=15)return 2**e;else return null},s=(e,t)=>{switch(e){case 0:return t;case 1:return 88200;case 2:return 176400;case 3:return 192e3;case 4:return 8e3;case 5:return 16e3;case 6:return 22050;case 7:return 24e3;case 8:return 32e3;case 9:return 44100;case 10:return 48e3;case 11:return 96e3;case 12:return"uncommon-u8";case 13:return"uncommon-u16";case 14:return"uncommon-u16-10";default:return null}},o=e=>{let t=0,r=new i._c((0,a.io)(e,1));for(;1===r.readBits(1);)t++;if(0===t)return r.readBits(7);let n=[],s=t-1,o=new i._c((0,a.io)(e,s)),l=8-t-1;for(let e=0;e<l;e++)n.unshift(r.readBits(1));for(let e=0;e<s;e++)for(let e=0;e<8;e++){let t=o.readBits(1);!(e<2)&&n.unshift(t)}return n.reduce((e,t,r)=>e|t<<r,0)},l=(e,t)=>"uncommon-u16"===t?(0,a.mH)(e)+1:"uncommon-u8"===t?(0,a.eo)(e)+1:"number"==typeof t?t:void((0,i.xb)(t),(0,i.vA)(!1)),c=(e,t)=>"uncommon-u16"===t?(0,a.mH)(e):"uncommon-u16-10"===t?10*(0,a.mH)(e):"uncommon-u8"===t?(0,a.eo)(e):"number"==typeof t?t:null,d=e=>{let t=0;for(let r of e){t^=r;for(let e=0;e<8;e++)(128&t)!=0?t=t<<1^7:t<<=1,t&=255}return t}},2832:(e,t,r)=>{r.d(t,{X:()=>i});let i=e=>{let t=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isQuickTime?"quicktime":"mp4");if(e.codecStrings.length>0){let r=[...new Set(e.codecStrings)];t+=`; codecs="${r.join(", ")}"`}return t}},2925:(e,t,r)=>{r.d(t,{Lr:()=>s,WE:()=>n,wb:()=>i,zx:()=>a});let i=[],a=[],n=[],s=[]},3468:(e,t,r)=>{r.d(t,{$3:()=>c,DC:()=>y,Ei:()=>I,GL:()=>z,IJ:()=>M,Im:()=>v,KZ:()=>k,P7:()=>_,PP:()=>o,QP:()=>b,Rc:()=>A,Ti:()=>x,VW:()=>l,WN:()=>a,Wq:()=>n,Wz:()=>S,X0:()=>w,YB:()=>s,aF:()=>D,j7:()=>p,mD:()=>g,oU:()=>E,ye:()=>u,yo:()=>C,zF:()=>T});var i=r(8734);let a=["avc","hevc","vp9","av1","vp8"],n=["pcm-s16","pcm-s16be","pcm-s24","pcm-s24be","pcm-s32","pcm-s32be","pcm-f32","pcm-f32be","pcm-f64","pcm-f64be","pcm-u8","pcm-s8","ulaw","alaw"],s=["aac","opus","mp3","vorbis","flac"],o=[...s,...n],l=["webvtt"],c=[{maxMacroblocks:99,maxBitrate:64e3,maxDpbMbs:396,level:10},{maxMacroblocks:396,maxBitrate:192e3,maxDpbMbs:900,level:11},{maxMacroblocks:396,maxBitrate:384e3,maxDpbMbs:2376,level:12},{maxMacroblocks:396,maxBitrate:768e3,maxDpbMbs:2376,level:13},{maxMacroblocks:396,maxBitrate:2e6,maxDpbMbs:2376,level:20},{maxMacroblocks:792,maxBitrate:4e6,maxDpbMbs:4752,level:21},{maxMacroblocks:1620,maxBitrate:4e6,maxDpbMbs:8100,level:22},{maxMacroblocks:1620,maxBitrate:1e7,maxDpbMbs:8100,level:30},{maxMacroblocks:3600,maxBitrate:14e6,maxDpbMbs:18e3,level:31},{maxMacroblocks:5120,maxBitrate:2e7,maxDpbMbs:20480,level:32},{maxMacroblocks:8192,maxBitrate:2e7,maxDpbMbs:32768,level:40},{maxMacroblocks:8192,maxBitrate:5e7,maxDpbMbs:32768,level:41},{maxMacroblocks:8704,maxBitrate:5e7,maxDpbMbs:34816,level:42},{maxMacroblocks:22080,maxBitrate:135e6,maxDpbMbs:110400,level:50},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:51},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:52},{maxMacroblocks:139264,maxBitrate:24e7,maxDpbMbs:696320,level:60},{maxMacroblocks:139264,maxBitrate:48e7,maxDpbMbs:696320,level:61},{maxMacroblocks:139264,maxBitrate:8e8,maxDpbMbs:696320,level:62}],d=[{maxPictureSize:36864,maxBitrate:128e3,tier:"L",level:30},{maxPictureSize:122880,maxBitrate:15e5,tier:"L",level:60},{maxPictureSize:245760,maxBitrate:3e6,tier:"L",level:63},{maxPictureSize:552960,maxBitrate:6e6,tier:"L",level:90},{maxPictureSize:983040,maxBitrate:1e7,tier:"L",level:93},{maxPictureSize:2228224,maxBitrate:12e6,tier:"L",level:120},{maxPictureSize:2228224,maxBitrate:3e7,tier:"H",level:120},{maxPictureSize:2228224,maxBitrate:2e7,tier:"L",level:123},{maxPictureSize:2228224,maxBitrate:5e7,tier:"H",level:123},{maxPictureSize:8912896,maxBitrate:25e6,tier:"L",level:150},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:150},{maxPictureSize:8912896,maxBitrate:4e7,tier:"L",level:153},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:153},{maxPictureSize:8912896,maxBitrate:6e7,tier:"L",level:156},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:156},{maxPictureSize:0x2200000,maxBitrate:6e7,tier:"L",level:180},{maxPictureSize:0x2200000,maxBitrate:24e7,tier:"H",level:180},{maxPictureSize:0x2200000,maxBitrate:12e7,tier:"L",level:183},{maxPictureSize:0x2200000,maxBitrate:48e7,tier:"H",level:183},{maxPictureSize:0x2200000,maxBitrate:24e7,tier:"L",level:186},{maxPictureSize:0x2200000,maxBitrate:8e8,tier:"H",level:186}],u=[{maxPictureSize:36864,maxBitrate:2e5,level:10},{maxPictureSize:73728,maxBitrate:8e5,level:11},{maxPictureSize:122880,maxBitrate:18e5,level:20},{maxPictureSize:245760,maxBitrate:36e5,level:21},{maxPictureSize:552960,maxBitrate:72e5,level:30},{maxPictureSize:983040,maxBitrate:12e6,level:31},{maxPictureSize:2228224,maxBitrate:18e6,level:40},{maxPictureSize:2228224,maxBitrate:3e7,level:41},{maxPictureSize:8912896,maxBitrate:6e7,level:50},{maxPictureSize:8912896,maxBitrate:12e7,level:51},{maxPictureSize:8912896,maxBitrate:18e7,level:52},{maxPictureSize:0x2200000,maxBitrate:18e7,level:60},{maxPictureSize:0x2200000,maxBitrate:24e7,level:61},{maxPictureSize:0x2200000,maxBitrate:48e7,level:62}],h=[{maxPictureSize:147456,maxBitrate:15e5,tier:"M",level:0},{maxPictureSize:278784,maxBitrate:3e6,tier:"M",level:1},{maxPictureSize:665856,maxBitrate:6e6,tier:"M",level:4},{maxPictureSize:1065024,maxBitrate:1e7,tier:"M",level:5},{maxPictureSize:2359296,maxBitrate:12e6,tier:"M",level:8},{maxPictureSize:2359296,maxBitrate:3e7,tier:"H",level:8},{maxPictureSize:2359296,maxBitrate:2e7,tier:"M",level:9},{maxPictureSize:2359296,maxBitrate:5e7,tier:"H",level:9},{maxPictureSize:8912896,maxBitrate:3e7,tier:"M",level:12},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:12},{maxPictureSize:8912896,maxBitrate:4e7,tier:"M",level:13},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:13},{maxPictureSize:8912896,maxBitrate:6e7,tier:"M",level:14},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:14},{maxPictureSize:0x2200000,maxBitrate:6e7,tier:"M",level:15},{maxPictureSize:0x2200000,maxBitrate:24e7,tier:"H",level:15},{maxPictureSize:0x2200000,maxBitrate:6e7,tier:"M",level:16},{maxPictureSize:0x2200000,maxBitrate:24e7,tier:"H",level:16},{maxPictureSize:0x2200000,maxBitrate:1e8,tier:"M",level:17},{maxPictureSize:0x2200000,maxBitrate:48e7,tier:"H",level:17},{maxPictureSize:0x2200000,maxBitrate:16e7,tier:"M",level:18},{maxPictureSize:0x2200000,maxBitrate:8e8,tier:"H",level:18},{maxPictureSize:0x2200000,maxBitrate:16e7,tier:"M",level:19},{maxPictureSize:0x2200000,maxBitrate:8e8,tier:"H",level:19}],f=".01.01.01.01.00",m=".0.110.01.01.01.0",p=(e,t,r,a)=>{if("avc"===e){let e=Math.ceil(t/16)*Math.ceil(r/16),n=c.find(t=>e<=t.maxMacroblocks&&a<=t.maxBitrate)??(0,i._g)(c),s=n?n.level:0,o="64".padStart(2,"0"),l=s.toString(16).padStart(2,"0");return`avc1.${o}00${l}`}if("hevc"===e){let e=t*r,n=d.find(t=>e<=t.maxPictureSize&&a<=t.maxBitrate)??(0,i._g)(d);return`hev1.1.6.${n.tier}${n.level}.B0`}if("vp8"===e)return"vp8";if("vp9"===e){let e=t*r,n=u.find(t=>e<=t.maxPictureSize&&a<=t.maxBitrate)??(0,i._g)(u);return`vp09.00.${n.level.toString().padStart(2,"0")}.08`}if("av1"===e){let e=t*r,n=h.find(t=>e<=t.maxPictureSize&&a<=t.maxBitrate)??(0,i._g)(h),s=n.level.toString().padStart(2,"0");return`av01.0.${s}${n.tier}.08`}throw TypeError(`Unhandled codec '${e}'.`)},g=e=>{let t=e.split("."),r=Number(t[1]),i=Number(t[2]);return[1,1,r,2,1,i,3,1,Number(t[3]),4,1,t[4]?Number(t[4]):1]},y=e=>{let t=e.split("."),r=Number(t[1]),i=t[2],a=Number(i.slice(0,-1)),n=+("H"===i.slice(-1)),s=Number(t[3]),o=t[4]?Number(t[4]):0,l=t[5]?Number(t[5][0]):1;return[129,(r<<5)+a,(n<<7)+(+(8!==s)<<6)+0+(o<<4)+(l<<3)+((t[5]?Number(t[5][1]):1)<<2)+(t[5]?Number(t[5][2]):0),0]},b=e=>{let{codec:t,codecDescription:r,colorSpace:a,avcCodecInfo:n,hevcCodecInfo:s,vp9CodecInfo:o,av1CodecInfo:l}=e;if("avc"===t){if((0,i.vA)(null!==e.avcType),n){let t=new Uint8Array([n.avcProfileIndication,n.profileCompatibility,n.avcLevelIndication]);return`avc${e.avcType}.${(0,i.Br)(t)}`}if(!r||r.byteLength<4)throw TypeError("AVC decoder description is not provided or is not at least 4 bytes long.");return`avc${e.avcType}.${(0,i.Br)(r.subarray(1,4))}`}if("hevc"===t){let e,t,a,n,o,l;if(s)e=s.generalProfileSpace,t=s.generalProfileIdc,a=(0,i.P5)(s.generalProfileCompatibilityFlags),n=s.generalTierFlag,o=s.generalLevelIdc,l=[...s.generalConstraintIndicatorFlags];else{if(!r||r.byteLength<23)throw TypeError("HEVC decoder description is not provided or is not at least 23 bytes long.");let s=(0,i.Zc)(r),c=s.getUint8(1);e=c>>6&3,t=31&c,a=(0,i.P5)(s.getUint32(2)),n=c>>5&1,o=s.getUint8(12),l=[];for(let e=0;e<6;e++)l.push(s.getUint8(6+e))}let c="hev1.";for(c+=["","A","B","C"][e]+t,c+=".",c+=a.toString(16).toUpperCase(),c+=".",c+=0===n?"L":"H",c+=o;l.length>0&&0===l[l.length-1];)l.pop();return l.length>0&&(c+=".",c+=l.map(e=>e.toString(16).toUpperCase()).join(".")),c}if("vp8"===t)return"vp8";if("vp9"===t){if(!o){let t=e.width*e.height,r=(0,i._g)(u).level;for(let e of u)if(t<=e.maxPictureSize){r=e.level;break}return`vp09.00.${r.toString().padStart(2,"0")}.08`}let t=o.profile.toString().padStart(2,"0"),r=o.level.toString().padStart(2,"0"),a=o.bitDepth.toString().padStart(2,"0"),n=o.chromaSubsampling.toString().padStart(2,"0"),s=o.colourPrimaries.toString().padStart(2,"0"),l=o.transferCharacteristics.toString().padStart(2,"0"),c=o.matrixCoefficients.toString().padStart(2,"0"),d=o.videoFullRangeFlag.toString().padStart(2,"0"),h=`vp09.${t}.${r}.${a}.${n}`;return(h+=`.${s}.${l}.${c}.${d}`).endsWith(f)&&(h=h.slice(0,-f.length)),h}if("av1"===t){if(!l){let t=e.width*e.height,r=(0,i._g)(u).level;for(let e of u)if(t<=e.maxPictureSize){r=e.level;break}return`av01.0.${r.toString().padStart(2,"0")}M.08`}let t=l.profile,r=l.level.toString().padStart(2,"0"),n=l.tier?"H":"M",s=l.bitDepth.toString().padStart(2,"0"),o=l.monochrome?"1":"0",c=100*l.chromaSubsamplingX+10*l.chromaSubsamplingY+ +(l.chromaSubsamplingX&&l.chromaSubsamplingY?l.chromaSamplePosition:0),d=a?.primaries?i.wd[a.primaries]:1,h=a?.transfer?i.uN[a.transfer]:1,f=a?.matrix?i.Au[a.matrix]:1,p=+!!a?.fullRange,g=`av01.${t}.${r}${n}.${s}`;return g+=`.${o}.${c.toString().padStart(3,"0")}`,g+=`.${d.toString().padStart(2,"0")}`,g+=`.${h.toString().padStart(2,"0")}`,g+=`.${f.toString().padStart(2,"0")}`,(g+=`.${p}`).endsWith(m)&&(g=g.slice(0,-m.length)),g}throw TypeError(`Unhandled codec '${t}'.`)},k=(e,t,r)=>{if("aac"===e)return t>=2&&r<=24e3?"mp4a.40.29":r<=24e3?"mp4a.40.5":"mp4a.40.2";if("mp3"===e)return"mp3";if("opus"===e)return"opus";if("vorbis"===e)return"vorbis";if("flac"===e)return"flac";else if(n.includes(e))return e;throw TypeError(`Unhandled codec '${e}'.`)},w=e=>{let{codec:t,codecDescription:r,aacCodecInfo:i}=e;if("aac"===t){if(!i)throw TypeError("AAC codec info must be provided.");if(i.isMpeg2)return"mp4a.67";{let e;return e=null!==i.objectType?i.objectType:T(r).objectType,`mp4a.40.${e}`}}if("mp3"===t)return"mp3";if("opus"===t)return"opus";if("vorbis"===t)return"vorbis";if("flac"===t)return"flac";else if(t&&n.includes(t))return t;throw TypeError(`Unhandled codec '${t}'.`)},v=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],x=[-1,1,2,3,4,5,6,8],T=e=>{if(!e||e.byteLength<2)throw TypeError("AAC description must be at least 2 bytes long.");let t=new i._c(e),r=t.readBits(5);31===r&&(r=32+t.readBits(6));let a=t.readBits(4),n=null;15===a?n=t.readBits(24):a<v.length&&(n=v[a]);let s=t.readBits(4),o=null;return s>=1&&s<=7&&(o=x[s]),{objectType:r,frequencyIndex:a,sampleRate:n,channelConfiguration:s,numberOfChannels:o}},S=e=>{let t=v.indexOf(e.sampleRate),r=null;-1===t&&(t=15,r=e.sampleRate);let a=x.indexOf(e.numberOfChannels);if(-1===a)throw TypeError(`Unsupported number of channels: ${e.numberOfChannels}`);let n=13;e.objectType>=32&&(n+=6),15===t&&(n+=24);let s=new Uint8Array(Math.ceil(n/8)),o=new i._c(s);return e.objectType<32?o.writeBits(5,e.objectType):(o.writeBits(5,31),o.writeBits(6,e.objectType-32)),o.writeBits(4,t),15===t&&o.writeBits(24,r),o.writeBits(4,a),s},C=48e3,P=/^pcm-([usf])(\d+)+(be)?$/,I=e=>{let t;if((0,i.vA)(n.includes(e)),"ulaw"===e)return{dataType:"ulaw",sampleSize:1,littleEndian:!0,silentValue:255};if("alaw"===e)return{dataType:"alaw",sampleSize:1,littleEndian:!0,silentValue:213};let r=P.exec(e);(0,i.vA)(r),t="u"===r[1]?"unsigned":"s"===r[1]?"signed":"float";let a=Number(r[2])/8;return{dataType:t,sampleSize:a,littleEndian:"be"!==r[3],silentValue:128*("pcm-u8"===e)}},E=e=>{if(e.startsWith("avc1")||e.startsWith("avc3"))return"avc";if(e.startsWith("hev1")||e.startsWith("hvc1"))return"hevc";if("vp8"===e)return"vp8";if(e.startsWith("vp09"))return"vp9";if(e.startsWith("av01"))return"av1";if(e.startsWith("mp4a.40")||"mp4a.67"===e)return"aac";if("mp3"===e||"mp4a.69"===e||"mp4a.6B"===e||"mp4a.6b"===e)return"mp3";if("opus"===e)return"opus";if("vorbis"===e)return"vorbis";if("flac"===e)return"flac";else if("ulaw"===e)return"ulaw";else if("alaw"===e)return"alaw";else if(P.test(e))return e;return"webvtt"===e?"webvtt":null},A=e=>"avc"===e?{avc:{format:"avc"}}:"hevc"===e?{hevc:{format:"hevc"}}:{},M=e=>"aac"===e?{aac:{format:"aac"}}:"opus"===e?{opus:{format:"opus"}}:{},F=["avc1","avc3","hev1","hvc1","vp8","vp09","av01"],B=/^(avc1|avc3)\.[0-9a-fA-F]{6}$/,L=/^(hev1|hvc1)\.(?:[ABC]?\d+)\.[0-9a-fA-F]{1,8}\.[LH]\d+(?:\.[0-9a-fA-F]{1,2}){0,6}$/,U=/^vp09(?:\.\d{2}){3}(?:(?:\.\d{2}){5})?$/,R=/^av01\.\d\.\d{2}[MH]\.\d{2}(?:\.\d\.\d{3}\.\d{2}\.\d{2}\.\d{2}\.\d)?$/,D=e=>{if(!e)throw TypeError("Video chunk metadata must be provided.");if("object"!=typeof e)throw TypeError("Video chunk metadata must be an object.");if(!e.decoderConfig)throw TypeError("Video chunk metadata must include a decoder configuration.");if("object"!=typeof e.decoderConfig)throw TypeError("Video chunk metadata decoder configuration must be an object.");if("string"!=typeof e.decoderConfig.codec)throw TypeError("Video chunk metadata decoder configuration must specify a codec string.");if(!F.some(t=>e.decoderConfig.codec.startsWith(t)))throw TypeError("Video chunk metadata decoder configuration codec string must be a valid video codec string as specified in the WebCodecs Codec Registry.");if(!Number.isInteger(e.decoderConfig.codedWidth)||e.decoderConfig.codedWidth<=0)throw TypeError("Video chunk metadata decoder configuration must specify a valid codedWidth (positive integer).");if(!Number.isInteger(e.decoderConfig.codedHeight)||e.decoderConfig.codedHeight<=0)throw TypeError("Video chunk metadata decoder configuration must specify a valid codedHeight (positive integer).");if(void 0!==e.decoderConfig.description&&!(0,i.SM)(e.decoderConfig.description))throw TypeError("Video chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(void 0!==e.decoderConfig.colorSpace){let{colorSpace:t}=e.decoderConfig;if("object"!=typeof t)throw TypeError("Video chunk metadata decoder configuration colorSpace, when provided, must be an object.");let r=Object.keys(i.wd);if(null!=t.primaries&&!r.includes(t.primaries))throw TypeError(`Video chunk metadata decoder configuration colorSpace primaries, when defined, must be one of ${r.join(", ")}.`);let a=Object.keys(i.uN);if(null!=t.transfer&&!a.includes(t.transfer))throw TypeError(`Video chunk metadata decoder configuration colorSpace transfer, when defined, must be one of ${a.join(", ")}.`);let n=Object.keys(i.Au);if(null!=t.matrix&&!n.includes(t.matrix))throw TypeError(`Video chunk metadata decoder configuration colorSpace matrix, when defined, must be one of ${n.join(", ")}.`);if(null!=t.fullRange&&"boolean"!=typeof t.fullRange)throw TypeError("Video chunk metadata decoder configuration colorSpace fullRange, when defined, must be a boolean.")}if(e.decoderConfig.codec.startsWith("avc1")||e.decoderConfig.codec.startsWith("avc3")){if(!B.test(e.decoderConfig.codec))throw TypeError("Video chunk metadata decoder configuration codec string for AVC must be a valid AVC codec string as specified in Section 3.4 of RFC 6381.")}else if(e.decoderConfig.codec.startsWith("hev1")||e.decoderConfig.codec.startsWith("hvc1")){if(!L.test(e.decoderConfig.codec))throw TypeError("Video chunk metadata decoder configuration codec string for HEVC must be a valid HEVC codec string as specified in Section E.3 of ISO 14496-15.")}else if(e.decoderConfig.codec.startsWith("vp8")){if("vp8"!==e.decoderConfig.codec)throw TypeError('Video chunk metadata decoder configuration codec string for VP8 must be "vp8".')}else if(e.decoderConfig.codec.startsWith("vp09")){if(!U.test(e.decoderConfig.codec))throw TypeError('Video chunk metadata decoder configuration codec string for VP9 must be a valid VP9 codec string as specified in Section "Codecs Parameter String" of https://www.webmproject.org/vp9/mp4/.')}else if(e.decoderConfig.codec.startsWith("av01")&&!R.test(e.decoderConfig.codec))throw TypeError('Video chunk metadata decoder configuration codec string for AV1 must be a valid AV1 codec string as specified in Section "Codecs Parameter String" of https://aomediacodec.github.io/av1-isobmff/.')},N=["mp4a","mp3","opus","vorbis","flac","ulaw","alaw","pcm"],_=e=>{if(!e)throw TypeError("Audio chunk metadata must be provided.");if("object"!=typeof e)throw TypeError("Audio chunk metadata must be an object.");if(!e.decoderConfig)throw TypeError("Audio chunk metadata must include a decoder configuration.");if("object"!=typeof e.decoderConfig)throw TypeError("Audio chunk metadata decoder configuration must be an object.");if("string"!=typeof e.decoderConfig.codec)throw TypeError("Audio chunk metadata decoder configuration must specify a codec string.");if(!N.some(t=>e.decoderConfig.codec.startsWith(t)))throw TypeError("Audio chunk metadata decoder configuration codec string must be a valid audio codec string as specified in the WebCodecs Codec Registry.");if(!Number.isInteger(e.decoderConfig.sampleRate)||e.decoderConfig.sampleRate<=0)throw TypeError("Audio chunk metadata decoder configuration must specify a valid sampleRate (positive integer).");if(!Number.isInteger(e.decoderConfig.numberOfChannels)||e.decoderConfig.numberOfChannels<=0)throw TypeError("Audio chunk metadata decoder configuration must specify a valid numberOfChannels (positive integer).");if(void 0!==e.decoderConfig.description&&!(0,i.SM)(e.decoderConfig.description))throw TypeError("Audio chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(e.decoderConfig.codec.startsWith("mp4a")&&"mp4a.69"!==e.decoderConfig.codec&&"mp4a.6B"!==e.decoderConfig.codec&&"mp4a.6b"!==e.decoderConfig.codec){if(!["mp4a.40.2","mp4a.40.02","mp4a.40.5","mp4a.40.05","mp4a.40.29","mp4a.67"].includes(e.decoderConfig.codec))throw TypeError("Audio chunk metadata decoder configuration codec string for AAC must be a valid AAC codec string as specified in https://www.w3.org/TR/webcodecs-aac-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("mp3")||e.decoderConfig.codec.startsWith("mp4a")){if("mp3"!==e.decoderConfig.codec&&"mp4a.69"!==e.decoderConfig.codec&&"mp4a.6B"!==e.decoderConfig.codec&&"mp4a.6b"!==e.decoderConfig.codec)throw TypeError('Audio chunk metadata decoder configuration codec string for MP3 must be "mp3", "mp4a.69" or "mp4a.6B".')}else if(e.decoderConfig.codec.startsWith("opus")){if("opus"!==e.decoderConfig.codec)throw TypeError('Audio chunk metadata decoder configuration codec string for Opus must be "opus".');if(e.decoderConfig.description&&e.decoderConfig.description.byteLength<18)throw TypeError("Audio chunk metadata decoder configuration description, when specified, is expected to be an Identification Header as specified in Section 5.1 of RFC 7845.")}else if(e.decoderConfig.codec.startsWith("vorbis")){if("vorbis"!==e.decoderConfig.codec)throw TypeError('Audio chunk metadata decoder configuration codec string for Vorbis must be "vorbis".');if(!e.decoderConfig.description)throw TypeError("Audio chunk metadata decoder configuration for Vorbis must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-vorbis-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("flac")){if("flac"!==e.decoderConfig.codec)throw TypeError('Audio chunk metadata decoder configuration codec string for FLAC must be "flac".');if(!e.decoderConfig.description||e.decoderConfig.description.byteLength<42)throw TypeError("Audio chunk metadata decoder configuration for FLAC must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-flac-codec-registration/.")}else if((e.decoderConfig.codec.startsWith("pcm")||e.decoderConfig.codec.startsWith("ulaw")||e.decoderConfig.codec.startsWith("alaw"))&&!n.includes(e.decoderConfig.codec))throw TypeError(`Audio chunk metadata decoder configuration codec string for PCM must be one of the supported PCM codecs (${n.join(", ")}).`)},z=e=>{if(!e)throw TypeError("Subtitle metadata must be provided.");if("object"!=typeof e)throw TypeError("Subtitle metadata must be an object.");if(!e.config)throw TypeError("Subtitle metadata must include a config object.");if("object"!=typeof e.config)throw TypeError("Subtitle metadata config must be an object.");if("string"!=typeof e.config.description)throw TypeError("Subtitle metadata config description must be a string.")}},3520:(e,t,r)=>{r.d(t,{D:()=>i,E:()=>u});var i,a=r(7354),n=r(8244),s=r(4159),o=r(8734),l=r(5854),c=r(8113),d=r(9044);!function(e){e[e.PCM=1]="PCM",e[e.IEEE_FLOAT=3]="IEEE_FLOAT",e[e.ALAW=6]="ALAW",e[e.MULAW=7]="MULAW",e[e.EXTENSIBLE=65534]="EXTENSIBLE"}(i||(i={}));class u extends a.B{constructor(e){super(e),this.metadataPromise=null,this.dataStart=-1,this.dataSize=-1,this.audioInfo=null,this.tracks=[],this.lastKnownPacketIndex=0,this.metadataTags={},this.reader=e._reader}async readMetadata(){return this.metadataPromise??=(async()=>{let e=this.reader.requestSlice(0,12);e instanceof Promise&&(e=await e),(0,o.vA)(e);let t=(0,c.IT)(e,4),r="RIFX"!==t,i="RF64"===t,a=(0,c.PF)(e,r),s=i?this.reader.fileSize:Math.min(a+8,this.reader.fileSize??1/0);if("WAVE"!==(0,c.IT)(e,4))throw Error("Invalid WAVE file - wrong format");let l=0,d=null,u=e.filePos;for(;null===s||u<s;){let e=this.reader.requestSlice(u,8);if(e instanceof Promise&&(e=await e),!e)break;let t=(0,c.IT)(e,4),a=(0,c.PF)(e,r),n=e.filePos;if(i&&0===l&&"ds64"!==t)throw Error('Invalid RF64 file: First chunk must be "ds64".');if("fmt "===t)await this.parseFmtChunk(n,a,r);else if("data"===t){if(d??=a,this.dataStart=e.filePos,this.dataSize=Math.min(d,(s??1/0)-this.dataStart),null===this.reader.fileSize)break}else if("ds64"===t){let e=this.reader.requestSlice(n,a);if(e instanceof Promise&&(e=await e),!e)break;let t=(0,c.IM)(e,r);d=(0,c.IM)(e,r),s=Math.min(t+8,this.reader.fileSize??1/0)}else"LIST"===t?await this.parseListChunk(n,a,r):("ID3 "===t||"id3 "===t)&&await this.parseId3Chunk(n,a);u=n+a+(1&a),l++}if(!this.audioInfo)throw Error('Invalid WAVE file - missing "fmt " chunk');if(-1===this.dataStart)throw Error('Invalid WAVE file - missing "data" chunk');let f=this.audioInfo.blockSizeInBytes;this.dataSize=Math.floor(this.dataSize/f)*f,this.tracks.push(new n.Yi(this.input,new h(this)))})()}async parseFmtChunk(e,t,r){let a,n=this.reader.requestSlice(e,t);if(n instanceof Promise&&(n=await n),!n)return;let s=(0,c.Vv)(n,r),o=(0,c.Vv)(n,r),l=(0,c.PF)(n,r);n.skip(4);let d=(0,c.Vv)(n,r);if(a=14===t?8:(0,c.Vv)(n,r),t>=18&&357!==s&&Math.min(t-18,(0,c.Vv)(n,r))>=22&&s===i.EXTENSIBLE){n.skip(6);let e=(0,c.io)(n,16);s=e[0]|e[1]<<8}(s===i.MULAW||s===i.ALAW)&&(a=8),this.audioInfo={format:s,numberOfChannels:o,sampleRate:l,sampleSizeInBytes:Math.ceil(a/8),blockSizeInBytes:d}}async parseListChunk(e,t,r){let i=this.reader.requestSlice(e,t);if(i instanceof Promise&&(i=await i),!i)return;let a=(0,c.IT)(i,4);if("INFO"!==a&&"INF0"!==a)return;let n=i.filePos;for(;n<=e+t-8;){i.filePos=n;let e=(0,c.IT)(i,4),t=(0,c.PF)(i,r),a=(0,c.io)(i,t),s=0;for(let e=0;e<a.length&&0!==a[e];e++)s++;let o=String.fromCharCode(...a.subarray(0,s));switch(this.metadataTags.raw??={},this.metadataTags.raw[e]=o,e){case"INAM":case"TITL":this.metadataTags.title??=o;break;case"TIT3":this.metadataTags.description??=o;break;case"IART":this.metadataTags.artist??=o;break;case"IPRD":this.metadataTags.album??=o;break;case"IPRT":case"ITRK":case"TRCK":{let e=o.split("/"),t=Number.parseInt(e[0],10),r=e[1]&&Number.parseInt(e[1],10);Number.isInteger(t)&&t>0&&(this.metadataTags.trackNumber??=t),r&&Number.isInteger(r)&&r>0&&(this.metadataTags.tracksTotal??=r)}break;case"ICRD":case"IDIT":{let e=new Date(o);Number.isNaN(e.getTime())||(this.metadataTags.date??=e)}break;case"YEAR":{let e=Number.parseInt(o,10);Number.isInteger(e)&&e>0&&(this.metadataTags.date??=new Date(e,0,1))}break;case"IGNR":case"GENR":this.metadataTags.genre??=o;break;case"ICMT":case"CMNT":case"COMM":this.metadataTags.comment??=o}n+=8+t+(1&t)}}async parseId3Chunk(e,t){let r=this.reader.requestSlice(e,t);if(r instanceof Promise&&(r=await r),!r)return;let i=(0,d.IX)(r);if(i){let t=r.slice(e+10,i.size);(0,d.cG)(t,i,this.metadataTags)}}getCodec(){if((0,o.vA)(this.audioInfo),this.audioInfo.format===i.MULAW)return"ulaw";if(this.audioInfo.format===i.ALAW)return"alaw";if(this.audioInfo.format===i.PCM){if(1===this.audioInfo.sampleSizeInBytes)return"pcm-u8";if(2===this.audioInfo.sampleSizeInBytes)return"pcm-s16";if(3===this.audioInfo.sampleSizeInBytes)return"pcm-s24";else if(4===this.audioInfo.sampleSizeInBytes)return"pcm-s32"}return this.audioInfo.format===i.IEEE_FLOAT&&4===this.audioInfo.sampleSizeInBytes?"pcm-f32":null}async getMimeType(){return"audio/wav"}async computeDuration(){await this.readMetadata();let e=this.tracks[0];return(0,o.vA)(e),e.computeDuration()}async getTracks(){return await this.readMetadata(),this.tracks}async getMetadataTags(){return await this.readMetadata(),this.metadataTags}}class h{constructor(e){this.demuxer=e}getId(){return 1}getCodec(){return this.demuxer.getCodec()}getInternalCodecId(){return(0,o.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.format}async getDecoderConfig(){let e=this.demuxer.getCodec();return e?((0,o.vA)(this.demuxer.audioInfo),{codec:e,numberOfChannels:this.demuxer.audioInfo.numberOfChannels,sampleRate:this.demuxer.audioInfo.sampleRate}):null}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}getNumberOfChannels(){return(0,o.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.numberOfChannels}getSampleRate(){return(0,o.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.sampleRate}getTimeResolution(){return(0,o.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.sampleRate}getName(){return null}getLanguageCode(){return o.IR}getDisposition(){return{...s.gM}}async getFirstTimestamp(){return 0}async getPacketAtIndex(e,t){let r;(0,o.vA)(this.demuxer.audioInfo);let i=2048*e*this.demuxer.audioInfo.blockSizeInBytes;if(i>=this.demuxer.dataSize)return null;let a=Math.min(2048*this.demuxer.audioInfo.blockSizeInBytes,this.demuxer.dataSize-i);if(null===this.demuxer.reader.fileSize){let e=this.demuxer.reader.requestSlice(this.demuxer.dataStart+i,a);if(e instanceof Promise&&(e=await e),!e)return null}if(t.metadataOnly)r=l.T;else{let e=this.demuxer.reader.requestSlice(this.demuxer.dataStart+i,a);e instanceof Promise&&(e=await e),(0,o.vA)(e),r=(0,c.io)(e,a)}let n=2048*e/this.demuxer.audioInfo.sampleRate,s=a/this.demuxer.audioInfo.blockSizeInBytes/this.demuxer.audioInfo.sampleRate;return this.demuxer.lastKnownPacketIndex=Math.max(e,n),new l.Z(r,"key",n,s,e,a)}getFirstPacket(e){return this.getPacketAtIndex(0,e)}async getPacket(e,t){(0,o.vA)(this.demuxer.audioInfo);let r=Math.floor(Math.min(e*this.demuxer.audioInfo.sampleRate/2048,(this.demuxer.dataSize-1)/(2048*this.demuxer.audioInfo.blockSizeInBytes))),i=await this.getPacketAtIndex(r,t);if(i)return i;if(0===r)return null;(0,o.vA)(null===this.demuxer.reader.fileSize);let a=await this.getPacketAtIndex(this.demuxer.lastKnownPacketIndex,t);for(;a;){let e=await this.getNextPacket(a,t);if(!e)break;a=e}return a}getNextPacket(e,t){(0,o.vA)(this.demuxer.audioInfo);let r=Math.round(e.timestamp*this.demuxer.audioInfo.sampleRate/2048);return this.getPacketAtIndex(r+1,t)}getKeyPacket(e,t){return this.getPacket(e,t)}getNextKeyPacket(e,t){return this.getNextPacket(e,t)}}},3722:(e,t,r)=>{function i(e,t){if(t.length<2)throw Error(e+" must have at least 2 elements");for(let r of t){if("number"!=typeof r)throw Error(`${e} must contain only numbers`);if(!Number.isFinite(r))throw Error(`${e} must contain only finite numbers, but got [${t.join(",")}]`)}}r.d(t,{JC:()=>b});"undefined"!=typeof window&&(window.remotion_renderReady=!1,window.remotion_delayRenderTimeouts||(window.remotion_delayRenderTimeouts={}),window.remotion_delayRenderHandles=[]);var a="remotion-date:",n="remotion-file:",s="[-+]?\\d*\\.?\\d+",o=s+"%";function l(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}function c(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function d(e,t,r){let i=r<.5?r*(1+t):r+t-r*t,a=2*r-i,n=c(a,i,e+1/3);return Math.round(255*n)<<24|Math.round(255*c(a,i,e))<<16|Math.round(255*c(a,i,e-1/3))<<8}function u(e){let t=Number.parseInt(e,10);return t<0?0:t>255?255:t}function h(e){return(Number.parseFloat(e)%360+360)%360/360}function f(e){let t=Number.parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function m(e){let t=Number.parseFloat(e);return t<0?0:t>100?1:t/100}var p={transparent:0,aliceblue:0xf0f8ffff,antiquewhite:0xfaebd7ff,aqua:0xffffff,aquamarine:0x7fffd4ff,azure:0xf0ffffff,beige:0xf5f5dcff,bisque:0xffe4c4ff,black:255,blanchedalmond:0xffebcdff,blue:65535,blueviolet:0x8a2be2ff,brown:0xa52a2aff,burlywood:0xdeb887ff,burntsienna:0xea7e5dff,cadetblue:0x5f9ea0ff,chartreuse:0x7fff00ff,chocolate:0xd2691eff,coral:0xff7f50ff,cornflowerblue:0x6495edff,cornsilk:0xfff8dcff,crimson:0xdc143cff,cyan:0xffffff,darkblue:35839,darkcyan:9145343,darkgoldenrod:0xb8860bff,darkgray:0xa9a9a9ff,darkgreen:6553855,darkgrey:0xa9a9a9ff,darkkhaki:0xbdb76bff,darkmagenta:0x8b008bff,darkolivegreen:0x556b2fff,darkorange:0xff8c00ff,darkorchid:0x9932ccff,darkred:0x8b0000ff,darksalmon:0xe9967aff,darkseagreen:0x8fbc8fff,darkslateblue:0x483d8bff,darkslategray:0x2f4f4fff,darkslategrey:0x2f4f4fff,darkturquoise:0xced1ff,darkviolet:0x9400d3ff,deeppink:0xff1493ff,deepskyblue:0xbfffff,dimgray:0x696969ff,dimgrey:0x696969ff,dodgerblue:0x1e90ffff,firebrick:0xb22222ff,floralwhite:0xfffaf0ff,forestgreen:0x228b22ff,fuchsia:0xff00ffff,gainsboro:0xdcdcdcff,ghostwhite:0xf8f8ffff,gold:0xffd700ff,goldenrod:0xdaa520ff,gray:0x808080ff,green:8388863,greenyellow:0xadff2fff,grey:0x808080ff,honeydew:0xf0fff0ff,hotpink:0xff69b4ff,indianred:0xcd5c5cff,indigo:0x4b0082ff,ivory:0xfffff0ff,khaki:0xf0e68cff,lavender:0xe6e6faff,lavenderblush:0xfff0f5ff,lawngreen:0x7cfc00ff,lemonchiffon:0xfffacdff,lightblue:0xadd8e6ff,lightcoral:0xf08080ff,lightcyan:0xe0ffffff,lightgoldenrodyellow:0xfafad2ff,lightgray:0xd3d3d3ff,lightgreen:0x90ee90ff,lightgrey:0xd3d3d3ff,lightpink:0xffb6c1ff,lightsalmon:0xffa07aff,lightseagreen:0x20b2aaff,lightskyblue:0x87cefaff,lightslategray:0x778899ff,lightslategrey:0x778899ff,lightsteelblue:0xb0c4deff,lightyellow:0xffffe0ff,lime:0xff00ff,limegreen:0x32cd32ff,linen:0xfaf0e6ff,magenta:0xff00ffff,maroon:0x800000ff,mediumaquamarine:0x66cdaaff,mediumblue:52735,mediumorchid:0xba55d3ff,mediumpurple:0x9370dbff,mediumseagreen:0x3cb371ff,mediumslateblue:0x7b68eeff,mediumspringgreen:0xfa9aff,mediumturquoise:0x48d1ccff,mediumvioletred:0xc71585ff,midnightblue:0x191970ff,mintcream:0xf5fffaff,mistyrose:0xffe4e1ff,moccasin:0xffe4b5ff,navajowhite:0xffdeadff,navy:33023,oldlace:0xfdf5e6ff,olive:0x808000ff,olivedrab:0x6b8e23ff,orange:0xffa500ff,orangered:0xff4500ff,orchid:0xda70d6ff,palegoldenrod:0xeee8aaff,palegreen:0x98fb98ff,paleturquoise:0xafeeeeff,palevioletred:0xdb7093ff,papayawhip:0xffefd5ff,peachpuff:0xffdab9ff,peru:0xcd853fff,pink:0xffc0cbff,plum:0xdda0ddff,powderblue:0xb0e0e6ff,purple:0x800080ff,rebeccapurple:0x663399ff,red:0xff0000ff,rosybrown:0xbc8f8fff,royalblue:0x4169e1ff,saddlebrown:0x8b4513ff,salmon:0xfa8072ff,sandybrown:0xf4a460ff,seagreen:0x2e8b57ff,seashell:0xfff5eeff,sienna:0xa0522dff,silver:0xc0c0c0ff,skyblue:0x87ceebff,slateblue:0x6a5acdff,slategray:0x708090ff,slategrey:0x708090ff,snow:0xfffafaff,springgreen:0xff7fff,steelblue:0x4682b4ff,tan:0xd2b48cff,teal:8421631,thistle:0xd8bfd8ff,tomato:0xff6347ff,turquoise:0x40e0d0ff,violet:0xee82eeff,wheat:0xf5deb3ff,white:0xffffffff,whitesmoke:0xf5f5f5ff,yellow:0xffff00ff,yellowgreen:0x9acd32ff},g=["h264","h265","vp8","vp9","mp3","aac","wav","prores","h264-mkv","h264-ts","gif"],y=e=>"undefined"==typeof window||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("file://")||e.startsWith("blob:")||e.startsWith("data:")?e:new URL(e,window.origin).href,b={processColor:function(e){let t=function(e){let t;let r=function(){let e={rgb:void 0,rgba:void 0,hsl:void 0,hsla:void 0,hex3:void 0,hex4:void 0,hex5:void 0,hex6:void 0,hex8:void 0};return void 0===e.rgb&&(e.rgb=RegExp("rgb"+l(s,s,s)),e.rgba=RegExp("rgba"+l(s,s,s,s)),e.hsl=RegExp("hsl"+l(s,o,o)),e.hsla=RegExp("hsla"+l(s,o,o,s)),e.hex3=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,e.hex4=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,e.hex6=/^#([0-9a-fA-F]{6})$/,e.hex8=/^#([0-9a-fA-F]{8})$/),e}();if(r.hex6&&(t=r.hex6.exec(e)))return Number.parseInt(t[1]+"ff",16)>>>0;if(void 0!==p[e])return p[e];if(r.rgb&&(t=r.rgb.exec(e)))return(u(t[1])<<24|u(t[2])<<16|u(t[3])<<8|255)>>>0;if(r.rgba&&(t=r.rgba.exec(e)))return(u(t[1])<<24|u(t[2])<<16|u(t[3])<<8|f(t[4]))>>>0;if(r.hex3&&(t=r.hex3.exec(e)))return Number.parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0;if(r.hex8&&(t=r.hex8.exec(e)))return Number.parseInt(t[1],16)>>>0;if(r.hex4&&(t=r.hex4.exec(e)))return Number.parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0;if(r.hsl&&(t=r.hsl.exec(e)))return(255|d(h(t[1]),m(t[2]),m(t[3])))>>>0;if(r.hsla&&(t=r.hsla.exec(e)))return(d(h(t[1]),m(t[2]),m(t[3]))|f(t[4]))>>>0;throw Error(`invalid color string ${e} provided`)}(e);return(t<<24|t>>>8)>>>0},truthy:function(e){return!!e},validateFps:function(e,t,r){if("number"!=typeof e)throw Error(`"fps" must be a number, but you passed a value of type ${typeof e} ${t}`);if(!Number.isFinite(e))throw Error(`"fps" must be a finite, but you passed ${e} ${t}`);if(isNaN(e))throw Error(`"fps" must not be NaN, but got ${e} ${t}`);if(e<=0)throw TypeError(`"fps" must be positive, but got ${e} ${t}`);if(r&&e>50)throw TypeError("The FPS for a GIF cannot be higher than 50. Use the --every-nth-frame option to lower the FPS: https://remotion.dev/docs/render-as-gif")},validateDimension:function(e,t,r){if("number"!=typeof e)throw Error(`The "${t}" prop ${r} must be a number, but you passed a value of type ${typeof e}`);if(isNaN(e))throw TypeError(`The "${t}" prop ${r} must not be NaN, but is NaN.`);if(!Number.isFinite(e))throw TypeError(`The "${t}" prop ${r} must be finite, but is ${e}.`);if(e%1!=0)throw TypeError(`The "${t}" prop ${r} must be an integer, but is ${e}.`);if(e<=0)throw TypeError(`The "${t}" prop ${r} must be positive, but got ${e}.`)},validateDurationInFrames:function(e,t){let{allowFloats:r,component:i}=t;if(void 0===e)throw Error(`The "durationInFrames" prop ${i} is missing.`);if("number"!=typeof e)throw Error(`The "durationInFrames" prop ${i} must be a number, but you passed a value of type ${typeof e}`);if(e<=0)throw TypeError(`The "durationInFrames" prop ${i} must be positive, but got ${e}.`);if(!r&&e%1!=0)throw TypeError(`The "durationInFrames" prop ${i} must be an integer, but got ${e}.`);if(!Number.isFinite(e))throw TypeError(`The "durationInFrames" prop ${i} must be finite, but got ${e}.`)},validateDefaultAndInputProps:(e,t,r)=>{if(e){if("object"!=typeof e)throw Error(`"${t}" must be an object, but you passed a value of type ${typeof e}`);if(Array.isArray(e))throw Error(`"${t}" must be an object, an array was passed ${r?`for composition "${r}"`:""}`)}},validateFrame:({allowFloats:e,durationInFrames:t,frame:r})=>{if(void 0===r)throw TypeError('Argument missing for parameter "frame"');if("number"!=typeof r)throw TypeError(`Argument passed for "frame" is not a number: ${r}`);if(!Number.isFinite(r))throw RangeError(`Frame ${r} is not finite`);if(r%1!=0&&!e)throw RangeError(`Argument for frame must be an integer, but got ${r}`);if(r<0&&r<-t)throw RangeError(`Cannot use frame ${r}: Duration of composition is ${t}, therefore the lowest frame that can be rendered is ${-t}`);if(r>t-1)throw RangeError(`Cannot use frame ${r}: Duration of composition is ${t}, therefore the highest frame that can be rendered is ${t-1}`)},serializeJSONWithSpecialTypes:({data:e,indent:t,staticBase:r})=>{let i=!1,s=!1,o=!1,l=!1;try{return{serializedString:JSON.stringify(e,function(e,t){let c=this[e];return c instanceof Date?(i=!0,`${a}${c.toISOString()}`):c instanceof Map?(o=!0,t):c instanceof Set?(l=!0,t):"string"==typeof c&&null!==r&&c.startsWith(r)?(s=!0,`${n}${c.replace(r+"/","")}`):t},t),customDateUsed:i,customFileUsed:s,mapUsed:o,setUsed:l}}catch(e){throw Error("Could not serialize the passed input props to JSON: "+e.message)}},bundleName:"bundle.js",bundleMapName:"bundle.js.map",deserializeJSONWithSpecialTypes:e=>JSON.parse(e,(e,t)=>"string"==typeof t&&t.startsWith(a)?new Date(t.replace(a,"")):"string"==typeof t&&t.startsWith(n)?`${window.remotion_staticBase}/${t.replace(n,"")}`:t),DELAY_RENDER_CALLSTACK_TOKEN:"The delayRender was called:",DELAY_RENDER_RETRY_TOKEN:"- Rendering the frame will be retried.",DELAY_RENDER_CLEAR_TOKEN:"handle was cleared after",DELAY_RENDER_ATTEMPT_TOKEN:"Retries left: ",getOffthreadVideoSource:({src:e,transparent:t,currentTime:r,toneMapped:i})=>`http://localhost:${window.remotion_proxyPort}/proxy?src=${encodeURIComponent(y(e))}&time=${encodeURIComponent(Math.max(0,r))}&transparent=${String(t)}&toneMapped=${String(i)}`,getExpectedMediaFrameUncorrected:({frame:e,playbackRate:t,startFrom:r})=>(function(e,t,r,a){if(void 0===e)throw Error("input can not be undefined");if(void 0===t)throw Error("inputRange can not be undefined");if(void 0===r)throw Error("outputRange can not be undefined");if(t.length!==r.length)throw Error("inputRange ("+t.length+") and outputRange ("+r.length+") must have the same length");i("inputRange",t),i("outputRange",r),function(e){for(let t=1;t<e.length;++t)if(!(e[t]>e[t-1]))throw Error(`inputRange must be strictly monotonically increasing but got [${e.join(",")}]`)}(t);let n="extend";void 0!=void 0&&(n=a.extrapolateLeft);let s="extend";if(a?.extrapolateRight!==void 0&&(s=a.extrapolateRight),"number"!=typeof e)throw TypeError("Cannot interpolate an input which is not a number");let o=function(e,t){let r;for(r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}(e,t);return function(e,t,r,i){let{extrapolateLeft:a,extrapolateRight:n,easing:s}=i,o=e,[l,c]=t,[d,u]=r;if(o<l){if("identity"===a)return o;if("clamp"===a)o=l;else if("wrap"===a){let e=c-l;o=((o-l)%e+e)%e+l}}if(o>c){if("identity"===n)return o;if("clamp"===n)o=c;else if("wrap"===n){let e=c-l;o=((o-l)%e+e)%e+l}}return d===u?d:o=(o=s(o=(o-l)/(c-l)))*(u-d)+d}(e,[t[o],t[o+1]],[r[o],r[o+1]],{easing:(void 0)??(e=>e),extrapolateLeft:n,extrapolateRight:s})})(e,[-1,r,r+1],[-1,r,r+t]),ENABLE_V5_BREAKING_CHANGES:!1,MIN_NODE_VERSION:16,MIN_BUN_VERSION:"1.0.3",colorNames:p,DATE_TOKEN:a,FILE_TOKEN:n,validateCodec:function(e,t,r){if(void 0!==e){if("string"!=typeof e)throw TypeError(`The "${r}" prop ${t} must be a string, but you passed a value of type ${typeof e}.`);if(!g.includes(e))throw Error(`The "${r}" prop ${t} must be one of ${g.join(", ")}, but you passed ${e}.`)}},proResProfileOptions:["4444-xq","4444","hq","standard","light","proxy"]}},4004:(e,t,r)=>{r.d(t,{Ce:()=>e2,fP:()=>eN});var i=r(697),a=r(2115),n=r(6194),s=r(5247),o=r(4947),l=r(1154),c=r(5155),d=Symbol.dispose||Symbol.for("Symbol.dispose"),u=Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose"),h=(e,t,r)=>{if(null!=t){var i;if("object"!=typeof t&&"function"!=typeof t)throw TypeError('Object expected to be assigned to "using" declaration');if(r&&(i=t[u]),void 0===i&&(i=t[d]),"function"!=typeof i)throw TypeError("Object not disposable");e.push([r,i,t])}else r&&e.push([r]);return t},f=(e,t,r)=>{var i="function"==typeof SuppressedError?SuppressedError:function(e,t,r,i){return(i=Error(r)).name="SuppressedError",i.error=e,i.suppressed=t,i},a=e=>t=r?new i(e,t,"An error was suppressed during disposal"):(r=!0,e),n=i=>{for(;i=e.pop();)try{var s=i[1]&&i[1].call(i[2]);if(i[0])return Promise.resolve(s).then(n,e=>(a(e),n()))}catch(e){a(e)}if(r)throw t};return n()},m=({loop:e,mediaDurationInSeconds:t,unloopedTimeInSeconds:r,src:a,trimAfter:n,trimBefore:s,fps:o,playbackRate:l,ifNoMediaDuration:c})=>{if(null===t&&e&&"fail"===c)throw Error(`Could not determine duration of ${a}, but "loop" was set.`);let d=r*l%(e?i.Xp.calculateMediaDuration({trimAfter:n,mediaDurationInFrames:t?t*o:1/0,playbackRate:1,trimBefore:s})/o:1/0);return(n??null)!==null&&!e&&d>=(n-(s??0))/o?null:d+(s??0)/o},p=({mediaDurationInSeconds:e,ifNoMediaDuration:t,src:r,trimAfter:a,trimBefore:n,fps:s})=>{if(null===e&&"fail"===t)throw Error(`Could not determine duration of ${r}, but "loop" was set.`);return i.Xp.calculateMediaDuration({trimAfter:a,mediaDurationInFrames:e?e*s:1/0,playbackRate:1,trimBefore:n})/s+(n??0)/s},g=e=>Math.round(1e3*e)/1e3,y=async(e,t)=>{let r=await Promise.race([e,new Promise(e=>{Promise.resolve().then(()=>e())})]);if(!r){let r=t.waitCallback(),i=await e;return r(),i}return r},b=(e,t)=>{let r=!1,i=t.makeIteratorOrUsePrewarmed(e),a=[],n=[],s=-1/0,o=()=>{for(let e of a)e.node.stop();a.length=0},l=async e=>{let t=i.next(),r=e?await y(t,e):await Promise.race([t,new Promise(e=>{Promise.resolve().then(()=>e())})]);return r?r.value?(s=Math.max(s,r.value.timestamp+r.value.duration),{type:"got-buffer",buffer:r.value}):{type:"got-end",mostRecentTimestamp:s}:{type:"need-to-wait-for-it",waitPromise:async()=>(await t).value}},c=()=>{let e=a.slice();for(let t of e)t.node.stop();return a.length=0,e},d=(e,t)=>{n.push({buffer:e,timestamp:t})};return{destroy:()=>{o(),r=!0,i.return().catch(()=>{}),n.length=0},getNext:async()=>{let e=await i.next();return e.value&&(s=Math.max(s,e.value.timestamp+e.value.duration)),e},isDestroyed:()=>r,addQueuedAudioNode:(e,t,r)=>{a.push({node:e,timestamp:t,buffer:r})},removeQueuedAudioNode:e=>{let t=a.findIndex(t=>t.node===e);-1!==t&&a.splice(t,1)},getAndClearAudioChunksForAfterResuming:()=>{let e=n.slice();return n.length=0,e},getQueuedPeriod:()=>{let e=-1/0,t=1/0;for(let r of a)e=Math.max(e,r.timestamp+r.buffer.duration),t=Math.min(t,r.timestamp);for(let r of n)e=Math.max(e,r.timestamp+r.buffer.duration),t=Math.min(t,r.timestamp);return Number.isFinite(t)&&Number.isFinite(e)?{from:t,until:e}:null},tryToSatisfySeek:async(t,r,i)=>{if(t<e)return{type:"not-satisfied",reason:"time requested is before the start of the iterator"};for(;;){let e=await l(r);if("need-to-wait-for-it"===e.type)return{type:"not-satisfied",reason:"iterator did not have buffer ready"};if("got-end"===e.type){if(t>=s)return{type:"ended"};return{type:"not-satisfied",reason:"iterator ended before the requested time"}}if("got-buffer"===e.type){let r=g(e.buffer.timestamp),a=g(e.buffer.timestamp+e.buffer.duration),n=g(t);if(n<r)return{type:"not-satisfied",reason:`iterator is too far, most recently returned ${r}-${a}, requested ${n}`};if(r<=n&&a>=n)return i(e.buffer),{type:"satisfied"};i(e.buffer);continue}throw Error("Unreachable")}},addChunkForAfterResuming:d,moveQueuedChunksToPauseQueue:()=>{for(let e of c())d(e.buffer,e.timestamp)},getNumberOfChunksAfterResuming:()=>n.length}},k=(e,t)=>!!t&&e>=t.from&&e<t.until,w=e=>{let t=new Map;return{prewarmIteratorForLooping:({timeToSeek:r})=>{t.has(r)||t.set(r,e.canvases(r))},makeIteratorOrUsePrewarmed:r=>{let i=t.get(r);return i?(t.delete(r),i):e.canvases(r)},destroy:()=>{for(let e of t.values())e.return();t.clear()}}},v=e=>{let t=new Map;return{prewarmIteratorForLooping:({timeToSeek:r})=>{t.has(r)||t.set(r,e.buffers(r))},makeIteratorOrUsePrewarmed:r=>{let i=t.get(r);return i?(t.delete(r),i):e.buffers(r)},destroy:()=>{for(let e of t.values())e.return();t.clear()}}},x=({audioTrack:e,delayPlaybackHandleIfNotPremounting:t,sharedAudioContext:r,getIsLooping:i,getEndTime:a,getStartTime:s,updatePlaybackTime:o,initialMuted:c})=>{let d=c,u=1,m=r.createGain();m.connect(r.destination);let p=v(new l.O8(e)),g=null,y=0,w=null,x=({buffer:e,mediaTimestamp:t,playbackRate:i,scheduleAudioNode:a})=>{if(!g)throw Error("Audio buffer iterator not found");if(d)return;let n=r.createBufferSource();n.buffer=e,n.playbackRate.value=i,n.connect(m),a(n,t);let s=g;s.addQueuedAudioNode(n,t,e),n.onended=()=>{setTimeout(()=>{s.removeQueuedAudioNode(n)},30)}},T=({getIsPlaying:e,buffer:t,playbackRate:r,scheduleAudioNode:i})=>{if(!d){if(e())x({buffer:t.buffer,mediaTimestamp:t.timestamp,playbackRate:r,scheduleAudioNode:i});else{if(!g)throw Error("Audio buffer iterator not found");g.addChunkForAfterResuming(t.buffer,t.timestamp)}}},S=async({nonce:e,playbackRate:r,startFromSecond:i,getIsPlaying:a,scheduleAudioNode:s})=>{let l=[];try{if(d)return;o(i),g?.destroy(),w=h(l,t(),0);let c=b(i,p);y++,g=c;try{for(let t=0;t<3;t++){let t=await c.getNext();if(c.isDestroyed()||e.isStale()||!t.value)return;T({getIsPlaying:a,buffer:t.value,playbackRate:r,scheduleAudioNode:s})}}catch(e){if(e instanceof n.Q)return;throw e}}catch(e){var c=e,u=1}finally{f(l,c,u)}},C=async({newTime:e,nonce:t,fps:r,playbackRate:n,getIsPlaying:o,scheduleAudioNode:l,bufferState:c})=>{if(d)return;if(i()&&a()-e<1&&p.prewarmIteratorForLooping({timeToSeek:s()}),!g){await S({nonce:t,playbackRate:n,startFromSecond:e,getIsPlaying:o,scheduleAudioNode:l});return}if(!k(e,g.getQueuedPeriod())){let r=await g.tryToSatisfySeek(e,null,e=>{t.isStale()||T({getIsPlaying:o,buffer:e,playbackRate:n,scheduleAudioNode:l})});if(t.isStale()||"ended"===r.type)return;if("not-satisfied"===r.type){await S({nonce:t,playbackRate:n,startFromSecond:e,getIsPlaying:o,scheduleAudioNode:l});return}r.type}let u=e+1/r*Math.max(1,n)*3;if(!k(u,g.getQueuedPeriod())){let r=await g.tryToSatisfySeek(u,{type:"allow-wait",waitCallback:()=>{let e=c.delayPlayback();return()=>{e.unblock()}}},e=>{t.isStale()||T({getIsPlaying:o,buffer:e,playbackRate:n,scheduleAudioNode:l})});if(t.isStale()||"ended"===r.type)return;"not-satisfied"===r.type&&await S({nonce:t,playbackRate:n,startFromSecond:e,getIsPlaying:o,scheduleAudioNode:l})}};return{startAudioIterator:S,resumeScheduledAudioChunks:({playbackRate:e,scheduleAudioNode:t})=>{if(!d&&g)for(let r of g.getAndClearAudioChunksForAfterResuming())x({buffer:r.buffer,mediaTimestamp:r.timestamp,playbackRate:e,scheduleAudioNode:t})},pausePlayback:()=>{g&&g.moveQueuedChunksToPauseQueue()},getAudioBufferIterator:()=>g,destroyIterator:()=>{p.destroy(),g?.destroy(),g=null,w&&(w.unblock(),w=null)},seek:C,getAudioIteratorsCreated:()=>y,setMuted:e=>{d=e,m.gain.value=d?0:u},setVolume:e=>{u=Math.max(0,e),m.gain.value=d?0:u},scheduleAudioChunk:x}},T=({audioSyncAnchor:e,currentTime:t,playbackRate:r})=>(t-e)*r,S=({context:e,audioTime:t,audioContextState:r,audioSyncAnchor:i,playing:a,audioIteratorManager:n,videoIteratorManager:s})=>{let o=["Debug overlay",`Video iterators created: ${s?.getVideoIteratorsCreated()}`,`Audio iterators created: ${n?.getAudioIteratorsCreated()}`,`Frames rendered: ${s?.getFramesRendered()}`,`Audio context state: ${r}`,t?`Audio time: ${(t-i).toFixed(3)}s`:null].filter(Boolean);if(n){let e=n.getAudioBufferIterator()?.getQueuedPeriod(),r=n?.getAudioBufferIterator()?.getNumberOfChunksAfterResuming();e&&t?o.push(`Audio queued until: ${(e.until-(t-i)).toFixed(3)}s`):r&&o.push(`Audio chunks for after resuming: ${r}`),o.push(`Playing: ${a}`)}let l=30*o.length+20;e.fillStyle="rgba(0, 0, 0, 1)",e.fillRect(20,20,600,l),e.fillStyle="white",e.font="24px sans-serif",e.textBaseline="top";for(let t=0;t<o.length;t++)e.fillText(o[t],30,30+30*t)};function C(e){return!!(e.message.includes("Failed to fetch")||e.message.includes("Load failed")||e.message.includes("NetworkError when attempting to fetch resource"))}var P=()=>{let e=0;return{createAsyncOperation:()=>{let t=++e;return{isStale:()=>e!==t}}}},I=async(e,t)=>{let r=!1,i=t.makeIteratorOrUsePrewarmed(e),a=!1,n=(await i.next())?.value??null,s=n,o=async()=>{let e=i.next(),t=await Promise.race([e,new Promise(e=>{Promise.resolve().then(()=>e())})]);return t?(t.value?s=t.value:a=!0,{type:"got-frame-or-end",frame:t.value??null}):{type:"need-to-wait-for-it",waitPromise:async()=>{let t=await e;return t.value?s=t.value:a=!0,t.value}}},l=async t=>{if(s){let r=g(s.timestamp);if(g(t)<r)return s===n&&g(t)>=g(e)?{type:"satisfied",frame:s}:{type:"not-satisfied",reason:`iterator is too far, most recently returned ${r}`};let i=g(s.timestamp+s.duration),a=g(t);if(r<=a&&i>a)return{type:"satisfied",frame:s}}if(a)return s?{type:"satisfied",frame:s}:{type:"not-satisfied",reason:"iterator ended"};for(;;){let e=await o();if("need-to-wait-for-it"===e.type)return{type:"not-satisfied",reason:"iterator did not have frame ready"};if("got-frame-or-end"===e.type){if(null===e.frame){if(a=!0,s)return{type:"satisfied",frame:s};return{type:"not-satisfied",reason:"iterator ended and did not have frame ready"}}let r=g(e.frame.timestamp),i=g(e.frame.timestamp+e.frame.duration),n=g(t);if(r<=n&&i>n)return{type:"satisfied",frame:e.frame};continue}throw Error("Unreachable")}};return{destroy:()=>{r=!0,s=null,i.return().catch(()=>{})},initialFrame:n,isDestroyed:()=>r,tryToSatisfySeek:l}},E=({delayPlaybackHandleIfNotPremounting:e,canvas:t,context:r,drawDebugOverlay:a,logLevel:n,getOnVideoFrameCallback:s,videoTrack:o,getEndTime:c,getStartTime:d,getIsLooping:u})=>{let m=0,p=null,g=0,y=null;t&&(t.width=o.displayWidth,t.height=o.displayHeight);let b=w(new l.Yy(o,{poolSize:2,fit:"contain",alpha:!0})),k=e=>{r&&t&&(r.clearRect(0,0,t.width,t.height),r.drawImage(e.canvas,0,0)),g++,a();let o=s();o&&o(e.canvas),i.Xp.Log.trace({logLevel:n,tag:"@remotion/media"},`[MediaPlayer] Drew frame ${e.timestamp.toFixed(3)}s`)},v=async(t,r)=>{let i=[];try{p?.destroy(),y=h(i,e(),0);let a=await I(t,b);if(m++,p=a,a.isDestroyed()||r.isStale()||p.isDestroyed()||!a.initialFrame)return;k(a.initialFrame)}catch(e){var a=e,n=1}finally{f(i,a,n)}},x=async({newTime:e,nonce:t})=>{if(!p)return;u()&&c()-e<1&&b.prewarmIteratorForLooping({timeToSeek:d()});let r=await p.tryToSatisfySeek(e);if("satisfied"===r.type){k(r.frame);return}!t.isStale()&&await v(e,t)};return{startVideoIterator:v,getVideoIteratorsCreated:()=>m,seek:x,destroy:()=>{b.destroy(),p?.destroy(),r&&t&&r.clearRect(0,0,t.width,t.height),y&&(y.unblock(),y=null),p=null},getVideoFrameIterator:()=>p,drawFrame:k,getFramesRendered:()=>g}};class A{canvas;context;src;logLevel;playbackRate;globalPlaybackRate;audioStreamIndex;sharedAudioContext;audioIteratorManager=null;videoIteratorManager=null;audioSyncAnchor=0;playing=!1;loop=!1;fps;trimBefore;trimAfter;totalDuration;debugOverlay=!1;nonceManager;onVideoFrameCallback=null;initializationPromise=null;bufferState;isPremounting;isPostmounting;seekPromiseChain=Promise.resolve();constructor({canvas:e,src:t,logLevel:r,sharedAudioContext:i,loop:a,trimBefore:l,trimAfter:c,playbackRate:d,globalPlaybackRate:u,audioStreamIndex:h,fps:f,debugOverlay:m,bufferState:p,isPremounting:g,isPostmounting:y,onVideoFrameCallback:b,playing:k}){if(this.canvas=e??null,this.src=t,this.logLevel=r,this.sharedAudioContext=i,this.playbackRate=d,this.globalPlaybackRate=u,this.loop=a,this.trimBefore=l,this.trimAfter=c,this.audioStreamIndex=h??0,this.fps=f,this.debugOverlay=m,this.bufferState=p,this.isPremounting=g,this.isPostmounting=y,this.nonceManager=P(),this.onVideoFrameCallback=b,this.playing=k,this.input=new n.p({source:new s.Ts(this.src),formats:o.XE}),e){let t=e.getContext("2d",{alpha:!0,desynchronized:!0});if(!t)throw Error("Could not get 2D context from canvas");this.context=t}else this.context=null}input;isDisposalError(){return!0===this.input.disposed}initialize(e,t){let r=this._initialize(e,t);return this.initializationPromise=r,this.seekPromiseChain=r,r}getStartTime(){return(this.trimBefore??0)/this.fps}getEndTime(){return p({mediaDurationInSeconds:this.totalDuration,ifNoMediaDuration:"fail",src:this.src,trimAfter:this.trimAfter,trimBefore:this.trimBefore,fps:this.fps})}async _initialize(e,t){let r=[];try{h(r,this.delayPlaybackHandleIfNotPremounting(),0);try{if(this.input.disposed)return{type:"disposed"};try{await this.input.getFormat()}catch(e){if(this.isDisposalError())return{type:"disposed"};if(C(e))throw e;return i.Xp.Log.error({logLevel:this.logLevel,tag:"@remotion/media"},`[MediaPlayer] Failed to recognize format for ${this.src}`,e),{type:"unknown-container-format"}}let[r,a,n]=await Promise.all([this.input.computeDuration(),this.input.getPrimaryVideoTrack(),this.input.getAudioTracks()]);if(this.input.disposed)return{type:"disposed"};this.totalDuration=r;let s=n[this.audioStreamIndex]??null;if(!a&&!s)return{type:"no-tracks"};if(a){if(!await a.canDecode())return{type:"cannot-decode"};if(this.input.disposed)return{type:"disposed"};this.videoIteratorManager=E({videoTrack:a,delayPlaybackHandleIfNotPremounting:this.delayPlaybackHandleIfNotPremounting,context:this.context,canvas:this.canvas,getOnVideoFrameCallback:()=>this.onVideoFrameCallback,logLevel:this.logLevel,drawDebugOverlay:this.drawDebugOverlay,getEndTime:()=>this.getEndTime(),getStartTime:()=>this.getStartTime(),getIsLooping:()=>this.loop})}let o=m({unloopedTimeInSeconds:e,playbackRate:this.playbackRate,loop:this.loop,trimBefore:this.trimBefore,trimAfter:this.trimAfter,mediaDurationInSeconds:this.totalDuration,fps:this.fps,ifNoMediaDuration:"infinity",src:this.src});if(null===o)throw Error("should have asserted that the time is not null");this.setPlaybackTime(o,this.playbackRate*this.globalPlaybackRate),s&&this.sharedAudioContext&&(this.audioIteratorManager=x({audioTrack:s,delayPlaybackHandleIfNotPremounting:this.delayPlaybackHandleIfNotPremounting,sharedAudioContext:this.sharedAudioContext,getIsLooping:()=>this.loop,getEndTime:()=>this.getEndTime(),getStartTime:()=>this.getStartTime(),updatePlaybackTime:e=>this.setPlaybackTime(e,this.playbackRate*this.globalPlaybackRate),initialMuted:t}));let l=this.nonceManager.createAsyncOperation();try{await Promise.all([this.audioIteratorManager?this.audioIteratorManager.startAudioIterator({nonce:l,playbackRate:this.playbackRate*this.globalPlaybackRate,startFromSecond:o,getIsPlaying:()=>this.playing,scheduleAudioNode:this.scheduleAudioNode}):Promise.resolve(),this.videoIteratorManager?this.videoIteratorManager.startVideoIterator(o,l):Promise.resolve()])}catch(e){if(this.isDisposalError())return{type:"disposed"};i.Xp.Log.error({logLevel:this.logLevel,tag:"@remotion/media"},"[MediaPlayer] Failed to start audio and video iterators",e)}return{type:"success",durationInSeconds:r}}catch(e){if(C(e))return i.Xp.Log.error({logLevel:this.logLevel,tag:"@remotion/media"},`[MediaPlayer] Network/CORS error for ${this.src}`,e),{type:"network-error"};throw i.Xp.Log.error({logLevel:this.logLevel,tag:"@remotion/media"},"[MediaPlayer] Failed to initialize",e),e}}catch(e){var a=e,n=1}finally{f(r,a,n)}}seekToWithQueue=async e=>{let t=this.nonceManager.createAsyncOperation();await this.seekPromiseChain,this.seekPromiseChain=this.seekToDoNotCallDirectly(e,t),await this.seekPromiseChain};async seekTo(e){let t=m({unloopedTimeInSeconds:e,playbackRate:this.playbackRate,loop:this.loop,trimBefore:this.trimBefore,trimAfter:this.trimAfter,mediaDurationInSeconds:this.totalDuration??null,fps:this.fps,ifNoMediaDuration:"infinity",src:this.src});if(null===t)throw Error("should have asserted that the time is not null");await this.seekToWithQueue(t)}async seekToDoNotCallDirectly(e,t){if(t.isStale())return;let r=this.audioIteratorManager&&this.sharedAudioContext&&this.getAudioPlaybackTime()!==e;await Promise.all([this.videoIteratorManager?.seek({newTime:e,nonce:t}),r?this.audioIteratorManager?.seek({newTime:e,nonce:t,fps:this.fps,playbackRate:this.playbackRate*this.globalPlaybackRate,getIsPlaying:()=>this.playing,scheduleAudioNode:this.scheduleAudioNode,bufferState:this.bufferState}):null])}async play(e){if(this.playing)return;let t=m({unloopedTimeInSeconds:e,playbackRate:this.playbackRate,loop:this.loop,trimBefore:this.trimBefore,trimAfter:this.trimAfter,mediaDurationInSeconds:this.totalDuration??null,fps:this.fps,ifNoMediaDuration:"infinity",src:this.src});if(null===t)throw Error("should have asserted that the time is not null");this.setPlaybackTime(t,this.playbackRate*this.globalPlaybackRate),this.playing=!0,this.audioIteratorManager&&this.audioIteratorManager.resumeScheduledAudioChunks({playbackRate:this.playbackRate*this.globalPlaybackRate,scheduleAudioNode:this.scheduleAudioNode}),this.sharedAudioContext&&"suspended"===this.sharedAudioContext.state&&await this.sharedAudioContext.resume(),this.drawDebugOverlay()}delayPlaybackHandleIfNotPremounting=()=>{if(this.isPremounting||this.isPostmounting)return{unblock:()=>{},[Symbol.dispose]:()=>{}};let{unblock:e}=this.bufferState.delayPlayback();return{unblock:e,[Symbol.dispose]:()=>{e()}}};pause(){this.playing&&(this.playing=!1,this.audioIteratorManager?.pausePlayback(),this.drawDebugOverlay())}setMuted(e){this.audioIteratorManager?.setMuted(e)}setVolume(e){this.audioIteratorManager&&this.audioIteratorManager.setVolume(e)}async updateAfterTrimChange(e){if(!this.audioIteratorManager&&!this.videoIteratorManager)return;let t=m({unloopedTimeInSeconds:e,playbackRate:this.playbackRate,loop:this.loop,trimBefore:this.trimBefore,trimAfter:this.trimAfter,mediaDurationInSeconds:this.totalDuration??null,fps:this.fps,ifNoMediaDuration:"infinity",src:this.src});this.audioIteratorManager?.destroyIterator(),null!==t&&(this.setPlaybackTime(t,this.playbackRate*this.globalPlaybackRate),!this.playing&&this.videoIteratorManager&&await this.seekToWithQueue(t))}async setTrimBefore(e,t){this.trimBefore!==e&&(this.trimBefore=e,await this.updateAfterTrimChange(t))}async setTrimAfter(e,t){this.trimAfter!==e&&(this.trimAfter=e,await this.updateAfterTrimChange(t))}setDebugOverlay(e){this.debugOverlay=e}updateAudioTimeAfterPlaybackRateChange(){if(!this.audioIteratorManager||!this.sharedAudioContext)return;this.setPlaybackTime(this.getAudioPlaybackTime(),this.playbackRate*this.globalPlaybackRate);let e=this.audioIteratorManager.getAudioBufferIterator();e&&(e.moveQueuedChunksToPauseQueue(),this.playing&&this.audioIteratorManager.resumeScheduledAudioChunks({playbackRate:this.playbackRate*this.globalPlaybackRate,scheduleAudioNode:this.scheduleAudioNode}))}setPlaybackRate(e){this.playbackRate=e,this.updateAudioTimeAfterPlaybackRateChange()}setGlobalPlaybackRate(e){this.globalPlaybackRate=e,this.updateAudioTimeAfterPlaybackRateChange()}setFps(e){this.fps=e}setIsPremounting(e){this.isPremounting=e}setIsPostmounting(e){this.isPostmounting=e}setLoop(e){this.loop=e}async dispose(){if(this.initializationPromise)try{await this.initializationPromise}catch{}this.nonceManager.createAsyncOperation(),this.videoIteratorManager?.destroy(),this.audioIteratorManager?.destroyIterator(),this.input.dispose()}scheduleAudioNode=(e,t)=>{let r=(t-this.getAudioPlaybackTime())/(this.playbackRate*this.globalPlaybackRate);if(!this.sharedAudioContext)throw Error("Shared audio context not found");r>=0?e.start(this.sharedAudioContext.currentTime+r):e.start(this.sharedAudioContext.currentTime,-r)};getAudioPlaybackTime(){if(!this.sharedAudioContext)throw Error("Shared audio context not found");return T({audioSyncAnchor:this.audioSyncAnchor,currentTime:this.sharedAudioContext.currentTime,playbackRate:this.playbackRate*this.globalPlaybackRate})}setPlaybackTime(e,t){this.sharedAudioContext&&(this.audioSyncAnchor=this.sharedAudioContext.currentTime-e/t)}setVideoFrameCallback(e){this.onVideoFrameCallback=e}drawDebugOverlay=()=>{this.debugOverlay&&this.context&&this.canvas&&S({context:this.context,audioTime:this.sharedAudioContext?.currentTime??null,audioContextState:this.sharedAudioContext?.state??null,audioSyncAnchor:this.audioSyncAnchor,audioIteratorManager:this.audioIteratorManager,playing:this.playing,videoIteratorManager:this.videoIteratorManager})}}var M=({onError:e,error:t,disallowFallback:r,isClientSideRendering:i,clientSideError:a})=>{let n=e?.(t);return i?["fail",a]:n?[n,t]:r?["fail",t]:["fallback",t]},F=({loop:e,mediaDurationInSeconds:t,playbackRate:r,trimAfter:n,trimBefore:s})=>{let{durationInFrames:o,fps:l}=(0,i.Bk)();return(0,a.useMemo)(()=>{if(!e||!t)return;let a=i.Xp.calculateMediaDuration({mediaDurationInFrames:t*l,playbackRate:r,trimAfter:n,trimBefore:s});return{numberOfTimes:o/a,startOffset:0,durationInFrames:a}},[o,l,e,t,r,n,s])},B=({volume:e,mediaVolume:t,src:r,mediaType:n,playbackRate:s,displayName:o,stack:l,showInTimeline:c,premountDisplay:d,postmountDisplay:u,loopDisplay:h,trimBefore:f,trimAfter:m})=>{let p=(0,a.useContext)(i.Xp.SequenceContext),g=i.Xp.useMediaStartsAt(),{registerSequence:y,unregisterSequence:b}=(0,a.useContext)(i.Xp.SequenceManager),[k]=(0,a.useState)(()=>String(Math.random())),[w]=(0,a.useState)(()=>String(Math.random())),v=(0,i.UC)(),{volumes:x,duration:T,doesVolumeChange:S,nonce:C,rootId:P,isStudio:I,finalDisplayName:E}=i.Xp.useBasicMediaInTimeline({volume:e,mediaVolume:t,mediaType:n,src:r,displayName:o,trimBefore:f,trimAfter:m,playbackRate:s});return(0,a.useEffect)(()=>{if(!r)throw Error("No src passed");if(!I&&window.process?.env?.NODE_ENV!=="test"||!c)return;let e=h?Math.floor(v/h.durationInFrames):0;return h&&y({type:"sequence",premountDisplay:d,postmountDisplay:u,parent:p?.id??null,displayName:E,rootId:P,showInTimeline:!0,nonce:C,loopDisplay:h,stack:l,from:0,duration:T,id:k}),y({type:n,src:r,id:w,duration:h?.durationInFrames??T,from:h?e*h.durationInFrames:0,parent:h?k:p?.id??null,displayName:E,rootId:P,volume:x,showInTimeline:!0,nonce:C,startMediaFrom:0-g,doesVolumeChange:S,loopDisplay:void 0,playbackRate:s,stack:l,premountDisplay:null,postmountDisplay:null}),()=>{h&&b(k),b(w)}},[S,T,E,I,h,w,n,C,p?.id,s,u,d,y,P,k,c,r,l,g,b,x,v]),{id:w}},{useUnsafeVideoConfig:L,Timeline:U,SharedAudioContext:R,useMediaMutedState:D,useMediaVolumeState:N,useFrameForVolumeProp:_,evaluateVolume:z,warnAboutTooHighVolume:O,usePreload:V,SequenceContext:$}=i.Xp,j=({src:e,playbackRate:t,logLevel:r,muted:n,volume:s,loopVolumeCurveBehavior:o,loop:l,trimAfter:d,trimBefore:u,name:h,showInTimeline:f,stack:m,disallowFallbackToHtml5Audio:p,toneFrequency:g,audioStreamIndex:y,fallbackHtml5AudioProps:b,onError:k})=>{let w=L(),v=(0,i.UC)(),x=(0,a.useRef)(null),T=(0,a.useRef)(u),S=(0,a.useRef)(d),[C,P]=(0,a.useState)(!1),[I,E]=(0,a.useState)(!1),[j]=U.usePlayingState(),H=(0,a.useContext)(i.Xp.TimelineContext).playbackRate,q=(0,a.useContext)(R),K=(0,i.Fx)(),[W]=D(),[X]=N(),[Q,J]=(0,a.useState)(null),Z=z({frame:_(o??"repeat"),volume:s,mediaVolume:X});if(O(Z),!w)throw Error("No video config found");if(!e)throw TypeError("No `src` was passed to <NewAudioForPreview>.");let G=v/w.fps,Y=(0,a.useRef)(G);Y.current=G;let ee=V(e),et=(0,a.useContext)($),er=!!et?.premounting,ei=!!et?.postmounting,ea=F({loop:l,mediaDurationInSeconds:Q,playbackRate:t,trimAfter:d,trimBefore:u});B({volume:s,mediaVolume:X,mediaType:"audio",src:e,playbackRate:t,displayName:h??null,stack:m,showInTimeline:f,premountDisplay:et?.premountDisplay??null,postmountDisplay:et?.postmountDisplay??null,loopDisplay:ea,trimAfter:d,trimBefore:u});let en=(0,a.useContext)(i.Xp.BufferingContextReact);if(!en)throw Error("useMediaPlayback must be used inside a <BufferingContext>");let es=i.Xp.useIsPlayerBuffering(en),eo=(0,a.useRef)(j&&!es),el=(0,a.useRef)(er),ec=(0,a.useRef)(ei),ed=(0,a.useRef)(H),eu=(0,a.useRef)(t),eh=(0,a.useRef)(n);(0,a.useEffect)(()=>{if(q&&q.audioContext){try{let e=new A({src:ee,logLevel:r,sharedAudioContext:q.audioContext,loop:l,trimAfter:S.current,trimBefore:T.current,fps:w.fps,canvas:null,playbackRate:eu.current,audioStreamIndex:y??0,debugOverlay:!1,bufferState:K,isPostmounting:ec.current,isPremounting:el.current,globalPlaybackRate:ed.current,onVideoFrameCallback:null,playing:eo.current});x.current=e,e.initialize(Y.current,eh.current).then(e=>{if("disposed"===e.type)return;let t=(e,t)=>{let[a,n]=M({onError:k,error:e,disallowFallback:p,isClientSideRendering:!1,clientSideError:e});if("fail"===a)throw n;i.Xp.Log.warn({logLevel:r,tag:"@remotion/media"},t),E(!0)};if("unknown-container-format"===e.type){t(Error(`Unknown container format ${ee}.`),`Unknown container format for ${ee} (Supported formats: https://www.remotion.dev/docs/mediabunny/formats), falling back to <Html5Audio>`);return}if("network-error"===e.type){t(Error(`Network error fetching ${ee}.`),`Network error fetching ${ee}, falling back to <Html5Audio>`);return}if("cannot-decode"===e.type){t(Error(`Cannot decode ${ee}.`),`Cannot decode ${ee}, falling back to <Html5Audio>`);return}if("no-tracks"===e.type){t(Error(`No video or audio tracks found for ${ee}.`),`No video or audio tracks found for ${ee}, falling back to <Html5Audio>`);return}"success"===e.type&&(P(!0),J(e.durationInSeconds),i.Xp.Log.trace({logLevel:r,tag:"@remotion/media"},"[AudioForPreview] MediaPlayer initialized successfully"))}).catch(e=>{let[t,a]=M({onError:k,error:e,disallowFallback:p,isClientSideRendering:!1,clientSideError:e});if("fail"===t)throw a;i.Xp.Log.error({logLevel:r,tag:"@remotion/media"},"[AudioForPreview] Failed to initialize MediaPlayer",e),E(!0)})}catch(a){let[e,t]=M({error:a,onError:k,disallowFallback:p,isClientSideRendering:!1,clientSideError:a});if("fail"===e)throw t;i.Xp.Log.error({logLevel:r,tag:"@remotion/media"},"[AudioForPreview] MediaPlayer initialization failed",t),E(!0)}return()=>{x.current&&(i.Xp.Log.trace({logLevel:r,tag:"@remotion/media"},"[AudioForPreview] Disposing MediaPlayer"),x.current.dispose(),x.current=null),P(!1),E(!1)}}},[ee,r,q,Y,l,w.fps,y,p,K,k]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&(j&&!es?e.play(Y.current):e.pause())},[es,r,j]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setTrimBefore(u,Y.current)},[u,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setTrimAfter(d,Y.current)},[d,C]);let ef=n||W||Z<=0;return((0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setMuted(ef)},[ef,C]),(0,a.useEffect)(()=>{let e=x.current;e&&C&&e.setVolume(Z)},[Z,C]),(0,a.useEffect)(()=>{let e=x.current;e&&C&&e.setPlaybackRate(t)},[t,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setGlobalPlaybackRate(H)},[H,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setFps(w.fps)},[w.fps,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setLoop(l)},[l,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setIsPremounting(er)},[er,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&e.setIsPostmounting(ei)},[ei,C]),(0,a.useLayoutEffect)(()=>{let e=x.current;e&&C&&(e.seekTo(G).catch(()=>{}),i.Xp.Log.trace({logLevel:r,tag:"@remotion/media"},`[AudioForPreview] Updating target time to ${G.toFixed(3)}s`))},[G,r,C]),I&&!p)?(0,c.jsx)(i.fP,{src:e,muted:n,volume:s,startFrom:u,endAt:d,playbackRate:t,loopVolumeCurveBehavior:o,name:h,loop:l,showInTimeline:f,stack:m??void 0,toneFrequency:g,audioStreamIndex:y,pauseWhenBuffering:b?.pauseWhenBuffering,crossOrigin:b?.crossOrigin,...b}):null},H=({loop:e,src:t,logLevel:r,muted:n,name:s,volume:o,loopVolumeCurveBehavior:l,playbackRate:d,trimAfter:u,trimBefore:h,showInTimeline:f,stack:p,disallowFallbackToHtml5Audio:g,toneFrequency:y,audioStreamIndex:b,fallbackHtml5AudioProps:k,onError:w})=>{let v=V(t),x=i.Xp.useLogLevel(),T=(0,i.UC)(),S=(0,i.Bk)(),C=T/S.fps;return(0,a.useMemo)(()=>null!==m({unloopedTimeInSeconds:C,playbackRate:d??1,loop:e??!1,trimBefore:h,trimAfter:u,mediaDurationInSeconds:1/0,fps:S.fps,ifNoMediaDuration:"infinity",src:t}),[C,e,d,t,u,h,S.fps])?(0,c.jsx)(j,{audioStreamIndex:b??0,src:v,playbackRate:d??1,logLevel:r??x,muted:n??!1,volume:o??1,loopVolumeCurveBehavior:l??"repeat",loop:e??!1,trimAfter:u,trimBefore:h,name:s,showInTimeline:f??!0,stack:p,disallowFallbackToHtml5Audio:g??!1,toneFrequency:y,onError:w,fallbackHtml5AudioProps:k}):null},q=()=>{let e=[],t={};return{addFrame:r=>{e.push(r.timestamp),t[r.timestamp]=r},clearBeforeThreshold:r=>{for(let i of e.slice())if(i+t[i].duration<r){if(i===e[e.length-1])continue;t[i].close(),delete t[i],e.splice(e.indexOf(i),1)}},deleteAll:()=>{for(let r of e)t[r].close(),delete t[r];e.length=0},getSamples:(r,i)=>{let a=[];for(let n=0;n<e.length;n++){let s=t[e[n]];if(!(s.timestamp+s.duration-1e-10<=r)){if(s.timestamp>=r+i-1e-10)break;a.push(s)}}return a},getOldestTimestamp:()=>e[0],getNewestTimestamp:()=>{if(0===e.length)return null;let r=t[e[e.length-1]];return r.timestamp+r.duration},getOpenTimestamps:()=>e}},K={},W=(e,t)=>{!K[e]&&(K[e]=!0,i.Xp.Log.warn({logLevel:t,tag:"@remotion/media"},`Audio from ${e} will need to be read from the beginning. https://www.remotion.dev/docs/media/support#matroska-limitation`))},X=({audioSampleSink:e,isMatroska:t,startTimestamp:r,src:a,actualMatroskaTimestamps:n,logLevel:s})=>{let o=e.samples(t?0:Math.max(0,r-1.5));t&&W(a,s);let l=null,c=q(),d=Date.now(),u=async()=>{d=Date.now();let{value:e,done:t}=await o.next();if(t)return l=c.getNewestTimestamp(),null;let r=n.getRealTimestamp(e.timestamp);return null!==r&&r!==e.timestamp&&e.setTimestamp(r),n.observeTimestamp(e.timestamp),n.observeTimestamp(e.timestamp+e.duration),c.addFrame(e),e},h=async(e,t)=>{if(d=Date.now(),null!==l&&e>l)return c.clearBeforeThreshold(l-.2),[];let r=c.getSamples(e,t),i=c.getNewestTimestamp();if(null!==i&&i>=e+t-1e-10)return r;for(;;){let i=await u(),a=null===l?e:Math.min(e,l);if(c.clearBeforeThreshold(a-.2),null===i)break;if(!(i.timestamp+i.duration-1e-10<=e)){if(i.timestamp>=e+t-1e-10)break;r.push(i)}}return r},f=Promise.resolve([]);return{src:a,getSamples:(e,t)=>f=f.then(()=>h(e,t)),waitForCompletion:async()=>(await f,!0),canSatisfyRequestedTime:e=>{let t=c.getOldestTimestamp()??r;return null!==l&&e>l||t<e&&10>Math.abs(t-e)},logOpenFrames:()=>{let e=c.getOpenTimestamps();if(e.length>0){let t=e[0],r=e[e.length-1];i.Xp.Log.verbose({logLevel:s,tag:"@remotion/media"},"Open audio samples for src",a,`${t.toFixed(3)}...${r.toFixed(3)}`)}},getCacheStats:()=>({count:c.getOpenTimestamps().length,size:c.getOpenTimestamps().reduce((e,t)=>e+t,0)}),getLastUsed:()=>d,prepareForDeletion:()=>{c.deleteAll(),o.return().then(e=>{e.value&&e.value.close()}),l=null},startTimestamp:r,clearBeforeThreshold:c.clearBeforeThreshold,getOldestTimestamp:c.getOldestTimestamp,getNewestTimestamp:c.getNewestTimestamp}},Q=e=>0===e.length?"(none)":1===e.length?e[0].toFixed(3):`${e[0].toFixed(3)}...${e[e.length-1].toFixed(3)}`,J=e=>null===e.format?e.codedHeight*e.codedWidth*4:e.allocationSize(),Z=async({logLevel:e,src:t,videoSampleSink:r,initialTimestampRequest:a})=>{let n=r.samples(g(a)),s={},o=[],l=!1,c=Date.now(),d=0,u=e=>{d-=J(s[e]),o.splice(o.indexOf(e),1),s[e].close(),delete s[e]},h=({logLevel:e,timestampInSeconds:r})=>{let a=[];for(let e of o.slice()){if(l&&e===o[o.length-1]||!s[e])continue;let{duration:t}=s[e];e+t<r&&(u(e),a.push(e))}a.length>0&&i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},`Deleted ${a.length} frame${1===a.length?"":"s"} ${Q(a)} for src ${t} because it is lower than ${r}. Remaining: ${Q(o)}`)},f=e=>{let t=o[o.length-1];if(!t)return!1;let r=s[t];return!r||g(r.timestamp+r.duration)>g(e)},m=(e,t)=>{s[e.timestamp]&&u(e.timestamp),s[e.timestamp]=e,o.push(e.timestamp),d+=J(e),c=Date.now(),i.Xp.Log.trace({logLevel:t,tag:"@remotion/media"},`Added frame at ${e.timestamp}sec to bank`)},p=async(t,r,i)=>{for(;!f(t);){let a=await n.next();if(a.value&&m(a.value,r),a.done){l=!0;break}h({logLevel:e,timestampInSeconds:t-G(i)})}c=Date.now()},y=async(t,r)=>{c=Date.now();let i=t;l&&g(i)>g(o[o.length-1])&&(i=o[o.length-1]),await p(i,e,r);for(let e=o.length-1;e>=0;e--){let t=s[o[e]];if(!t)return null;if(g(t.timestamp)<=g(i)||.001>=Math.abs(t.timestamp-i))return t}return s[o[0]]??null},b=async(e,t)=>await y(e,t)!==null,k=Promise.resolve(void 0),w=await n.next();if(!w.value)throw Error("No first frame found");let v=w.value.timestamp;i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},`Creating keyframe bank from ${v}sec`),m(w.value,e);let x=()=>{if(0===o.length)return null;let e=o[0],t=o[o.length-1],r=s[t];return{firstTimestamp:e,lastTimestamp:t+r.duration}};return{getFrameFromTimestamp:(e,t)=>k=k.then(()=>y(e,t)),prepareForDeletion:(e,t)=>{let r=x();r&&i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},`Preparing for deletion (${t}) of keyframe bank from ${r?.firstTimestamp}sec to ${r?.lastTimestamp}sec`);let a=0;for(let e of o.slice())s[e]&&(u(e),a++);return n.return(),o.length=0,{framesDeleted:a}},hasTimestampInSecond:(e,t)=>k=k.then(()=>b(e,t)),addFrame:m,deleteFramesBeforeTimestamp:h,src:t,getOpenFrameCount:()=>({size:d,timestamps:o}),getLastUsed:()=>c,canSatisfyTimestamp:e=>{if(0===o.length)return!1;let t=g(e),r=g(o[0]),i=g(o[o.length-1]);return!!l&&t>i||(t<r?r===v&&t>=a:!(t-3>i))},getRangeOfTimestamps:x}},G=e=>6/e,Y=(()=>{let e={},t=({src:t,bank:r})=>{e[t]=e[t]??[],e[t].push(r)},r=t=>{let r=0,a=0;for(let n in e)for(let s of e[n]){let{size:e,timestamps:o}=s.getOpenFrameCount();r+=o.length,a+=e,0!==e&&i.Xp.Log.verbose({logLevel:t,tag:"@remotion/media"},`Open frames for src ${n}: ${Q(o)}`)}i.Xp.Log.verbose({logLevel:t,tag:"@remotion/media"},`Video cache stats: ${r} open frames, ${a} bytes`)},a=()=>{let t=null,r=null,i=0;for(let a in e)for(let n of e[a]){let s=e[a].indexOf(n),o=n.getLastUsed();(null===t||o<t)&&(t=o,r={src:a,bank:n,index:s}),i++}if(!r)throw Error("No keyframe bank found");return{mostInThePastBank:r,numberOfBanks:i}},n=t=>{let{mostInThePastBank:{bank:r,src:n,index:s},numberOfBanks:o}=a();if(o<2)return{finish:!0};if(r){let a=r.getRangeOfTimestamps(),{framesDeleted:o}=r.prepareForDeletion(t,"deleted oldest keyframe bank to stay under max cache size");e[n].splice(s,1),a&&i.Xp.Log.verbose({logLevel:t,tag:"@remotion/media"},`Deleted ${o} frames for src ${n} from ${a?.firstTimestamp}sec to ${a?.lastTimestamp}sec to free up memory.`)}return{finish:!1}},s=(e,t)=>{let r=et(),a=0;for(;r.totalSize>t&&a<3;){let{finish:s}=n(e);if(s)break;i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},"Deleted oldest keyframe bank to stay under max cache size",(r.totalSize/1024/1024).toFixed(1),"out of",(t/1024/1024).toFixed(1)),r=et(),a++}r.totalSize>t&&a>=3&&i.Xp.Log.warn({logLevel:e,tag:"@remotion/media"},`Exceeded max cache size after 3 attempts. Remaining cache size: ${(r.totalSize/1024/1024).toFixed(1)} MB, target was ${(t/1024/1024).toFixed(1)} MB.`)},o=({timestampInSeconds:t,src:a,logLevel:n,fps:s})=>{let o=t-G(s);if(!e[a])return;let l=e[a];for(let t of l){let r=t.getRangeOfTimestamps();if(r){if(r.lastTimestamp<o){t.prepareForDeletion(n,"cleared before threshold "+o),i.Xp.Log.verbose({logLevel:n,tag:"@remotion/media"},`[Video] Cleared frames for src ${a} from ${r.firstTimestamp}sec to ${r.lastTimestamp}sec`);let s=l.indexOf(t);delete e[a][s]}else t.deleteFramesBeforeTimestamp({timestampInSeconds:o,logLevel:n})}}e[a]=e[a].filter(e=>void 0!==e),r(n)},l=async({timestamp:r,videoSampleSink:a,src:n,logLevel:s})=>{let o=e[n]??[],l=o?.find(e=>e.canSatisfyTimestamp(r));if(!l){i.Xp.Log.trace({logLevel:s,tag:"@remotion/media"},`Creating new keyframe bank for src ${n} at timestamp ${r}`);let e=await Z({videoSampleSink:a,logLevel:s,src:n,initialTimestampRequest:r});return t({src:n,bank:e}),e}if(l.canSatisfyTimestamp(r))return i.Xp.Log.trace({logLevel:s,tag:"@remotion/media"},`Keyframe bank exists and satisfies timestamp ${r}`),l;i.Xp.Log.verbose({logLevel:s,tag:"@remotion/media"},`Keyframe bank exists but frame at time ${r} does not exist anymore.`),l.prepareForDeletion(s,"already existed but evicted"),e[n]=e[n].filter(e=>e!==l);let c=await Z({videoSampleSink:a,initialTimestampRequest:r,logLevel:s,src:n});return t({src:n,bank:c}),c},c=async({timestamp:e,videoSampleSink:t,src:r,logLevel:i,maxCacheSize:a,fps:n})=>(s(i,a),o({timestampInSeconds:e,src:r,logLevel:i,fps:n}),await l({timestamp:e,videoSampleSink:t,src:r,logLevel:i})),d=Promise.resolve(void 0);return{requestKeyframeBank:({timestamp:e,videoSampleSink:t,src:r,logLevel:i,maxCacheSize:a,fps:n})=>d=d.then(()=>c({timestamp:e,videoSampleSink:t,src:r,logLevel:i,maxCacheSize:a,fps:n})),getCacheStats:()=>{let t=0,r=0;for(let i in e)for(let a of e[i]){let{timestamps:e,size:i}=a.getOpenFrameCount();if(t+=e.length,r+=i,0===i)continue}return{count:t,totalSize:r}},clearAll:t=>{for(let r of Object.keys(e)){for(let i of e[r])i.prepareForDeletion(t,"clearAll");e[r]=[]}e={}}}})(),ee=(()=>{let e=[],t=({timeInSeconds:t,src:r,audioSampleSink:i,isMatroska:a,actualMatroskaTimestamps:n,logLevel:s})=>{let o=X({audioSampleSink:i,isMatroska:a,startTimestamp:t,src:r,actualMatroskaTimestamps:n,logLevel:s});return e.push(o),o},r=()=>{let t=null,r=null;for(let i of e){let e=i.getLastUsed();(null===t||e<t)&&(t=e,r=i)}return r},a=()=>{let t=r();t&&(t.prepareForDeletion(),e.splice(e.indexOf(t),1))},n=t=>{let r=new Set;for(let a=0;a<e.length;a++){let n=e[a],s=`${n.src}-${n.getOldestTimestamp()}-${n.getNewestTimestamp()}`;r.has(s)&&(n.prepareForDeletion(),e.splice(e.indexOf(n),1),i.Xp.Log.verbose({logLevel:t,tag:"@remotion/media"},`Deleted duplicate iterator for ${n.src}`)),r.add(s)}},s=async({src:r,timeInSeconds:s,audioSampleSink:o,isMatroska:l,actualMatroskaTimestamps:c,logLevel:d,maxCacheSize:u})=>{let h=0;for(;(await et()).totalSize>u&&h<3;)a(),h++;for(let t of((await et()).totalSize>u&&h>=3&&i.Xp.Log.warn({logLevel:d,tag:"@remotion/media"},`Audio cache: Exceeded max cache size after 3 attempts. Still ${(await et()).totalSize} bytes used, target was ${u} bytes.`),e))if(t.src===r&&await t.waitForCompletion()&&t.canSatisfyRequestedTime(s))return t;for(let t=0;t<e.length;t++){let i=e[t];i.src===r&&i.startTimestamp===s&&(i.prepareForDeletion(),e.splice(e.indexOf(i),1))}return n(d),t({src:r,timeInSeconds:s,audioSampleSink:o,isMatroska:l,actualMatroskaTimestamps:c,logLevel:d})},o=Promise.resolve(void 0);return{getIterator:({src:e,timeInSeconds:t,audioSampleSink:r,isMatroska:i,actualMatroskaTimestamps:a,logLevel:n,maxCacheSize:l})=>o=o.then(()=>s({src:e,timeInSeconds:t,audioSampleSink:r,isMatroska:i,actualMatroskaTimestamps:a,logLevel:n,maxCacheSize:l})),getCacheStats:()=>{let t=0,r=0;for(let i of e){let{count:e,size:a}=i.getCacheStats();t+=e,r+=a}return{count:t,totalSize:r}},getIteratorMostInThePast:r,logOpenFrames:()=>{for(let t of e)t.logOpenFrames()},deleteDuplicateIterators:n}})(),et=()=>{let e=Y.getCacheStats(),t=ee.getCacheStats();return{count:e.count+t.count,totalSize:e.totalSize+t.totalSize}},er=e=>{if("undefined"!=typeof window&&void 0!==window.remotion_mediaCacheSizeInBytes&&null!==window.remotion_mediaCacheSizeInBytes)return window.remotion_mediaCacheSizeInBytes<0xf000000&&(0,i.zo)(Error(`The minimum value for the "mediaCacheSizeInBytes" prop is 240MB (251658240), got: ${window.remotion_mediaCacheSizeInBytes}`)),window.remotion_mediaCacheSizeInBytes>2097152e4&&(0,i.zo)(Error(`The maximum value for the "mediaCacheSizeInBytes" prop is 20GB (20971520000), got: ${window.remotion_mediaCacheSizeInBytes}`)),i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},`Using cache size set using "mediaCacheSizeInBytes": ${(window.remotion_mediaCacheSizeInBytes/1024/1024).toFixed(1)} MB`),window.remotion_mediaCacheSizeInBytes;if("undefined"!=typeof window&&void 0!==window.remotion_initialMemoryAvailable&&null!==window.remotion_initialMemoryAvailable){let t=window.remotion_initialMemoryAvailable/2;return t<524288e3?(i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},"Using cache size set based on minimum value of 500MB (which is more than half of the available system memory!)"),524288e3):t>2097152e4?(i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},"Using cache size set based on maximum value of 20GB (which is less than half of the available system memory)"),2097152e4):(i.Xp.Log.verbose({logLevel:e,tag:"@remotion/media"},`Using cache size set based on available memory (50% of available memory): ${(t/1024/1024).toFixed(1)} MB`),t)}return 1e9},ei=null,ea=e=>null!==ei?ei:ei=er(e),en=e=>{let t=a.useContext(i.Xp.MaxMediaCacheSizeContext);return null===t?ea(e):t},es=(e,t)=>{if(1!==t)for(let r=0;r<e.length;r++){let i=e[r]*t;i<-32768?e[r]=-32768:i>32767?e[r]=32767:e[r]=i}},eo=e=>e%1<1e-7?Math.floor(e):e%1>.9999999?Math.ceil(e):e,el=({srcNumberOfChannels:e,sourceChannels:t,destination:r,targetFrames:i,chunkSize:a})=>{let n=(r,i,a)=>{let n=eo(r),s=eo(i),o=Math.floor(n),l=Math.ceil(n),c=n-o,d=s-Math.floor(s),u=Math.floor(s),h=0,f=0;c>0&&(h+=t[o*e+a]*(1-c),f+=1-c);for(let r=l;r<u;r++)h+=t[r*e+a],f+=1;return d>0&&(h+=t[u*e+a]*d,f+=d),h/f};for(let t=0;t<i;t++){let i=t*a,s=i+a;if(2===e)for(let a=0;a<e;a++)r[t*e+a]=n(i,s,a);if(1===e){let e=n(i,s,0);r[2*t+0]=e,r[2*t+1]=e}else if(4===e){let e=n(i,s,0),a=n(i,s,1),o=n(i,s,2),l=n(i,s,3),c=.5*(e+o),d=.5*(a+l);r[2*t+0]=c,r[2*t+1]=d}else if(6===e){let e=n(i,s,0),a=n(i,s,1),o=n(i,s,2),l=n(i,s,3),c=n(i,s,4),d=Math.sqrt(.5),u=e+d*(o+l),h=a+d*(o+c);r[2*t+0]=u,r[2*t+1]=h}else for(let a=0;a<e;a++)r[2*t+a]=n(i,s,a)}},ec=({behavior:e,loop:t,assetDurationInSeconds:r,fps:i,frame:a,startsAt:n})=>t&&"extend"!==e?a%(Math.floor(r*i)-n)+n:a+n,ed=e=>{let t=Math.abs(e%1);return t<1e-7?e<0?Math.ceil(e):Math.floor(e):t>.9999999?e<0?Math.floor(e):Math.ceil(e):e},eu=e=>Math.ceil(ed(e)),eh=({audioData:e,trimStartInSeconds:t,trimEndInSeconds:r,playbackRate:i,audioDataTimestamp:a,isLast:n})=>{let{numberOfChannels:s,sampleRate:o,numberOfFrames:l}=e,c=o/48e3,d=Math.floor(ed(t*e.sampleRate)),u=l-r*e.sampleRate-d,h=n?eu(u):Math.round(u),f=n?eu(u/c/i):Math.round(u/c/i);if(0===f)throw Error("Cannot resample - the given sample rate would result in less than 1 sample");let m=new Int16Array(s*h);e.copyTo(m,{planeIndex:0,format:"s16",frameOffset:d,frameCount:h});let p=new Int16Array(2*f),g=d/e.sampleRate*1e6;return f===h&&2===s&&1===i?{data:m,numberOfFrames:f,timestamp:1e6*a+ed(g),durationInMicroSeconds:ed(f/48e3*1e6)}:(el({srcNumberOfChannels:s,sourceChannels:m,destination:p,targetFrames:f,chunkSize:h/f}),{data:p,numberOfFrames:f,timestamp:1e6*a+ed(g),durationInMicroSeconds:ed(f/48e3*1e6)})},ef=e=>{let t=0,r=0,{timestamp:i}=e[0];for(let i of e)t+=i.numberOfFrames,r+=i.durationInMicroSeconds;let a=new Int16Array(2*t),n=0;for(let t of e)a.set(t.data,n),n+=t.data.length;return{data:a,numberOfFrames:t,timestamp:ed(i),durationInMicroSeconds:ed(r)}},em=null,ep=()=>null!==new OffscreenCanvas(1,1).getContext("webgl2"),eg=()=>null!==em?em:em=ep(),ey=e=>{let t=[];return{observeTimestamp:r=>{e&&t.push(r)},getRealTimestamp:r=>e?t.find(e=>.001>Math.abs(r-e))??null:r}},eb=()=>null,ek=async e=>{try{return await e.getFormat()}catch(e){if(C(e))return"network-error";return null}},ew=async e=>{let t=new n.p({formats:o.XE,source:new s.Ts(e,{getRetryDelay:eb})}),r=await ek(t),i=r===o.BN||r===o.q6,a=async()=>{if("network-error"===r)return"network-error";if(null===r)return"unknown-container-format";let e=await t.getPrimaryVideoTrack();if(!e)return"no-video-track";if(!await e.canDecode())return"cannot-decode";let i=new l.lc(e),a=new l.kQ(e),n=await a.getFirstPacket({verifyKeyPackets:!0});return n?.sideData.alpha&&!eg()?"cannot-decode-alpha":{sampleSink:i}},c=null,d=()=>c||(c=a()),u={},h=async e=>{if(null===r)return"unknown-container-format";if("network-error"===r)return"network-error";let i=(await t.getAudioTracks())[e];return i?await i.canDecode()?{sampleSink:new l.qw(i)}:"cannot-decode-audio":"no-audio-track"},f=e=>(u[e]||(u[e]=h(e)),u[e]);return{getVideo:()=>d(),getAudio:e=>f(e),actualMatroskaTimestamps:ey(i),isMatroska:i,getDuration:()=>t.computeDuration()}},ev={},ex=(e,t)=>{let r=ev[e];return r||(i.Xp.Log.verbose({logLevel:t,tag:"@remotion/media"},`Sink for ${e} was not found, creating new sink`),r=ew(e),ev[e]=r),r},eT=async({src:e,timeInSeconds:t,durationInSeconds:r,logLevel:i,loop:a,playbackRate:n,audioStreamIndex:s,trimBefore:o,trimAfter:l,fps:c,maxCacheSize:d})=>{let{getAudio:u,actualMatroskaTimestamps:h,isMatroska:f,getDuration:p}=await ex(e,i),g=null;a&&(g=await p());let y=await u(s);if("network-error"===y)return"network-error";if("no-audio-track"===y)return{data:null,durationInSeconds:null};if("cannot-decode-audio"===y)return"cannot-decode";if("unknown-container-format"===y)return"unknown-container-format";let b=m({loop:a,mediaDurationInSeconds:g,unloopedTimeInSeconds:t,src:e,trimAfter:l,playbackRate:n,trimBefore:o,fps:c,ifNoMediaDuration:"fail"});if(null===b)return{data:null,durationInSeconds:g};try{let t=await ee.getIterator({src:e,timeInSeconds:b,audioSampleSink:y.sampleSink,isMatroska:f,actualMatroskaTimestamps:h,logLevel:i,maxCacheSize:d}),a=r*n,s=await t.getSamples(b,a);ee.logOpenFrames();let o=[];for(let e=0;e<s.length;e++){let t=s[e];if(Math.abs(t.timestamp-(b+a))*t.sampleRate<1||t.timestamp+t.duration<=b)continue;let r=0===e,i=e===s.length-1,l=t.toAudioData(),c=0,d=0,u=null;if(r&&(c=ed(b-t.timestamp))<0){let e=Math.ceil(ed(-(48e3*c)));u={data:new Int16Array(2*e),numberOfFrames:e,timestamp:1e6*b,durationInMicroSeconds:e/48e3*1e6},c=0}i&&(d=Math.max(0,t.timestamp+t.duration-(b+a)));let h=eh({audioData:l,trimStartInSeconds:c,trimEndInSeconds:d,playbackRate:n,audioDataTimestamp:t.timestamp,isLast:i});l.close(),0!==h.numberOfFrames&&(u&&o.push(u),o.push(h))}if(0===o.length)return{data:null,durationInSeconds:g};return{data:ef(o),durationInSeconds:g}}catch(e){if(C(e))return"network-error";if(e.message.includes("Unsupported configuration"))return"cannot-decode";throw e}},eS=Promise.resolve(void 0),eC=e=>eS=eS.then(()=>eT(e)),eP=async({src:e,timeInSeconds:t,logLevel:r,loop:a,trimAfter:n,trimBefore:s,playbackRate:o,fps:l,maxCacheSize:c})=>{let d=await ex(e,r),[u,h]=await Promise.all([d.getVideo(),a?d.getDuration():Promise.resolve(null)]),f=a?h:null;if("no-video-track"===u)throw Error(`No video track found for ${e}`);if("cannot-decode"===u)return{type:"cannot-decode",durationInSeconds:f};if("unknown-container-format"===u)return{type:"unknown-container-format"};if("network-error"===u)return{type:"network-error"};if("cannot-decode-alpha"===u)return{type:"cannot-decode-alpha",durationInSeconds:f};let p=m({loop:a,mediaDurationInSeconds:f,unloopedTimeInSeconds:t,src:e,trimAfter:n,playbackRate:o,trimBefore:s,fps:l,ifNoMediaDuration:"fail"});if(null===p)return{type:"success",frame:null,rotation:0,durationInSeconds:await d.getDuration()};try{let t=await Y.requestKeyframeBank({videoSampleSink:u.sampleSink,timestamp:p,src:e,logLevel:r,maxCacheSize:c,fps:l});if(!t)return{type:"success",frame:null,rotation:0,durationInSeconds:await d.getDuration()};let i=await t.getFrameFromTimestamp(p,l),a=i?.rotation??0;return{type:"success",frame:i?.toVideoFrame()??null,rotation:a,durationInSeconds:await d.getDuration()}}catch(t){return i.Xp.Log.info({logLevel:r,tag:"@remotion/media"},`Error decoding ${e} at time ${p}: ${t}`,t),{type:"cannot-decode",durationInSeconds:f}}},eI=Promise.resolve(void 0),eE=e=>eI=eI.then(()=>eP(e)),eA=async({frame:e,rotation:t})=>{if(0===t){let t=await createImageBitmap(e);return e.close(),t}let r=90===t||270===t?e.displayHeight:e.displayWidth,i=90===t||270===t?e.displayWidth:e.displayHeight,a=new OffscreenCanvas(r,i),n=a.getContext("2d");if(!n)throw Error("Could not get 2d context");a.width=r,a.height=i,90===t?n.translate(r,0):180===t?n.translate(r,i):270===t&&n.translate(0,i),n.rotate(Math.PI/180*t),n.drawImage(e,0,0);let s=await createImageBitmap(a);return e.close(),s},eM=async({src:e,timeInSeconds:t,logLevel:r,durationInSeconds:i,playbackRate:a,includeAudio:n,includeVideo:s,loop:o,audioStreamIndex:l,trimAfter:c,trimBefore:d,fps:u,maxCacheSize:h})=>{try{let[f,m]=await Promise.all([s?eE({src:e,timeInSeconds:t,logLevel:r,loop:o,trimAfter:c,playbackRate:a,trimBefore:d,fps:u,maxCacheSize:h}):null,n?eC({src:e,timeInSeconds:t,durationInSeconds:i,logLevel:r,loop:o,playbackRate:a,audioStreamIndex:l,trimAfter:c,fps:u,trimBefore:d,maxCacheSize:h}):null]);if(f?.type==="cannot-decode")return{type:"cannot-decode",durationInSeconds:f.durationInSeconds};if(f?.type==="unknown-container-format")return{type:"unknown-container-format"};if(f?.type==="cannot-decode-alpha")return{type:"cannot-decode-alpha",durationInSeconds:f.durationInSeconds};if(f?.type==="network-error")return{type:"network-error"};if("unknown-container-format"===m)return{type:"unknown-container-format"};if("network-error"===m)return{type:"network-error"};if("cannot-decode"===m)return{type:"cannot-decode",durationInSeconds:f?.type==="success"?f.durationInSeconds:null};return{type:"success",frame:f?.frame?await eA({frame:f.frame,rotation:f.rotation}):null,audio:m?.data??null,durationInSeconds:m?.durationInSeconds??null}}catch(e){if(C(e))return{type:"network-error"};throw e}},eF=e=>{e.postMessage({type:"main-tab-ready"});let t=0,r=setInterval(()=>{e.postMessage({type:"main-tab-ready"}),++t>30&&clearInterval(r)},300)},eB=null,eL=e=>eB||(eB=new Promise(t=>{let r=i=>{"main-tab-ready"===i.data.type&&(t(),e.removeEventListener("message",r))};e.addEventListener("message",r)}));!("undefined"!=typeof window&&window.remotion_broadcastChannel&&window.remotion_isMainTab)||(window.remotion_broadcastChannel.addEventListener("message",async e=>{let t=e.data;if("request"===t.type)try{let e=await eM({src:t.src,timeInSeconds:t.timeInSeconds,logLevel:t.logLevel,durationInSeconds:t.durationInSeconds,playbackRate:t.playbackRate,includeAudio:t.includeAudio,includeVideo:t.includeVideo,loop:t.loop,audioStreamIndex:t.audioStreamIndex,trimAfter:t.trimAfter,trimBefore:t.trimBefore,fps:t.fps,maxCacheSize:t.maxCacheSize});if("cannot-decode"===e.type){let r={type:"response-cannot-decode",id:t.id,durationInSeconds:e.durationInSeconds};window.remotion_broadcastChannel.postMessage(r);return}if("cannot-decode-alpha"===e.type){let r={type:"response-cannot-decode-alpha",id:t.id,durationInSeconds:e.durationInSeconds};window.remotion_broadcastChannel.postMessage(r);return}if("network-error"===e.type){let e={type:"response-network-error",id:t.id};window.remotion_broadcastChannel.postMessage(e);return}if("unknown-container-format"===e.type){let e={type:"response-unknown-container-format",id:t.id};window.remotion_broadcastChannel.postMessage(e);return}let{frame:r,audio:i,durationInSeconds:a}=e,n=r?await createImageBitmap(r):null;r&&r.close();let s={type:"response-success",id:t.id,frame:n,audio:i,durationInSeconds:a??null};window.remotion_broadcastChannel.postMessage(s)}catch(r){let e={type:"response-error",id:t.id,errorStack:r.stack??"No stack trace"};window.remotion_broadcastChannel.postMessage(e)}else throw Error("Invalid message: "+JSON.stringify(t))}),eF(window.remotion_broadcastChannel));var eU=async({src:e,timeInSeconds:t,logLevel:r,durationInSeconds:i,playbackRate:a,includeAudio:n,includeVideo:s,isClientSideRendering:o,loop:l,audioStreamIndex:c,trimAfter:d,trimBefore:u,fps:h,maxCacheSize:f})=>{let m;if(o||window.remotion_isMainTab)return eM({logLevel:r,src:e,timeInSeconds:t,durationInSeconds:i,playbackRate:a,includeAudio:n,includeVideo:s,loop:l,audioStreamIndex:c,trimAfter:d,trimBefore:u,fps:h,maxCacheSize:f});await eL(window.remotion_broadcastChannel);let p=crypto.randomUUID(),g=new Promise((e,t)=>{let r=i=>{let a=i.data;if(a&&"main-tab-ready"!==a.type&&a.id===p){if("response-success"===a.type){e({type:"success",frame:a.frame?a.frame:null,audio:a.audio?a.audio:null,durationInSeconds:a.durationInSeconds?a.durationInSeconds:null}),window.remotion_broadcastChannel.removeEventListener("message",r);return}if("response-error"===a.type){t(a.errorStack),window.remotion_broadcastChannel.removeEventListener("message",r);return}if("response-cannot-decode"===a.type){e({type:"cannot-decode",durationInSeconds:a.durationInSeconds}),window.remotion_broadcastChannel.removeEventListener("message",r);return}if("response-network-error"===a.type){e({type:"network-error"}),window.remotion_broadcastChannel.removeEventListener("message",r);return}if("response-unknown-container-format"===a.type){e({type:"unknown-container-format"}),window.remotion_broadcastChannel.removeEventListener("message",r);return}if("response-cannot-decode-alpha"===a.type){e({type:"cannot-decode-alpha",durationInSeconds:a.durationInSeconds}),window.remotion_broadcastChannel.removeEventListener("message",r);return}throw Error(`Invalid message: ${JSON.stringify(a)}`)}};window.remotion_broadcastChannel.addEventListener("message",r)});return window.remotion_broadcastChannel.postMessage({type:"request",src:e,timeInSeconds:t,id:p,logLevel:r,durationInSeconds:i,playbackRate:a,includeAudio:n,includeVideo:s,loop:l,audioStreamIndex:c,trimAfter:d,trimBefore:u,fps:h,maxCacheSize:f}),Promise.race([g.then(e=>(clearTimeout(m),e)),new Promise((r,i)=>{m=setTimeout(()=>{i(Error(`Timeout while extracting frame at time ${t}sec from ${e}`))},Math.max(3e3,window.remotion_puppeteerTimeout-5e3))})])},eR=({volume:e,playbackRate:t,src:r,muted:n,loopVolumeCurveBehavior:s,delayRenderRetries:o,delayRenderTimeoutInMilliseconds:l,logLevel:d,loop:u,fallbackHtml5AudioProps:h,audioStreamIndex:f,showInTimeline:m,style:p,name:g,disallowFallbackToHtml5Audio:y,toneFrequency:b,trimAfter:k,trimBefore:w,onError:v})=>{let x=i.Xp.useLogLevel(),T=d??x,S=(0,i.UC)(),C=i.Xp.useTimelinePosition(),P=i.Xp.useUnsafeVideoConfig(),{registerRenderAsset:I,unregisterRenderAsset:E}=(0,a.useContext)(i.Xp.RenderAssetManager),A=i.Xp.useMediaStartsAt(),F=(0,i.OK)();if(!P)throw Error("No video config found");if(!r)throw TypeError("No `src` was passed to <Audio>.");let{fps:B}=P,{delayRender:L,continueRender:U}=(0,i.dB)(),[R,D]=(0,a.useState)(!1),N=(0,a.useContext)(i.Xp.SequenceContext),_=(0,a.useMemo)(()=>`media-audio-${(0,i.yT)(r)}-${N?.cumulatedFrom}-${N?.relativeFrom}-${N?.durationInFrames}`,[r,N?.cumulatedFrom,N?.relativeFrom,N?.durationInFrames]),z=en(T),O=i.Xp.useAudioEnabled();return((0,a.useLayoutEffect)(()=>{let a=S/B,c=1/B,d=!!O&&!n;if(!d||R)return;let h=L(`Extracting audio for frame ${S}`,{retries:o??void 0,timeoutInMilliseconds:l??void 0});return eU({src:r,timeInSeconds:a,durationInSeconds:c,playbackRate:t??1,logLevel:T,includeAudio:d,includeVideo:!1,isClientSideRendering:F.isClientSideRendering,loop:u??!1,audioStreamIndex:f??0,trimAfter:k,trimBefore:w,fps:B,maxCacheSize:z}).then(t=>{let a=(e,t,r)=>{let[a,n]=M({onError:v,error:e,disallowFallback:y??!1,isClientSideRendering:F.isClientSideRendering,clientSideError:t});"fail"===a&&(0,i.zo)(n),i.Xp.Log.warn({logLevel:T,tag:"@remotion/media"},r),D(!0)};if("unknown-container-format"===t.type){a(Error(`Unknown container format ${r}.`),Error(`Cannot render audio "${r}": Unknown container format. See supported formats: https://www.remotion.dev/docs/mediabunny/formats`),`Unknown container format for ${r} (Supported formats: https://www.remotion.dev/docs/mediabunny/formats), falling back to <Html5Audio>`);return}if("cannot-decode"===t.type){a(Error(`Cannot decode ${r}.`),Error(`Cannot render audio "${r}": The audio could not be decoded by the browser.`),`Cannot decode ${r}, falling back to <Html5Audio>`);return}if("cannot-decode-alpha"===t.type)throw Error(`Cannot decode alpha component for ${r}, and 'disallowFallbackToHtml5Audio' was set. But this should never happen, since you used the <Audio> tag. Please report this as a bug.`);if("network-error"===t.type){a(Error(`Network error fetching ${r}.`),Error(`Cannot render audio "${r}": Network error while fetching the audio (possibly CORS).`),`Network error fetching ${r}, falling back to <Html5Audio>`);return}let{audio:n,durationInSeconds:o}=t,l=ec({behavior:s??"repeat",loop:u??!1,assetDurationInSeconds:o??0,fps:B,frame:S,startsAt:A}),c=i.Xp.evaluateVolume({volume:e,frame:l,mediaVolume:1});i.Xp.warnAboutTooHighVolume(c),n&&c>0&&(es(n.data,c),I({type:"inline-audio",id:_,audio:F.isClientSideRendering?n.data:Array.from(n.data),frame:C,timestamp:n.timestamp,duration:n.numberOfFrames/48e3*1e6,toneFrequency:b??1})),U(h)}).catch(e=>{(0,i.zo)(e)}),()=>{U(h),E(_)}},[C,U,L,o,l,y,F.isClientSideRendering,B,S,_,T,u,s,n,t,I,r,A,E,e,f,b,k,w,R,z,O,v]),R)?(0,c.jsx)(i.xN,{src:r,playbackRate:t,muted:n,loop:u,volume:e,delayRenderRetries:o,delayRenderTimeoutInMilliseconds:l,style:p,loopVolumeCurveBehavior:s,audioStreamIndex:f,useWebAudioApi:h?.useWebAudioApi,onError:h?.onError,toneFrequency:b,acceptableTimeShiftInSeconds:h?.acceptableTimeShiftInSeconds,name:g,showInTimeline:m}):null},{validateMediaProps:eD}=i.Xp,eN=e=>{let{name:t,stack:r,showInTimeline:a,...n}=e,s=(0,i.OK)();if("string"!=typeof e.src)throw TypeError(`The \`<Audio>\` tag requires a string for \`src\`, but got ${JSON.stringify(e.src)} instead.`);return(eD({playbackRate:e.playbackRate,volume:e.volume},"Audio"),s.isRendering)?(0,c.jsx)(eR,{...n}):(0,c.jsx)(H,{name:t,...n,stack:r??null})};i.Xp.addSequenceStackTraces(eN);var{useUnsafeVideoConfig:e_,Timeline:ez,SharedAudioContext:eO,useMediaMutedState:eV,useMediaVolumeState:e$,useFrameForVolumeProp:ej,evaluateVolume:eH,warnAboutTooHighVolume:eq,usePreload:eK,SequenceContext:eW,SequenceVisibilityToggleContext:eX}=i.Xp,eQ=({src:e,style:t,playbackRate:r,logLevel:n,className:s,muted:o,volume:l,loopVolumeCurveBehavior:d,onVideoFrame:u,showInTimeline:h,loop:f,name:m,trimAfter:p,trimBefore:g,stack:y,disallowFallbackToOffthreadVideo:b,fallbackOffthreadVideoProps:k,audioStreamIndex:w,debugOverlay:v,headless:x,onError:T})=>{let S=eK(e),C=(0,a.useRef)(null),P=e_(),I=(0,i.UC)(),E=(0,a.useRef)(null),L=(0,a.useRef)(g),U=(0,a.useRef)(p),R=(0,a.useRef)(u),[D,N]=(0,a.useState)(!1),[_,z]=(0,a.useState)(!1),[O]=ez.usePlayingState(),V=(0,a.useContext)(i.Xp.TimelineContext).playbackRate,$=(0,a.useContext)(eO),j=(0,i.Fx)(),[H]=eV(),[q]=e$(),[K,W]=(0,a.useState)(null),{hidden:X}=(0,a.useContext)(eX),Q=eH({frame:ej(d),volume:l,mediaVolume:q});eq(Q);let J=(0,a.useContext)(eW),Z=!!J?.premounting,G=!!J?.postmounting,Y=F({loop:f,mediaDurationInSeconds:K,playbackRate:r,trimAfter:p,trimBefore:g}),{id:ee}=B({volume:l,mediaType:"video",src:S,playbackRate:r,displayName:m??null,stack:y,showInTimeline:h,premountDisplay:J?.premountDisplay??null,postmountDisplay:J?.postmountDisplay??null,loopDisplay:Y,mediaVolume:q,trimAfter:p,trimBefore:g}),et=X[ee]??!1;if(!P)throw Error("No video config found");let er=I/P.fps,ei=(0,a.useRef)(er);ei.current=er;let ea=eK(S),en=(0,a.useContext)(i.Xp.BufferingContextReact);if(!en)throw Error("useMediaPlayback must be used inside a <BufferingContext>");let es=i.Xp.useIsPlayerBuffering(en),eo=(0,a.useRef)(O&&!es),el=(0,a.useRef)(Z),ec=(0,a.useRef)(G),ed=(0,a.useRef)(V),eu=(0,a.useRef)(r),eh=(0,a.useRef)(o);(0,a.useEffect)(()=>{if($){try{let e=new A({canvas:C.current,src:ea,logLevel:n,sharedAudioContext:$.audioContext,loop:f,trimAfter:U.current,trimBefore:L.current,fps:P.fps,playbackRate:eu.current,audioStreamIndex:w,debugOverlay:v,bufferState:j,isPremounting:el.current,isPostmounting:ec.current,globalPlaybackRate:ed.current,onVideoFrameCallback:R.current??null,playing:eo.current});E.current=e,e.initialize(ei.current,eh.current).then(e=>{if("disposed"===e.type)return;let t=(e,t)=>{let[r,a]=M({onError:T,error:e,disallowFallback:b,isClientSideRendering:!1,clientSideError:e});if("fail"===r)throw a;i.Xp.Log.warn({logLevel:n,tag:"@remotion/media"},t),z(!0)};if("unknown-container-format"===e.type){t(Error(`Unknown container format ${ea}.`),`Unknown container format for ${ea} (Supported formats: https://www.remotion.dev/docs/mediabunny/formats), falling back to <OffthreadVideo>`);return}if("network-error"===e.type){t(Error(`Network error fetching ${ea}.`),`Network error fetching ${ea}, falling back to <OffthreadVideo>`);return}if("cannot-decode"===e.type){t(Error(`Cannot decode ${ea}.`),`Cannot decode ${ea}, falling back to <OffthreadVideo>`);return}if("no-tracks"===e.type){t(Error(`No video or audio tracks found for ${ea}.`),`No video or audio tracks found for ${ea}, falling back to <OffthreadVideo>`);return}"success"===e.type&&(N(!0),W(e.durationInSeconds))}).catch(e=>{let[t,r]=M({onError:T,error:e,disallowFallback:b,isClientSideRendering:!1,clientSideError:e});if("fail"===t)throw r;i.Xp.Log.error({logLevel:n,tag:"@remotion/media"},"[VideoForPreview] Failed to initialize MediaPlayer",r),z(!0)})}catch(r){let[e,t]=M({error:r,onError:T,disallowFallback:b,isClientSideRendering:!1,clientSideError:r});if("fail"===e)throw t;i.Xp.Log.error({logLevel:n,tag:"@remotion/media"},"[VideoForPreview] MediaPlayer initialization failed",t),z(!0)}return()=>{E.current&&(i.Xp.Log.trace({logLevel:n,tag:"@remotion/media"},"[VideoForPreview] Disposing MediaPlayer"),E.current.dispose(),E.current=null),N(!1),z(!1)}}},[w,j,v,b,n,f,ea,$,P.fps,T]);let ef=(0,a.useMemo)(()=>[i.Xp.OBJECTFIT_CONTAIN_CLASS_NAME,s].filter(i.Xp.truthy).join(" "),[s]);(0,a.useEffect)(()=>{let e=E.current;e&&(O&&!es?e.play(ei.current):e.pause())},[es,O,n,D]),(0,a.useEffect)(()=>{let e=E.current;e&&D&&e.setTrimBefore(g,ei.current)},[g,D]),(0,a.useEffect)(()=>{let e=E.current;e&&D&&e.setTrimAfter(p,ei.current)},[p,D]);let em=et||o||H||Q<=0;(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setMuted(em)},[em,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setVolume(Q)},[Q,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setDebugOverlay(v)},[v,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setPlaybackRate(r)},[r,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setGlobalPlaybackRate(V)},[V,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setLoop(f)},[f,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setIsPremounting(Z)},[Z,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setIsPostmounting(G)},[G,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setFps(P.fps)},[P.fps,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&e.setVideoFrameCallback(u??null)},[u,D]),(0,a.useLayoutEffect)(()=>{let e=E.current;e&&D&&(e.seekTo(er).catch(()=>{}),i.Xp.Log.trace({logLevel:n,tag:"@remotion/media"},`[VideoForPreview] Updating target time to ${er.toFixed(3)}s`))},[er,n,D]);let ep=(0,a.useMemo)(()=>({...t,opacity:et?0:t?.opacity??1}),[et,t]);return _&&!b?(0,c.jsx)(i.kY,{src:S,style:ep,className:s,muted:o,volume:l,trimAfter:p,trimBefore:g,playbackRate:r,loopVolumeCurveBehavior:d,name:m,loop:f,showInTimeline:h,stack:y??void 0,...k}):x?null:(0,c.jsx)("canvas",{ref:C,width:P.width,height:P.height,style:ep,className:ef})},eJ=e=>{let t=(0,i.UC)(),r=(0,i.Bk)(),n=t/r.fps;return(0,a.useMemo)(()=>null!==m({unloopedTimeInSeconds:n,playbackRate:e.playbackRate,loop:e.loop,trimBefore:e.trimBefore,trimAfter:e.trimAfter,mediaDurationInSeconds:1/0,fps:r.fps,ifNoMediaDuration:"infinity",src:e.src}),[n,e.loop,e.playbackRate,e.src,e.trimAfter,e.trimBefore,r.fps])?(0,c.jsx)(eQ,{...e}):null},eZ=({volume:e,playbackRate:t,src:r,muted:n,loopVolumeCurveBehavior:s,delayRenderRetries:o,delayRenderTimeoutInMilliseconds:l,onVideoFrame:d,logLevel:u,loop:h,style:f,className:m,fallbackOffthreadVideoProps:p,audioStreamIndex:g,name:y,disallowFallbackToOffthreadVideo:b,stack:k,toneFrequency:w,trimAfterValue:v,trimBeforeValue:x,headless:T,onError:S})=>{if(!r)throw TypeError("No `src` was passed to <Video>.");let C=(0,i.UC)(),P=i.Xp.useTimelinePosition(),{fps:I}=(0,i.Bk)(),{registerRenderAsset:E,unregisterRenderAsset:A}=(0,a.useContext)(i.Xp.RenderAssetManager),F=i.Xp.useMediaStartsAt(),B=(0,a.useContext)(i.Xp.SequenceContext),L=(0,a.useMemo)(()=>`media-video-${(0,i.yT)(r)}-${B?.cumulatedFrom}-${B?.relativeFrom}-${B?.durationInFrames}`,[r,B?.cumulatedFrom,B?.relativeFrom,B?.durationInFrames]),U=(0,i.OK)(),{delayRender:R,continueRender:D,cancelRender:N}=(0,i.dB)(),_=(0,a.useRef)(null),[z,O]=(0,a.useState)(!1),V=i.Xp.useAudioEnabled(),$=i.Xp.useVideoEnabled(),j=en(u),[H,q]=(0,a.useState)(null);if(H)throw H;(0,a.useLayoutEffect)(()=>{if(!_.current&&!T||z)return;if(!_.current?.getContext&&!T)return q(Error("Canvas does not have .getContext() method available. This could be because <Video> was mounted inside an <svg> tag."));let a=C/I,c=1/I,f=R(`Extracting frame at time ${a}`,{retries:o??void 0,timeoutInMilliseconds:l??void 0});return eU({src:r,timeInSeconds:a,durationInSeconds:c,playbackRate:t,logLevel:u,includeAudio:!!V&&!n,includeVideo:$,isClientSideRendering:U.isClientSideRendering,loop:h,audioStreamIndex:g,trimAfter:v,trimBefore:x,fps:I,maxCacheSize:j}).then(t=>{let a=(e,t,r,a)=>{if(U.isClientSideRendering){N(t);return}let[n,s]=M({onError:S,error:e,disallowFallback:b,isClientSideRendering:U.isClientSideRendering,clientSideError:e});if("fail"===n){N(s);return}window.remotion_isMainTab&&i.Xp.Log.warn({logLevel:u,tag:"@remotion/media"},r),O({durationInSeconds:a})};if("unknown-container-format"===t.type){a(Error(`Unknown container format ${r}.`),Error(`Cannot render video "${r}": Unknown container format. See supported formats: https://www.remotion.dev/docs/mediabunny/formats`),`Unknown container format for ${r} (Supported formats: https://www.remotion.dev/docs/mediabunny/formats), falling back to <OffthreadVideo>`,null);return}if("cannot-decode"===t.type){a(Error(`Cannot decode ${r}.`),Error(`Cannot render video "${r}": The video could not be decoded by the browser.`),`Cannot decode ${r}, falling back to <OffthreadVideo>`,t.durationInSeconds);return}if("cannot-decode-alpha"===t.type){a(Error(`Cannot decode alpha component for ${r}.`),Error(`Cannot render video "${r}": The alpha channel could not be decoded by the browser.`),`Cannot decode alpha component for ${r}, falling back to <OffthreadVideo>`,t.durationInSeconds);return}if("network-error"===t.type){a(Error(`Network error fetching ${r}.`),Error(`Cannot render video "${r}": Network error while fetching the video (possibly CORS).`),`Network error fetching ${r} (no CORS?), falling back to <OffthreadVideo>`,null);return}let{frame:n,audio:o,durationInSeconds:l}=t;if(n){d?.(n);let e=_.current?.getContext("2d",{alpha:!0});e&&(e.canvas.width=n.width,e.canvas.height=n.height,e.canvas.style.aspectRatio=`${e.canvas.width} / ${e.canvas.height}`,e.drawImage(n,0,0)),n.close()}else if($){let e=_.current?.getContext("2d",{alpha:!0});e&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}let c=ec({behavior:s,loop:h,assetDurationInSeconds:l??0,fps:I,frame:C,startsAt:F}),m=i.Xp.evaluateVolume({volume:e,frame:c,mediaVolume:1});i.Xp.warnAboutTooHighVolume(m),o&&m>0&&(es(o.data,m),E({type:"inline-audio",id:L,audio:U.isClientSideRendering?o.data:Array.from(o.data),frame:P,timestamp:o.timestamp,duration:o.numberOfFrames/48e3*1e6,toneFrequency:w})),D(f)}).catch(e=>{N(e)}),()=>{D(f),A(L)}},[P,D,R,o,l,U.isClientSideRendering,I,C,L,u,h,s,n,d,t,E,r,F,A,e,z,g,b,w,v,x,V,$,j,N,T,S]);let K=(0,a.useMemo)(()=>[i.Xp.OBJECTFIT_CONTAIN_CLASS_NAME,m].filter(i.Xp.truthy).join(" "),[m]);if(z){let a=(0,c.jsx)(i.Xp.InnerOffthreadVideo,{src:r,playbackRate:t??1,muted:n??!1,acceptableTimeShiftInSeconds:p?.acceptableTimeShiftInSeconds,loopVolumeCurveBehavior:s??"repeat",delayRenderRetries:o??void 0,delayRenderTimeoutInMilliseconds:l??void 0,style:f,allowAmplificationDuringRender:!0,transparent:p?.transparent??!0,toneMapped:p?.toneMapped??!0,audioStreamIndex:g??0,name:y,className:m,onVideoFrame:d,volume:e,id:L,onError:p?.onError,toneFrequency:w,showInTimeline:!1,crossOrigin:p?.crossOrigin,onAutoPlayError:p?.onAutoPlayError??null,pauseWhenBuffering:p?.pauseWhenBuffering??!1,trimAfter:v,trimBefore:x,useWebAudioApi:p?.useWebAudioApi??!1,startFrom:void 0,endAt:void 0,stack:k,_remotionInternalNativeLoopPassed:!1});if(h){if(!z.durationInSeconds){let e=Error(`Cannot render video ${r}: @remotion/media was unable to render, and fell back to <OffthreadVideo>. Also, "loop" was set, but <OffthreadVideo> does not support looping and @remotion/media could also not determine the duration of the video.`);throw N(e),e}return(0,c.jsx)(i.FZ,{layout:"none",durationInFrames:i.Xp.calculateMediaDuration({trimAfter:v,mediaDurationInFrames:z.durationInSeconds*I,playbackRate:t,trimBefore:x}),children:a})}return a}return T?null:(0,c.jsx)("canvas",{ref:_,style:f,className:K})},{validateMediaTrimProps:eG,resolveTrimProps:eY,validateMediaProps:e0}=i.Xp,e1=({src:e,audioStreamIndex:t,className:r,delayRenderRetries:a,delayRenderTimeoutInMilliseconds:n,disallowFallbackToOffthreadVideo:s,fallbackOffthreadVideoProps:o,logLevel:l,loop:d,loopVolumeCurveBehavior:u,muted:h,name:f,onVideoFrame:m,playbackRate:p,style:g,trimAfter:y,trimBefore:b,volume:k,stack:w,toneFrequency:v,showInTimeline:x,debugOverlay:T,headless:S,onError:C})=>{let P=(0,i.OK)();if("string"!=typeof e)throw TypeError(`The \`<Video>\` tag requires a string for \`src\`, but got ${JSON.stringify(e)} instead.`);eG({startFrom:void 0,endAt:void 0,trimBefore:b,trimAfter:y});let{trimBeforeValue:I,trimAfterValue:E}=eY({startFrom:void 0,endAt:void 0,trimBefore:b,trimAfter:y});return(e0({playbackRate:p,volume:k},"Video"),P.isRendering)?(0,c.jsx)(eZ,{audioStreamIndex:t??0,className:r,delayRenderRetries:a??null,delayRenderTimeoutInMilliseconds:n??null,disallowFallbackToOffthreadVideo:s??!1,name:f,fallbackOffthreadVideoProps:o,logLevel:l,loop:d,loopVolumeCurveBehavior:u,muted:h,onVideoFrame:m,playbackRate:p,src:e,stack:w,style:g,volume:k,toneFrequency:v,trimAfterValue:E,trimBeforeValue:I,headless:S,onError:C}):(0,c.jsx)(eJ,{audioStreamIndex:t??0,className:r,name:f,logLevel:l,loop:d,loopVolumeCurveBehavior:u,muted:h,onVideoFrame:m,playbackRate:p,src:e,style:g,volume:k,showInTimeline:x,trimAfter:E,trimBefore:I,stack:w??null,disallowFallbackToOffthreadVideo:s,fallbackOffthreadVideoProps:o,debugOverlay:T??!1,headless:S??!1,onError:C})},e2=({src:e,audioStreamIndex:t,className:r,delayRenderRetries:a,delayRenderTimeoutInMilliseconds:n,disallowFallbackToOffthreadVideo:s,fallbackOffthreadVideoProps:o,logLevel:l,loop:d,loopVolumeCurveBehavior:u,muted:h,name:f,onVideoFrame:m,playbackRate:p,showInTimeline:g,style:y,trimAfter:b,trimBefore:k,volume:w,stack:v,toneFrequency:x,debugOverlay:T,headless:S,onError:C})=>{let P=i.Xp.useLogLevel();return(0,c.jsx)(e1,{audioStreamIndex:t??0,className:r,delayRenderRetries:a??null,delayRenderTimeoutInMilliseconds:n??null,disallowFallbackToOffthreadVideo:s??!1,fallbackOffthreadVideoProps:o??{},logLevel:l??P,loop:d??!1,loopVolumeCurveBehavior:u??"repeat",muted:h??!1,name:f,onVideoFrame:m,playbackRate:p??1,showInTimeline:g??!0,src:e,style:y??{},trimAfter:b,trimBefore:k,volume:w??1,toneFrequency:x??1,stack:v,debugOverlay:T??!1,headless:S??!1,onError:C})};i.Xp.addSequenceStackTraces(e2)},4068:(e,t,r)=>{r.d(t,{jp:()=>c}),r(2115),r(7650),r(5155);var i=r(9732),a=e=>{if(e.includes("canary")||e.includes("experimental"))return parseInt(e.slice(-8),10)>0x134b041;let[t]=e.split(".").map(Number);return t>18},n=({counterClockwise:e,actualProgress:t,rotation:r,radius:i,coord:a})=>Math.round(1e5*(Math["x"===a?"cos":"sin"]((e?-1:1)*t*Math.PI*2+1.5*Math.PI+r)*i+i))/1e5,s=(e,t)=>{let[r,i]=e,a=Math.sqrt(r*r+i*i),n=(a-t)/a;return[r*n,i*n]},o=(e,t)=>{let[r,i]=e,a=t/Math.sqrt(r*r+i*i);return[r*a,i*a]},l=(e,{edgeRoundness:t,cornerRadius:r,roundCornerStrategy:i})=>e.map(([a,n],l)=>{let c=0===l?e.length-2:l-1,d=e[c],u=l===e.length-1?1:l+1,h=e[u],f=[(a+h[0])/2,(n+h[1])/2],m=[(a+d[0])/2,(n+d[1])/2],p=[a-d[0],n-d[1]],g=[h[0]-a,h[1]-n];if(0===l){if(null!==t)return[{type:"M",x:f[0],y:f[1]}];if(0!==r){let e=s(g,r);return[{type:"M",x:e[0]+a,y:e[1]+n}]}return[{type:"M",x:a,y:n}]}if(r&&null!==t)throw Error('"cornerRadius" and "edgeRoundness" cannot be specified at the same time.');if(null===t){if(0===r)return[{type:"L",x:a,y:n}];let e=s(p,r),t=o(p,r),l=o(g,r),c=[d[0]+e[0],d[1]+e[1]];return[{type:"L",x:c[0],y:c[1]},"arc"===i?{type:"a",rx:r,ry:r,xAxisRotation:0,dx:t[0]+l[0],dy:t[1]+l[1],largeArcFlag:!1,sweepFlag:!0}:{type:"C",x:c[0]+t[0]+l[0],y:c[1]+t[1]+l[1],cp1x:a,cp1y:n,cp2x:a,cp2y:n}]}let y=[m[0]+p[0]*t*.5,m[1]+p[1]*t*.5],b=[f[0]-g[0]*t*.5,f[1]-g[1]*t*.5];return[{type:"C",cp1x:y[0],cp1y:y[1],cp2x:b[0],cp2y:b[1],x:f[0],y:f[1]}]}).flat(1),c=({width:e,height:t,edgeRoundness:r=null,cornerRadius:a=0})=>{let n=[e/2,t/2],s=[...l([[a,0],[e,0],[e,t],[0,t],[0,0]],{edgeRoundness:r,cornerRadius:a,roundCornerStrategy:"arc"}),{type:"Z"}],o=(0,i.Yf)(s);return{width:e,height:t,instructions:s,path:o,transformOrigin:n.join(" ")}},d=({centerX:e,centerY:t,points:r,innerRadius:i,outerRadius:a,cornerRadius:n,edgeRoundness:s})=>{let o=2*Math.PI/(2*r),c=Array(2*r).fill(!0).map((r,n)=>{let s=n%2==0?a:i,l=o*n-Math.PI/2,c={x:e+s*Math.cos(l),y:t+s*Math.sin(l)};return[c.x,c.y]});return[...l([...c,c[0]],{edgeRoundness:s,cornerRadius:n,roundCornerStrategy:n>0?"bezier":"arc"}),{type:"Z"}]}},4159:(e,t,r)=>{r.d(t,{VD:()=>n,VF:()=>a,Ze:()=>l,cc:()=>s,gM:()=>o,sF:()=>i});class i{constructor(e,t){if(this.data=e,this.mimeType=t,!(e instanceof Uint8Array))throw TypeError("data must be a Uint8Array.");if("string"!=typeof t)throw TypeError("mimeType must be a string.")}}class a{constructor(e,t,r,i){if(this.data=e,this.mimeType=t,this.name=r,this.description=i,!(e instanceof Uint8Array))throw TypeError("data must be a Uint8Array.");if(void 0!==t&&"string"!=typeof t)throw TypeError("mimeType, when provided, must be a string.");if(void 0!==r&&"string"!=typeof r)throw TypeError("name, when provided, must be a string.");if(void 0!==i&&"string"!=typeof i)throw TypeError("description, when provided, must be a string.")}}let n=e=>{if(!e||"object"!=typeof e)throw TypeError("tags must be an object.");if(void 0!==e.title&&"string"!=typeof e.title)throw TypeError("tags.title, when provided, must be a string.");if(void 0!==e.description&&"string"!=typeof e.description)throw TypeError("tags.description, when provided, must be a string.");if(void 0!==e.artist&&"string"!=typeof e.artist)throw TypeError("tags.artist, when provided, must be a string.");if(void 0!==e.album&&"string"!=typeof e.album)throw TypeError("tags.album, when provided, must be a string.");if(void 0!==e.albumArtist&&"string"!=typeof e.albumArtist)throw TypeError("tags.albumArtist, when provided, must be a string.");if(void 0!==e.trackNumber&&(!Number.isInteger(e.trackNumber)||e.trackNumber<=0))throw TypeError("tags.trackNumber, when provided, must be a positive integer.");if(void 0!==e.tracksTotal&&(!Number.isInteger(e.tracksTotal)||e.tracksTotal<=0))throw TypeError("tags.tracksTotal, when provided, must be a positive integer.");if(void 0!==e.discNumber&&(!Number.isInteger(e.discNumber)||e.discNumber<=0))throw TypeError("tags.discNumber, when provided, must be a positive integer.");if(void 0!==e.discsTotal&&(!Number.isInteger(e.discsTotal)||e.discsTotal<=0))throw TypeError("tags.discsTotal, when provided, must be a positive integer.");if(void 0!==e.genre&&"string"!=typeof e.genre)throw TypeError("tags.genre, when provided, must be a string.");if(void 0!==e.date&&(!(e.date instanceof Date)||Number.isNaN(e.date.getTime())))throw TypeError("tags.date, when provided, must be a valid Date.");if(void 0!==e.lyrics&&"string"!=typeof e.lyrics)throw TypeError("tags.lyrics, when provided, must be a string.");if(void 0!==e.images){if(!Array.isArray(e.images))throw TypeError("tags.images, when provided, must be an array.");for(let t of e.images){if(!t||"object"!=typeof t)throw TypeError("Each image in tags.images must be an object.");if(!(t.data instanceof Uint8Array))throw TypeError("Each image.data must be a Uint8Array.");if("string"!=typeof t.mimeType)throw TypeError("Each image.mimeType must be a string.");if(!["coverFront","coverBack","unknown"].includes(t.kind))throw TypeError("Each image.kind must be 'coverFront', 'coverBack', or 'unknown'.")}}if(void 0!==e.comment&&"string"!=typeof e.comment)throw TypeError("tags.comment, when provided, must be a string.");if(void 0!==e.raw){if(!e.raw||"object"!=typeof e.raw)throw TypeError("tags.raw, when provided, must be an object.");for(let t of Object.values(e.raw))if(null!==t&&"string"!=typeof t&&!(t instanceof Uint8Array)&&!(t instanceof i)&&!(t instanceof a))throw TypeError("Each value in tags.raw must be a string, Uint8Array, RichImageData, AttachedFile, or null.")}},s=e=>void 0===e.title&&void 0===e.description&&void 0===e.artist&&void 0===e.album&&void 0===e.albumArtist&&void 0===e.trackNumber&&void 0===e.tracksTotal&&void 0===e.discNumber&&void 0===e.discsTotal&&void 0===e.genre&&void 0===e.date&&void 0===e.lyrics&&(!e.images||0===e.images.length)&&void 0===e.comment&&(void 0===e.raw||0===Object.keys(e.raw).length),o={default:!0,forced:!1,original:!1,commentary:!1,hearingImpaired:!1,visuallyImpaired:!1},l=e=>{if(!e||"object"!=typeof e)throw TypeError("disposition must be an object.");if(void 0!==e.default&&"boolean"!=typeof e.default)throw TypeError("disposition.default must be a boolean.");if(void 0!==e.forced&&"boolean"!=typeof e.forced)throw TypeError("disposition.forced must be a boolean.");if(void 0!==e.original&&"boolean"!=typeof e.original)throw TypeError("disposition.original must be a boolean.");if(void 0!==e.commentary&&"boolean"!=typeof e.commentary)throw TypeError("disposition.commentary must be a boolean.");if(void 0!==e.hearingImpaired&&"boolean"!=typeof e.hearingImpaired)throw TypeError("disposition.hearingImpaired must be a boolean.");if(void 0!==e.visuallyImpaired&&"boolean"!=typeof e.visuallyImpaired)throw TypeError("disposition.visuallyImpaired must be a boolean.")}},4700:(e,t,r)=>{r.d(t,{D0:()=>n,EZ:()=>c,Fm:()=>h,P8:()=>d,Pj:()=>u,Yq:()=>i,c9:()=>l,hY:()=>s,rD:()=>o});let i=4,a=[44100,48e3,32e3],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1,-1,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1,-1,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1,-1,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1,-1,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],s=0x58696e67,o=0x496e666f,l=(e,t,r,i,a)=>0===t?0:1===t?Math.floor(144*r/(i<<e))+a:2===t?Math.floor(144*r/i)+a:(Math.floor(12*r/i)+a)*4,c=(e,t)=>3===e?3===t?21:36:3===t?13:21,d=(e,t)=>{let r;let i=e>>>24,s=e>>>16&255,o=e>>>8&255,c=255&e;if(255!==i&&255!==s&&255!==o&&255!==c)return{header:null,bytesAdvanced:4};if(255!==i||(224&s)!=224)return{header:null,bytesAdvanced:1};let d=0,u=0;16&s?d=8&s?0:1:(d=1,u=1);let h=s>>3&3,f=s>>1&3,m=(o>>2&3)%3,p=n[64*d+16*f+(o>>4&15)];if(-1===p)return{header:null,bytesAdvanced:1};let g=1e3*p,y=a[m]>>d+u,b=l(d,f,g,y,o>>1&1);return null!==t&&t<b?{header:null,bytesAdvanced:1}:(r=3===h?3===f?384:1152:3===f?384:2===f?1152:576,{header:{totalSize:b,mpegVersionId:h,layer:f,bitrate:g,frequencyIndex:m,sampleRate:y,channel:c>>6&3,modeExtension:c>>4&3,copyright:c>>3&1,original:c>>2&1,emphasis:3&c,audioSamplesInFrame:r},bytesAdvanced:1})},u=e=>{let t=127,r=0,i=e;for(;(0x7fffffff^t)!=0;)r=(i&~t)<<1|i&t,t=(t+1<<8)-1,i=r;return r},h=e=>{let t=0x7f000000,r=0;for(;0!==t;)r>>=1,r|=e&t,t>>=8;return r}},4747:(e,t,r)=>{r.d(t,{Cl:()=>i,De:()=>b,IQ:()=>M,IX:()=>I,K9:()=>h,Kb:()=>C,Qn:()=>y,Ry:()=>T,SR:()=>S,VE:()=>u,YO:()=>w,Z4:()=>o,_v:()=>s,dl:()=>x,jR:()=>E,lT:()=>c,nE:()=>F,oo:()=>B,p:()=>L,pT:()=>v,r1:()=>k,ur:()=>P,ys:()=>l,zH:()=>A});var i,a=r(8734),n=r(8113);class s{constructor(e){this.value=e}}class o{constructor(e){this.value=e}}class l{constructor(e){this.value=e}}class c{constructor(e){this.value=e}}!function(e){e[e.EBML=0x1a45dfa3]="EBML",e[e.EBMLVersion=17030]="EBMLVersion",e[e.EBMLReadVersion=17143]="EBMLReadVersion",e[e.EBMLMaxIDLength=17138]="EBMLMaxIDLength",e[e.EBMLMaxSizeLength=17139]="EBMLMaxSizeLength",e[e.DocType=17026]="DocType",e[e.DocTypeVersion=17031]="DocTypeVersion",e[e.DocTypeReadVersion=17029]="DocTypeReadVersion",e[e.Void=236]="Void",e[e.Segment=0x18538067]="Segment",e[e.SeekHead=0x114d9b74]="SeekHead",e[e.Seek=19899]="Seek",e[e.SeekID=21419]="SeekID",e[e.SeekPosition=21420]="SeekPosition",e[e.Duration=17545]="Duration",e[e.Info=0x1549a966]="Info",e[e.TimestampScale=2807729]="TimestampScale",e[e.MuxingApp=19840]="MuxingApp",e[e.WritingApp=22337]="WritingApp",e[e.Tracks=0x1654ae6b]="Tracks",e[e.TrackEntry=174]="TrackEntry",e[e.TrackNumber=215]="TrackNumber",e[e.TrackUID=29637]="TrackUID",e[e.TrackType=131]="TrackType",e[e.FlagEnabled=185]="FlagEnabled",e[e.FlagDefault=136]="FlagDefault",e[e.FlagForced=21930]="FlagForced",e[e.FlagOriginal=21934]="FlagOriginal",e[e.FlagHearingImpaired=21931]="FlagHearingImpaired",e[e.FlagVisualImpaired=21932]="FlagVisualImpaired",e[e.FlagCommentary=21935]="FlagCommentary",e[e.FlagLacing=156]="FlagLacing",e[e.Name=21358]="Name",e[e.Language=2274716]="Language",e[e.LanguageBCP47=2274717]="LanguageBCP47",e[e.CodecID=134]="CodecID",e[e.CodecPrivate=25506]="CodecPrivate",e[e.CodecDelay=22186]="CodecDelay",e[e.SeekPreRoll=22203]="SeekPreRoll",e[e.DefaultDuration=2352003]="DefaultDuration",e[e.Video=224]="Video",e[e.PixelWidth=176]="PixelWidth",e[e.PixelHeight=186]="PixelHeight",e[e.AlphaMode=21440]="AlphaMode",e[e.Audio=225]="Audio",e[e.SamplingFrequency=181]="SamplingFrequency",e[e.Channels=159]="Channels",e[e.BitDepth=25188]="BitDepth",e[e.SimpleBlock=163]="SimpleBlock",e[e.BlockGroup=160]="BlockGroup",e[e.Block=161]="Block",e[e.BlockAdditions=30113]="BlockAdditions",e[e.BlockMore=166]="BlockMore",e[e.BlockAdditional=165]="BlockAdditional",e[e.BlockAddID=238]="BlockAddID",e[e.BlockDuration=155]="BlockDuration",e[e.ReferenceBlock=251]="ReferenceBlock",e[e.Cluster=0x1f43b675]="Cluster",e[e.Timestamp=231]="Timestamp",e[e.Cues=0x1c53bb6b]="Cues",e[e.CuePoint=187]="CuePoint",e[e.CueTime=179]="CueTime",e[e.CueTrackPositions=183]="CueTrackPositions",e[e.CueTrack=247]="CueTrack",e[e.CueClusterPosition=241]="CueClusterPosition",e[e.Colour=21936]="Colour",e[e.MatrixCoefficients=21937]="MatrixCoefficients",e[e.TransferCharacteristics=21946]="TransferCharacteristics",e[e.Primaries=21947]="Primaries",e[e.Range=21945]="Range",e[e.Projection=30320]="Projection",e[e.ProjectionType=30321]="ProjectionType",e[e.ProjectionPoseRoll=30325]="ProjectionPoseRoll",e[e.Attachments=0x1941a469]="Attachments",e[e.AttachedFile=24999]="AttachedFile",e[e.FileDescription=18046]="FileDescription",e[e.FileName=18030]="FileName",e[e.FileMediaType=18016]="FileMediaType",e[e.FileData=18012]="FileData",e[e.FileUID=18094]="FileUID",e[e.Chapters=0x1043a770]="Chapters",e[e.Tags=0x1254c367]="Tags",e[e.Tag=29555]="Tag",e[e.Targets=25536]="Targets",e[e.TargetTypeValue=26826]="TargetTypeValue",e[e.TargetType=25546]="TargetType",e[e.TagTrackUID=25541]="TagTrackUID",e[e.TagEditionUID=25545]="TagEditionUID",e[e.TagChapterUID=25540]="TagChapterUID",e[e.TagAttachmentUID=25542]="TagAttachmentUID",e[e.SimpleTag=26568]="SimpleTag",e[e.TagName=17827]="TagName",e[e.TagLanguage=17530]="TagLanguage",e[e.TagString=17543]="TagString",e[e.TagBinary=17541]="TagBinary",e[e.ContentEncodings=28032]="ContentEncodings",e[e.ContentEncoding=25152]="ContentEncoding",e[e.ContentEncodingOrder=20529]="ContentEncodingOrder",e[e.ContentEncodingScope=20530]="ContentEncodingScope",e[e.ContentCompression=20532]="ContentCompression",e[e.ContentCompAlgo=16980]="ContentCompAlgo",e[e.ContentCompSettings=16981]="ContentCompSettings",e[e.ContentEncryption=20533]="ContentEncryption"}(i||(i={}));let d=[i.EBML,i.Segment],u=[i.SeekHead,i.Info,i.Cluster,i.Tracks,i.Cues,i.Attachments,i.Chapters,i.Tags],h=[...d,...u],f=e=>{if(e<256)return 1;if(e<65536)return 2;if(e<0x1000000)return 3;if(e<0x100000000)return 4;if(e<0x10000000000)return 5;else return 6},m=e=>{if(e<1n<<8n)return 1;if(e<1n<<16n)return 2;if(e<1n<<24n)return 3;if(e<1n<<32n)return 4;if(e<1n<<40n)return 5;else if(e<1n<<48n)return 6;else if(e<1n<<56n)return 7;else return 8},p=e=>{if(e>=-64&&e<64)return 1;if(e>=-8192&&e<8192)return 2;if(e>=-1048576&&e<1048576)return 3;if(e>=-0x8000000&&e<0x8000000)return 4;if(e>=-0x400000000&&e<0x400000000)return 5;else return 6},g=e=>{if(e<127)return 1;if(e<16383)return 2;if(e<2097151)return 3;if(e<0xfffffff)return 4;if(e<0x800000000-1)return 5;else if(e<0x40000000000-1)return 6;else throw Error("EBML varint size not supported "+e)};class y{constructor(e){this.writer=e,this.helper=new Uint8Array(8),this.helperView=new DataView(this.helper.buffer),this.offsets=new WeakMap,this.dataOffsets=new WeakMap}writeByte(e){this.helperView.setUint8(0,e),this.writer.write(this.helper.subarray(0,1))}writeFloat32(e){this.helperView.setFloat32(0,e,!1),this.writer.write(this.helper.subarray(0,4))}writeFloat64(e){this.helperView.setFloat64(0,e,!1),this.writer.write(this.helper)}writeUnsignedInt(e,t=f(e)){let r=0;switch(t){case 6:this.helperView.setUint8(r++,e/0x10000000000|0);case 5:this.helperView.setUint8(r++,e/0x100000000|0);case 4:this.helperView.setUint8(r++,e>>24);case 3:this.helperView.setUint8(r++,e>>16);case 2:this.helperView.setUint8(r++,e>>8);case 1:this.helperView.setUint8(r++,e);break;default:throw Error("Bad unsigned int size "+t)}this.writer.write(this.helper.subarray(0,r))}writeUnsignedBigInt(e,t=m(e)){let r=0;for(let i=t-1;i>=0;i--)this.helperView.setUint8(r++,Number(e>>BigInt(8*i)&255n));this.writer.write(this.helper.subarray(0,r))}writeSignedInt(e,t=p(e)){e<0&&(e+=2**(8*t)),this.writeUnsignedInt(e,t)}writeVarInt(e,t=g(e)){let r=0;switch(t){case 1:this.helperView.setUint8(r++,128|e);break;case 2:this.helperView.setUint8(r++,64|e>>8),this.helperView.setUint8(r++,e);break;case 3:this.helperView.setUint8(r++,32|e>>16),this.helperView.setUint8(r++,e>>8),this.helperView.setUint8(r++,e);break;case 4:this.helperView.setUint8(r++,16|e>>24),this.helperView.setUint8(r++,e>>16),this.helperView.setUint8(r++,e>>8),this.helperView.setUint8(r++,e);break;case 5:this.helperView.setUint8(r++,8|e/0x100000000&7),this.helperView.setUint8(r++,e>>24),this.helperView.setUint8(r++,e>>16),this.helperView.setUint8(r++,e>>8),this.helperView.setUint8(r++,e);break;case 6:this.helperView.setUint8(r++,4|e/0x10000000000&3),this.helperView.setUint8(r++,e/0x100000000|0),this.helperView.setUint8(r++,e>>24),this.helperView.setUint8(r++,e>>16),this.helperView.setUint8(r++,e>>8),this.helperView.setUint8(r++,e);break;default:throw Error("Bad EBML varint size "+t)}this.writer.write(this.helper.subarray(0,r))}writeAsciiString(e){this.writer.write(new Uint8Array(e.split("").map(e=>e.charCodeAt(0))))}writeEBML(e){if(null!==e){if(e instanceof Uint8Array)this.writer.write(e);else if(Array.isArray(e))for(let t of e)this.writeEBML(t);else if(this.offsets.set(e,this.writer.getPos()),this.writeUnsignedInt(e.id),Array.isArray(e.data)){let t=this.writer.getPos(),r=-1===e.size?1:e.size??4;-1===e.size?this.writeByte(255):this.writer.seek(this.writer.getPos()+r);let i=this.writer.getPos();if(this.dataOffsets.set(e,i),this.writeEBML(e.data),-1!==e.size){let e=this.writer.getPos()-i,a=this.writer.getPos();this.writer.seek(t),this.writeVarInt(e,r),this.writer.seek(a)}}else if("number"==typeof e.data){let t=e.size??f(e.data);this.writeVarInt(t),this.writeUnsignedInt(e.data,t)}else if("bigint"==typeof e.data){let t=e.size??m(e.data);this.writeVarInt(t),this.writeUnsignedBigInt(e.data,t)}else if("string"==typeof e.data)this.writeVarInt(e.data.length),this.writeAsciiString(e.data);else if(e.data instanceof Uint8Array)this.writeVarInt(e.data.byteLength,e.size),this.writer.write(e.data);else if(e.data instanceof s)this.writeVarInt(4),this.writeFloat32(e.data.value);else if(e.data instanceof o)this.writeVarInt(8),this.writeFloat64(e.data.value);else if(e.data instanceof l){let t=e.size??p(e.data.value);this.writeVarInt(t),this.writeSignedInt(e.data.value,t)}else if(e.data instanceof c){let t=a.UG.encode(e.data.value);this.writeVarInt(t.length),this.writer.write(t)}else(0,a.xb)(e.data)}}}let b=2,k=16,w=e=>{if(e.remainingLength<1)return null;let t=(0,n.eo)(e);if(e.skip(-1),0===t)return null;let r=1,i=128;for(;(t&i)==0;)r++,i>>=1;return e.remainingLength<r?null:r},v=e=>{if(e.remainingLength<1)return null;let t=(0,n.eo)(e);if(0===t)return null;let r=1,i=128;for(;(t&i)==0;)r++,i>>=1;if(e.remainingLength<r-1)return null;let a=t&i-1;for(let t=1;t<r;t++)a*=256,a+=(0,n.eo)(e);return a},x=(e,t)=>{if(t<1||t>8)throw Error("Bad unsigned int size "+t);let r=0;for(let i=0;i<t;i++)r*=256,r+=(0,n.eo)(e);return r},T=(e,t)=>{if(t<1)throw Error("Bad unsigned int size "+t);let r=0n;for(let i=0;i<t;i++)r<<=8n,r+=BigInt((0,n.eo)(e));return r},S=e=>{let t=w(e);return null===t||e.remainingLength<t?null:x(e,t)},C=e=>{if(e.remainingLength<1)return null;if(255===(0,n.eo)(e))return;e.skip(-1);let t=v(e);return null===t?null:0x100000000000000!==t?t:void 0},P=e=>{(0,a.vA)(e.remainingLength>=b);let t=S(e);if(null===t)return null;let r=C(e);return null===r?null:{id:t,size:r}},I=(e,t)=>{let r=(0,n.io)(e,t),i=0;for(;i<t&&0!==r[i];)i+=1;return String.fromCharCode(...r.subarray(0,i))},E=(e,t)=>{let r=(0,n.io)(e,t),i=0;for(;i<t&&0!==r[i];)i+=1;return a.su.decode(r.subarray(0,i))},A=(e,t)=>{if(0===t)return 0;if(4!==t&&8!==t)throw Error("Bad float size "+t);return 4===t?(0,n.Jk)(e):(0,n._3)(e)},M=async(e,t,r,i)=>{let a=new Set(r),n=t;for(;null===i||n<i;){let t=e.requestSliceRange(n,b,k);if(t instanceof Promise&&(t=await t),!t)break;let r=P(t);if(!r)break;if(a.has(r.id))return{pos:n,found:!0};L(r.size),n=t.filePos+r.size}return{pos:null!==i&&i>n?i:n,found:!1}},F=async(e,t,r,i)=>{let a=new Set(r),n=t;for(;n<i;){let t=e.requestSliceRange(n,0,Math.min(65536,i-n));if(t instanceof Promise&&(t=await t),!t||t.length<8)break;for(let e=0;e<t.length-8;e++){t.filePos=n;let e=S(t);if(null!==e&&a.has(e))return n;n++}}return null},B={avc:"V_MPEG4/ISO/AVC",hevc:"V_MPEGH/ISO/HEVC",vp8:"V_VP8",vp9:"V_VP9",av1:"V_AV1",aac:"A_AAC",mp3:"A_MPEG/L3",opus:"A_OPUS",vorbis:"A_VORBIS",flac:"A_FLAC","pcm-u8":"A_PCM/INT/LIT","pcm-s16":"A_PCM/INT/LIT","pcm-s16be":"A_PCM/INT/BIG","pcm-s24":"A_PCM/INT/LIT","pcm-s24be":"A_PCM/INT/BIG","pcm-s32":"A_PCM/INT/LIT","pcm-s32be":"A_PCM/INT/BIG","pcm-f32":"A_PCM/FLOAT/IEEE","pcm-f64":"A_PCM/FLOAT/IEEE",webvtt:"S_TEXT/WEBVTT"};function L(e){if(void 0===e)throw Error("Undefined element size is used in a place where it is not supported.")}},4947:(e,t,r)=>{r.d(t,{XE:()=>eE,CW:()=>el,BN:()=>ex,q6:()=>eT});var i,a,n,s=r(3468),o=r(5799),l=r(7354),c=r(8244),d=r(8734),u=r(5854),h=r(2832),f=r(5555),m=r(8113),p=r(4159);class g extends l.B{constructor(e){super(e),this.moovSlice=null,this.currentTrack=null,this.tracks=[],this.metadataPromise=null,this.movieTimescale=-1,this.movieDurationInTimescale=-1,this.isQuickTime=!1,this.metadataTags={},this.currentMetadataKeys=null,this.isFragmented=!1,this.fragmentTrackDefaults=[],this.currentFragment=null,this.lastReadFragment=null,this.reader=e._reader}async computeDuration(){let e=await this.getTracks();return Math.max(0,...await Promise.all(e.map(e=>e.computeDuration())))}async getTracks(){return await this.readMetadata(),this.tracks.map(e=>e.inputTrack)}async getMimeType(){await this.readMetadata();let e=await Promise.all(this.tracks.map(e=>e.inputTrack.getCodecParameterString()));return(0,h.X)({isQuickTime:this.isQuickTime,hasVideo:this.tracks.some(e=>e.info?.type==="video"),hasAudio:this.tracks.some(e=>e.info?.type==="audio"),codecStrings:e.filter(Boolean)})}async getMetadataTags(){return await this.readMetadata(),this.metadataTags}readMetadata(){return this.metadataPromise??=(async()=>{let e=0;for(;;){let t=this.reader.requestSliceRange(e,f.ZM,f.Xk);if(t instanceof Promise&&(t=await t),!t)break;let r=e,i=(0,f.Vl)(t);if(!i)break;if("ftyp"===i.name){let e=(0,m.IT)(t,4);this.isQuickTime="qt  "===e}else if("moov"===i.name){let e=this.reader.requestSlice(t.filePos,i.contentSize);if(e instanceof Promise&&(e=await e),!e)break;for(let t of(this.moovSlice=e,this.readContiguousBoxes(this.moovSlice),this.tracks.sort((e,t)=>Number(t.disposition.default)-Number(e.disposition.default)),this.tracks)){let e=t.editListPreviousSegmentDurations/this.movieTimescale;t.editListOffset-=Math.round(e*t.timescale)}break}e=r+i.totalSize}if(this.isFragmented&&null!==this.reader.fileSize){let e=this.reader.requestSlice(this.reader.fileSize-4,4);e instanceof Promise&&(e=await e),(0,d.vA)(e);let t=(0,m.cN)(e),r=this.reader.fileSize-t;if(r>=0&&r<=this.reader.fileSize-f.Xk){let e=this.reader.requestSliceRange(r,f.ZM,f.Xk);if(e instanceof Promise&&(e=await e),e){let t=(0,f.Vl)(e);if(t&&"mfra"===t.name){let r=this.reader.requestSlice(e.filePos,t.contentSize);r instanceof Promise&&(r=await r),r&&this.readContiguousBoxes(r)}}}}})()}getSampleTableForTrack(e){if(e.sampleTable)return e.sampleTable;let t={sampleTimingEntries:[],sampleCompositionTimeOffsets:[],sampleSizes:[],keySampleIndices:null,chunkOffsets:[],sampleToChunk:[],presentationTimestamps:null,presentationTimestampIndexMap:null};e.sampleTable=t,(0,d.vA)(this.moovSlice);let r=this.moovSlice.slice(e.sampleTableByteOffset);if(this.currentTrack=e,this.traverseBox(r),this.currentTrack=null,e.info?.type==="audio"&&e.info.codec&&s.Wq.includes(e.info.codec)&&0===t.sampleCompositionTimeOffsets.length){(0,d.vA)(e.info?.type==="audio");let r=(0,s.Ei)(e.info.codec),i=[],a=[];for(let n=0;n<t.sampleToChunk.length;n++){let s=t.sampleToChunk[n],o=t.sampleToChunk[n+1],l=(o?o.startChunkIndex:t.chunkOffsets.length)-s.startChunkIndex;for(let n=0;n<l;n++){let o=s.startSampleIndex+n*s.samplesPerChunk,l=o+s.samplesPerChunk,c=(0,d.eE)(t.sampleTimingEntries,o,e=>e.startIndex),u=t.sampleTimingEntries[c],h=(0,d.eE)(t.sampleTimingEntries,l,e=>e.startIndex),f=t.sampleTimingEntries[h],m=u.startDecodeTimestamp+(o-u.startIndex)*u.delta,p=f.startDecodeTimestamp+(l-f.startIndex)*f.delta-m,g=(0,d._g)(i);g&&g.delta===p?g.count++:i.push({startIndex:s.startChunkIndex+n,startDecodeTimestamp:m,count:1,delta:p});let y=s.samplesPerChunk*r.sampleSize*e.info.numberOfChannels;a.push(y)}s.startSampleIndex=s.startChunkIndex,s.samplesPerChunk=1}t.sampleTimingEntries=i,t.sampleSizes=a}if(t.sampleCompositionTimeOffsets.length>0){for(let e of(t.presentationTimestamps=[],t.sampleTimingEntries))for(let r=0;r<e.count;r++)t.presentationTimestamps.push({presentationTimestamp:e.startDecodeTimestamp+r*e.delta,sampleIndex:e.startIndex+r});for(let e of t.sampleCompositionTimeOffsets)for(let r=0;r<e.count;r++){let i=e.startIndex+r,a=t.presentationTimestamps[i];a&&(a.presentationTimestamp+=e.offset)}t.presentationTimestamps.sort((e,t)=>e.presentationTimestamp-t.presentationTimestamp),t.presentationTimestampIndexMap=Array(t.presentationTimestamps.length).fill(-1);for(let e=0;e<t.presentationTimestamps.length;e++)t.presentationTimestampIndexMap[t.presentationTimestamps[e].sampleIndex]=e}return t}async readFragment(e){if(this.lastReadFragment?.moofOffset===e)return this.lastReadFragment;let t=this.reader.requestSliceRange(e,f.ZM,f.Xk);t instanceof Promise&&(t=await t),(0,d.vA)(t);let r=(0,f.Vl)(t);(0,d.vA)(r?.name==="moof");let i=this.reader.requestSlice(e,r.totalSize);i instanceof Promise&&(i=await i),(0,d.vA)(i),this.traverseBox(i);let a=this.lastReadFragment;for(let[,t]of((0,d.vA)(a&&a.moofOffset===e),a.trackData)){let e=t.track,{fragmentPositionCache:r}=e;if(!t.startTimestampIsFinal){let i=e.fragmentLookupTable.find(e=>e.moofOffset===a.moofOffset);if(i)S(t,i.timestamp);else{let e=(0,d.eE)(r,a.moofOffset-1,e=>e.moofOffset);-1!==e&&S(t,r[e].endTimestamp)}t.startTimestampIsFinal=!0}let i=(0,d.eE)(r,t.startTimestamp,e=>e.startTimestamp);(-1===i||r[i].moofOffset!==a.moofOffset)&&r.splice(i+1,0,{moofOffset:a.moofOffset,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp})}return a}readContiguousBoxes(e){let t=e.filePos;for(;e.filePos-t<=e.length-f.ZM&&this.traverseBox(e););}*iterateContiguousBoxes(e){let t=e.filePos;for(;e.filePos-t<=e.length-f.ZM;){let t=e.filePos,r=(0,f.Vl)(e);if(!r)break;yield{boxInfo:r,slice:e},e.filePos=t+r.totalSize}}traverseBox(e){let t=e.filePos,r=(0,f.Vl)(e);if(!r)return!1;let i=e.filePos,a=t+r.totalSize;switch(r.name){case"mdia":case"minf":case"dinf":case"mfra":case"edts":case"wave":this.readContiguousBoxes(e.slice(i,r.contentSize));break;case"mvhd":{let t=(0,m.eo)(e);e.skip(3),1===t?(e.skip(16),this.movieTimescale=(0,m.cN)(e),this.movieDurationInTimescale=(0,m.th)(e)):(e.skip(8),this.movieTimescale=(0,m.cN)(e),this.movieDurationInTimescale=(0,m.cN)(e))}break;case"trak":{let t={id:-1,demuxer:this,inputTrack:null,disposition:{...p.gM},info:null,timescale:-1,durationInMovieTimescale:-1,durationInMediaTimescale:-1,rotation:0,internalCodecId:null,name:null,languageCode:d.IR,sampleTableByteOffset:-1,sampleTable:null,fragmentLookupTable:[],currentFragmentState:null,fragmentPositionCache:[],editListPreviousSegmentDurations:0,editListOffset:0};this.currentTrack=t,this.readContiguousBoxes(e.slice(i,r.contentSize)),-1!==t.id&&-1!==t.timescale&&null!==t.info&&("video"===t.info.type&&-1!==t.info.width?(t.inputTrack=new c.N0(this.input,new b(t)),this.tracks.push(t)):"audio"===t.info.type&&-1!==t.info.numberOfChannels&&(t.inputTrack=new c.Yi(this.input,new k(t)),this.tracks.push(t))),this.currentTrack=null}break;case"tkhd":{let t=this.currentTrack;if(!t)break;let r=(0,m.eo)(e),i=(0,m.n2)(e);if(t.disposition.default=!!(1&i),0===r)e.skip(8),t.id=(0,m.cN)(e),e.skip(4),t.durationInMovieTimescale=(0,m.cN)(e);else if(1===r)e.skip(16),t.id=(0,m.cN)(e),e.skip(4),t.durationInMovieTimescale=(0,m.th)(e);else throw Error(`Incorrect track header version ${r}.`);e.skip(16);let a=[(0,f.vX)(e),(0,f.vX)(e),(0,f.IS)(e),(0,f.vX)(e),(0,f.vX)(e),(0,f.IS)(e),(0,f.vX)(e),(0,f.vX)(e),(0,f.IS)(e)],n=(0,d.qT)((0,d.in)(C(a),90));(0,d.vA)(0===n||90===n||180===n||270===n),t.rotation=n}break;case"elst":{let t=this.currentTrack;if(!t)break;let r=(0,m.eo)(e);e.skip(3);let i=!1,a=0,n=(0,m.cN)(e);for(let s=0;s<n;s++){let n=1===r?(0,m.th)(e):(0,m.cN)(e),s=1===r?(0,m.B5)(e):(0,m.Ar)(e),o=(0,f.vX)(e);if(0!==n){if(i){console.warn("Unsupported edit list: multiple edits are not currently supported. Only using first edit.");break}if(-1===s){a+=n;continue}if(1!==o){console.warn("Unsupported edit list entry: media rate must be 1.");break}t.editListPreviousSegmentDurations=a,t.editListOffset=s,i=!0}}}break;case"mdhd":{let t=this.currentTrack;if(!t)break;let r=(0,m.eo)(e);e.skip(3),0===r?(e.skip(8),t.timescale=(0,m.cN)(e),t.durationInMediaTimescale=(0,m.cN)(e)):1===r&&(e.skip(16),t.timescale=(0,m.cN)(e),t.durationInMediaTimescale=(0,m.th)(e));let i=(0,m.mH)(e);if(i>0){t.languageCode="";for(let e=0;e<3;e++)t.languageCode=String.fromCharCode(96+(31&i))+t.languageCode,i>>=5;(0,d.Nu)(t.languageCode)||(t.languageCode=d.IR)}}break;case"hdlr":{let t=this.currentTrack;if(!t)break;e.skip(8);let r=(0,m.IT)(e,4);"vide"===r?t.info={type:"video",width:-1,height:-1,codec:null,codecDescription:null,colorSpace:null,avcType:null,avcCodecInfo:null,hevcCodecInfo:null,vp9CodecInfo:null,av1CodecInfo:null}:"soun"===r&&(t.info={type:"audio",numberOfChannels:-1,sampleRate:-1,codec:null,codecDescription:null,aacCodecInfo:null})}break;case"stbl":{let a=this.currentTrack;if(!a)break;a.sampleTableByteOffset=t,this.readContiguousBoxes(e.slice(i,r.contentSize))}break;case"stsd":{let t=this.currentTrack;if(!t||null===t.info||t.sampleTable)break;let r=(0,m.eo)(e);e.skip(3);let i=(0,m.cN)(e);for(let a=0;a<i;a++){let i=e.filePos,a=(0,f.Vl)(e);if(!a)break;t.internalCodecId=a.name;let n=a.name.toLowerCase();if("video"===t.info.type)"avc1"===n||"avc3"===n?(t.info.codec="avc",t.info.avcType="avc1"===n?1:3):"hvc1"===n||"hev1"===n?t.info.codec="hevc":"vp08"===n?t.info.codec="vp8":"vp09"===n?t.info.codec="vp9":"av01"===n?t.info.codec="av1":console.warn(`Unsupported video codec (sample entry type '${a.name}').`),e.skip(24),t.info.width=(0,m.mH)(e),t.info.height=(0,m.mH)(e),e.skip(50),this.readContiguousBoxes(e.slice(e.filePos,i+a.totalSize-e.filePos));else{"mp4a"===n||("opus"===n?t.info.codec="opus":"flac"===n?t.info.codec="flac":"twos"===n||"sowt"===n||"raw "===n||"in24"===n||"in32"===n||"fl32"===n||"fl64"===n||"lpcm"===n||"ipcm"===n||"fpcm"===n||("ulaw"===n?t.info.codec="ulaw":"alaw"===n?t.info.codec="alaw":console.warn(`Unsupported audio codec (sample entry type '${a.name}').`))),e.skip(8);let o=(0,m.mH)(e);e.skip(6);let l=(0,m.mH)(e),c=(0,m.mH)(e);e.skip(4);let d=(0,m.cN)(e)/65536;if(0===r&&o>0){if(1===o)e.skip(4),c=8*(0,m.cN)(e),e.skip(8);else if(2===o){e.skip(4),d=(0,m._3)(e),l=(0,m.cN)(e),e.skip(4),c=(0,m.cN)(e);let r=(0,m.cN)(e);if(e.skip(8),"lpcm"===n){let e=c+7>>3,i=!!(1&r),a=!!(2&r),n=4&r?-1:0;c>0&&c<=64&&(i?32===c&&(t.info.codec=a?"pcm-f32be":"pcm-f32"):n&1<<e-1?1===e?t.info.codec="pcm-s8":2===e?t.info.codec=a?"pcm-s16be":"pcm-s16":3===e?t.info.codec=a?"pcm-s24be":"pcm-s24":4===e&&(t.info.codec=a?"pcm-s32be":"pcm-s32"):1===e&&(t.info.codec="pcm-u8")),null===t.info.codec&&console.warn("Unsupported PCM format.")}}}"opus"===t.info.codec&&(d=s.yo),t.info.numberOfChannels=l,t.info.sampleRate=d,"twos"===n?8===c?t.info.codec="pcm-s8":16===c?t.info.codec="pcm-s16be":(console.warn(`Unsupported sample size ${c} for codec 'twos'.`),t.info.codec=null):"sowt"===n?8===c?t.info.codec="pcm-s8":16===c?t.info.codec="pcm-s16":(console.warn(`Unsupported sample size ${c} for codec 'sowt'.`),t.info.codec=null):"raw "===n?t.info.codec="pcm-u8":"in24"===n?t.info.codec="pcm-s24be":"in32"===n?t.info.codec="pcm-s32be":"fl32"===n?t.info.codec="pcm-f32be":"fl64"===n?t.info.codec="pcm-f64be":"ipcm"===n?t.info.codec="pcm-s16be":"fpcm"===n&&(t.info.codec="pcm-f32be"),this.readContiguousBoxes(e.slice(e.filePos,i+a.totalSize-e.filePos))}}}break;case"avcC":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info),t.info.codecDescription=(0,m.io)(e,r.contentSize)}break;case"hvcC":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info),t.info.codecDescription=(0,m.io)(e,r.contentSize)}break;case"vpcC":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="video"),e.skip(4);let r=(0,m.eo)(e),i=(0,m.eo)(e),a=(0,m.eo)(e),n=(0,m.eo)(e),s=(0,m.eo)(e),o=(0,m.eo)(e);t.info.vp9CodecInfo={profile:r,level:i,bitDepth:a>>4,chromaSubsampling:a>>1&7,videoFullRangeFlag:1&a,colourPrimaries:n,transferCharacteristics:s,matrixCoefficients:o}}break;case"av1C":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="video"),e.skip(1);let r=(0,m.eo)(e),i=r>>5,a=(0,m.eo)(e),n=a>>6&1;t.info.av1CodecInfo={profile:i,level:31&r,tier:a>>7,bitDepth:2===i&&n?a>>5&1?12:10:n?10:8,monochrome:a>>4&1,chromaSubsamplingX:a>>3&1,chromaSubsamplingY:a>>2&1,chromaSamplePosition:3&a}}break;case"colr":{let t=this.currentTrack;if(!t||((0,d.vA)(t.info?.type==="video"),"nclx"!==(0,m.IT)(e,4)))break;let r=(0,m.mH)(e),i=(0,m.mH)(e),a=(0,m.mH)(e),n=!!(128&(0,m.eo)(e));t.info.colorSpace={primaries:d.BL[r],transfer:d.x_[i],matrix:d.fl[a],fullRange:n}}break;case"esds":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="audio"),e.skip(4);let r=(0,m.eo)(e);(0,d.vA)(3===r),(0,f.hs)(e),e.skip(2);let i=(0,m.eo)(e);if((128&i)!=0&&e.skip(2),(64&i)!=0){let t=(0,m.eo)(e);e.skip(t)}(32&i)!=0&&e.skip(2);let a=(0,m.eo)(e);(0,d.vA)(4===a);let n=(0,f.hs)(e),o=e.filePos,l=(0,m.eo)(e);if(64===l||103===l?(t.info.codec="aac",t.info.aacCodecInfo={isMpeg2:103===l,objectType:null}):105===l||107===l?t.info.codec="mp3":221===l?t.info.codec="vorbis":console.warn(`Unsupported audio codec (objectTypeIndication ${l}) - discarding track.`),e.skip(12),n>e.filePos-o){let r=(0,m.eo)(e);(0,d.vA)(5===r);let i=(0,f.hs)(e);if(t.info.codecDescription=(0,m.io)(e,i),"aac"===t.info.codec){let e=(0,s.zF)(t.info.codecDescription);null!==e.numberOfChannels&&(t.info.numberOfChannels=e.numberOfChannels),null!==e.sampleRate&&(t.info.sampleRate=e.sampleRate)}}}break;case"enda":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="audio"),255&(0,m.mH)(e)&&("pcm-s16be"===t.info.codec?t.info.codec="pcm-s16":"pcm-s24be"===t.info.codec?t.info.codec="pcm-s24":"pcm-s32be"===t.info.codec?t.info.codec="pcm-s32":"pcm-f32be"===t.info.codec?t.info.codec="pcm-f32":"pcm-f64be"===t.info.codec&&(t.info.codec="pcm-f64"))}break;case"pcmC":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="audio"),e.skip(4);let r=!!(1&(0,m.eo)(e)),i=(0,m.eo)(e);"pcm-s16be"===t.info.codec?r?16===i?t.info.codec="pcm-s16":24===i?t.info.codec="pcm-s24":32===i?t.info.codec="pcm-s32":(console.warn(`Invalid ipcm sample size ${i}.`),t.info.codec=null):16===i?t.info.codec="pcm-s16be":24===i?t.info.codec="pcm-s24be":32===i?t.info.codec="pcm-s32be":(console.warn(`Invalid ipcm sample size ${i}.`),t.info.codec=null):"pcm-f32be"===t.info.codec&&(r?32===i?t.info.codec="pcm-f32":64===i?t.info.codec="pcm-f64":(console.warn(`Invalid fpcm sample size ${i}.`),t.info.codec=null):32===i?t.info.codec="pcm-f32be":64===i?t.info.codec="pcm-f64be":(console.warn(`Invalid fpcm sample size ${i}.`),t.info.codec=null));break}case"dOps":{let t;let r=this.currentTrack;if(!r)break;(0,d.vA)(r.info?.type==="audio"),e.skip(1);let i=(0,m.eo)(e),a=(0,m.mH)(e),n=(0,m.cN)(e),s=(0,m.iH)(e),o=(0,m.eo)(e);t=0!==o?(0,m.io)(e,2+i):new Uint8Array(0);let l=new Uint8Array(19+t.byteLength),c=new DataView(l.buffer);c.setUint32(0,0x4f707573,!1),c.setUint32(4,0x48656164,!1),c.setUint8(8,1),c.setUint8(9,i),c.setUint16(10,a,!0),c.setUint32(12,n,!0),c.setInt16(16,s,!0),c.setUint8(18,o),l.set(t,19),r.info.codecDescription=l,r.info.numberOfChannels=i}break;case"dfLa":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.info?.type==="audio"),e.skip(4);let r=e.filePos;for(;e.filePos<a;){let r=(0,m.eo)(e),i=(0,m.n2)(e);if((127&r)===o.A3.STREAMINFO){e.skip(10);let r=(0,m.cN)(e),i=r>>>12,a=(r>>9&7)+1;t.info.sampleRate=i,t.info.numberOfChannels=a,e.skip(20)}else e.skip(i);if(128&r)break}let i=e.filePos;e.filePos=r;let n=(0,m.io)(e,i-r),s=new Uint8Array(4+n.byteLength);new DataView(s.buffer).setUint32(0,0x664c6143,!1),s.set(n,4),t.info.codecDescription=s}break;case"stts":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e),i=0,a=0;for(let n=0;n<r;n++){let r=(0,m.cN)(e),n=(0,m.cN)(e);t.sampleTable.sampleTimingEntries.push({startIndex:i,startDecodeTimestamp:a,count:r,delta:n}),i+=r,a+=r*n}}break;case"ctts":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e),i=0;for(let a=0;a<r;a++){let r=(0,m.cN)(e),a=(0,m.Ar)(e);t.sampleTable.sampleCompositionTimeOffsets.push({startIndex:i,count:r,offset:a}),i+=r}}break;case"stsz":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e),i=(0,m.cN)(e);if(0===r)for(let r=0;r<i;r++){let r=(0,m.cN)(e);t.sampleTable.sampleSizes.push(r)}else t.sampleTable.sampleSizes.push(r)}break;case"stz2":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4),e.skip(3);let r=(0,m.eo)(e),i=(0,m.cN)(e),a=(0,m.io)(e,Math.ceil(i*r/8)),n=new d._c(a);for(let e=0;e<i;e++){let e=n.readBits(r);t.sampleTable.sampleSizes.push(e)}}break;case"stss":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4),t.sampleTable.keySampleIndices=[];let r=(0,m.cN)(e);for(let i=0;i<r;i++){let r=(0,m.cN)(e)-1;t.sampleTable.keySampleIndices.push(r)}0!==t.sampleTable.keySampleIndices[0]&&t.sampleTable.keySampleIndices.unshift(0)}break;case"stsc":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e);for(let i=0;i<r;i++){let r=(0,m.cN)(e)-1,i=(0,m.cN)(e),a=(0,m.cN)(e);t.sampleTable.sampleToChunk.push({startSampleIndex:-1,startChunkIndex:r,samplesPerChunk:i,sampleDescriptionIndex:a})}let i=0;for(let e=0;e<t.sampleTable.sampleToChunk.length;e++)t.sampleTable.sampleToChunk[e].startSampleIndex=i,e<t.sampleTable.sampleToChunk.length-1&&(i+=(t.sampleTable.sampleToChunk[e+1].startChunkIndex-t.sampleTable.sampleToChunk[e].startChunkIndex)*t.sampleTable.sampleToChunk[e].samplesPerChunk)}break;case"stco":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e);for(let i=0;i<r;i++){let r=(0,m.cN)(e);t.sampleTable.chunkOffsets.push(r)}}break;case"co64":{let t=this.currentTrack;if(!t||!t.sampleTable)break;e.skip(4);let r=(0,m.cN)(e);for(let i=0;i<r;i++){let r=(0,m.th)(e);t.sampleTable.chunkOffsets.push(r)}}break;case"mvex":this.isFragmented=!0,this.readContiguousBoxes(e.slice(i,r.contentSize));break;case"mehd":{let t=(0,m.eo)(e);e.skip(3);let r=1===t?(0,m.th)(e):(0,m.cN)(e);this.movieDurationInTimescale=r}break;case"trex":{e.skip(4);let t=(0,m.cN)(e),r=(0,m.cN)(e),i=(0,m.cN)(e),a=(0,m.cN)(e),n=(0,m.cN)(e);this.fragmentTrackDefaults.push({trackId:t,defaultSampleDescriptionIndex:r,defaultSampleDuration:i,defaultSampleSize:a,defaultSampleFlags:n})}break;case"tfra":{let t=(0,m.eo)(e);e.skip(3);let r=(0,m.cN)(e),i=this.tracks.find(e=>e.id===r);if(!i)break;let a=(0,m.cN)(e),n=[m.eo,m.mH,m.n2,m.cN],s=n[(48&a)>>4],o=n[(12&a)>>2],l=n[3&a],c=(0,m.cN)(e);for(let r=0;r<c;r++){let r=1===t?(0,m.th)(e):(0,m.cN)(e),a=1===t?(0,m.th)(e):(0,m.cN)(e);s(e),o(e),l(e),i.fragmentLookupTable.push({timestamp:r,moofOffset:a})}i.fragmentLookupTable.sort((e,t)=>e.timestamp-t.timestamp);for(let e=0;e<i.fragmentLookupTable.length-1;e++){let t=i.fragmentLookupTable[e],r=i.fragmentLookupTable[e+1];t.timestamp===r.timestamp&&(i.fragmentLookupTable.splice(e+1,1),e--)}}break;case"moof":this.currentFragment={moofOffset:t,moofSize:r.totalSize,implicitBaseDataOffset:t,trackData:new Map},this.readContiguousBoxes(e.slice(i,r.contentSize)),this.lastReadFragment=this.currentFragment,this.currentFragment=null;break;case"traf":if((0,d.vA)(this.currentFragment),this.readContiguousBoxes(e.slice(i,r.contentSize)),this.currentTrack){let e=this.currentFragment.trackData.get(this.currentTrack.id);if(e){let{currentFragmentState:t}=this.currentTrack;(0,d.vA)(t),null!==t.startTimestamp&&(S(e,t.startTimestamp),e.startTimestampIsFinal=!0)}this.currentTrack.currentFragmentState=null,this.currentTrack=null}break;case"tfhd":{(0,d.vA)(this.currentFragment),e.skip(1);let t=(0,m.n2)(e),r=(0,m.cN)(e),i=this.tracks.find(e=>e.id===r);if(!i)break;let a=this.fragmentTrackDefaults.find(e=>e.trackId===r);this.currentTrack=i,i.currentFragmentState={baseDataOffset:this.currentFragment.implicitBaseDataOffset,sampleDescriptionIndex:a?.defaultSampleDescriptionIndex??null,defaultSampleDuration:a?.defaultSampleDuration??null,defaultSampleSize:a?.defaultSampleSize??null,defaultSampleFlags:a?.defaultSampleFlags??null,startTimestamp:null},1&t?i.currentFragmentState.baseDataOffset=(0,m.th)(e):131072&t&&(i.currentFragmentState.baseDataOffset=this.currentFragment.moofOffset),2&t&&(i.currentFragmentState.sampleDescriptionIndex=(0,m.cN)(e)),8&t&&(i.currentFragmentState.defaultSampleDuration=(0,m.cN)(e)),16&t&&(i.currentFragmentState.defaultSampleSize=(0,m.cN)(e)),32&t&&(i.currentFragmentState.defaultSampleFlags=(0,m.cN)(e)),65536&t&&(i.currentFragmentState.defaultSampleDuration=0)}break;case"tfdt":{let t=this.currentTrack;if(!t)break;(0,d.vA)(t.currentFragmentState);let r=(0,m.eo)(e);e.skip(3);let i=0===r?(0,m.cN)(e):(0,m.th)(e);t.currentFragmentState.startTimestamp=i}break;case"trun":{let t=this.currentTrack;if(!t)break;if((0,d.vA)(this.currentFragment),(0,d.vA)(t.currentFragmentState),this.currentFragment.trackData.has(t.id)){console.warn("Can't have two trun boxes for the same track in one fragment. Ignoring...");break}let r=(0,m.eo)(e),i=(0,m.n2)(e),a=!!(256&i),n=!!(512&i),s=!!(1024&i),o=!!(2048&i),l=(0,m.cN)(e),c=t.currentFragmentState.baseDataOffset;1&i&&(c+=(0,m.Ar)(e));let u=null;4&i&&(u=(0,m.cN)(e));let h=c;if(0===l){this.currentFragment.implicitBaseDataOffset=h;break}let f=0,p={track:t,startTimestamp:0,endTimestamp:0,firstKeyFrameTimestamp:null,samples:[],presentationTimestamps:[],startTimestampIsFinal:!1};this.currentFragment.trackData.set(t.id,p);for(let i=0;i<l;i++){let l,c,g;a?l=(0,m.cN)(e):((0,d.vA)(null!==t.currentFragmentState.defaultSampleDuration),l=t.currentFragmentState.defaultSampleDuration),n?c=(0,m.cN)(e):((0,d.vA)(null!==t.currentFragmentState.defaultSampleSize),c=t.currentFragmentState.defaultSampleSize),s?g=(0,m.cN)(e):((0,d.vA)(null!==t.currentFragmentState.defaultSampleFlags),g=t.currentFragmentState.defaultSampleFlags),0===i&&null!==u&&(g=u);let y=0;o&&(y=0===r?(0,m.cN)(e):(0,m.Ar)(e));let b=!(65536&g);p.samples.push({presentationTimestamp:f+y,duration:l,byteOffset:h,byteSize:c,isKeyFrame:b}),h+=c,f+=l}p.presentationTimestamps=p.samples.map((e,t)=>({presentationTimestamp:e.presentationTimestamp,sampleIndex:t})).sort((e,t)=>e.presentationTimestamp-t.presentationTimestamp);for(let e=0;e<p.presentationTimestamps.length;e++){let t=p.presentationTimestamps[e],r=p.samples[t.sampleIndex];null===p.firstKeyFrameTimestamp&&r.isKeyFrame&&(p.firstKeyFrameTimestamp=r.presentationTimestamp),e<p.presentationTimestamps.length-1&&(r.duration=p.presentationTimestamps[e+1].presentationTimestamp-t.presentationTimestamp)}let g=p.samples[p.presentationTimestamps[0].sampleIndex],y=p.samples[(0,d._g)(p.presentationTimestamps).sampleIndex];p.startTimestamp=g.presentationTimestamp,p.endTimestamp=y.presentationTimestamp+y.duration,this.currentFragment.implicitBaseDataOffset=h}break;case"udta":for(let{boxInfo:t,slice:a}of this.iterateContiguousBoxes(e.slice(i,r.contentSize))){if("meta"!==t.name&&!this.currentTrack){let e=a.filePos;this.metadataTags.raw??={},"\xa9"===t.name[0]?this.metadataTags.raw[t.name]??=(0,f.$L)(a):this.metadataTags.raw[t.name]??=(0,m.io)(a,t.contentSize),a.filePos=e}switch(t.name){case"meta":a.skip(-t.headerSize),this.traverseBox(a);break;case"\xa9nam":case"name":this.currentTrack?this.currentTrack.name=d.su.decode((0,m.io)(a,t.contentSize)):this.metadataTags.title??=(0,f.$L)(a);break;case"\xa9des":this.currentTrack||(this.metadataTags.description??=(0,f.$L)(a));break;case"\xa9ART":this.currentTrack||(this.metadataTags.artist??=(0,f.$L)(a));break;case"\xa9alb":this.currentTrack||(this.metadataTags.album??=(0,f.$L)(a));break;case"albr":this.currentTrack||(this.metadataTags.albumArtist??=(0,f.$L)(a));break;case"\xa9gen":this.currentTrack||(this.metadataTags.genre??=(0,f.$L)(a));break;case"\xa9day":if(!this.currentTrack){let e=new Date((0,f.$L)(a));Number.isNaN(e.getTime())||(this.metadataTags.date??=e)}break;case"\xa9cmt":this.currentTrack||(this.metadataTags.comment??=(0,f.$L)(a));break;case"\xa9lyr":this.currentTrack||(this.metadataTags.lyrics??=(0,f.$L)(a))}}break;case"meta":{if(this.currentTrack)break;let t=(0,m.cN)(e);this.currentMetadataKeys=new Map,0!==t?this.readContiguousBoxes(e.slice(i,r.contentSize)):this.readContiguousBoxes(e.slice(i+4,r.contentSize-4)),this.currentMetadataKeys=null}break;case"keys":{if(!this.currentMetadataKeys)break;e.skip(4);let t=(0,m.cN)(e);for(let r=0;r<t;r++){let t=(0,m.cN)(e);e.skip(4);let i=d.su.decode((0,m.io)(e,t-8));this.currentMetadataKeys.set(r+1,i)}}break;case"ilst":if(!this.currentMetadataKeys)break;for(let{boxInfo:t,slice:a}of this.iterateContiguousBoxes(e.slice(i,r.contentSize))){let e=t.name,r=(e.charCodeAt(0)<<24)+(e.charCodeAt(1)<<16)+(e.charCodeAt(2)<<8)+e.charCodeAt(3);this.currentMetadataKeys.has(r)&&(e=this.currentMetadataKeys.get(r));let i=(0,f.Cp)(a);switch(this.metadataTags.raw??={},this.metadataTags.raw[e]??=i,e){case"\xa9nam":case"titl":case"com.apple.quicktime.title":case"title":"string"==typeof i&&(this.metadataTags.title??=i);break;case"\xa9des":case"desc":case"dscp":case"com.apple.quicktime.description":case"description":"string"==typeof i&&(this.metadataTags.description??=i);break;case"\xa9ART":case"com.apple.quicktime.artist":case"artist":"string"==typeof i&&(this.metadataTags.artist??=i);break;case"\xa9alb":case"albm":case"com.apple.quicktime.album":case"album":"string"==typeof i&&(this.metadataTags.album??=i);break;case"aART":case"album_artist":"string"==typeof i&&(this.metadataTags.albumArtist??=i);break;case"\xa9cmt":case"com.apple.quicktime.comment":case"comment":"string"==typeof i&&(this.metadataTags.comment??=i);break;case"\xa9gen":case"gnre":case"com.apple.quicktime.genre":case"genre":"string"==typeof i&&(this.metadataTags.genre??=i);break;case"\xa9lyr":case"lyrics":"string"==typeof i&&(this.metadataTags.lyrics??=i);break;case"\xa9day":case"rldt":case"com.apple.quicktime.creationdate":case"date":if("string"==typeof i){let e=new Date(i);Number.isNaN(e.getTime())||(this.metadataTags.date??=e)}break;case"covr":case"com.apple.quicktime.artwork":i instanceof p.sF?(this.metadataTags.images??=[],this.metadataTags.images.push({data:i.data,kind:"coverFront",mimeType:i.mimeType})):i instanceof Uint8Array&&(this.metadataTags.images??=[],this.metadataTags.images.push({data:i,kind:"coverFront",mimeType:"image/*"}));break;case"track":if("string"==typeof i){let e=i.split("/"),t=Number.parseInt(e[0],10),r=e[1]&&Number.parseInt(e[1],10);Number.isInteger(t)&&t>0&&(this.metadataTags.trackNumber??=t),r&&Number.isInteger(r)&&r>0&&(this.metadataTags.tracksTotal??=r)}break;case"trkn":if(i instanceof Uint8Array&&i.length>=6){let e=(0,d.Zc)(i),t=e.getUint16(2,!1),r=e.getUint16(4,!1);t>0&&(this.metadataTags.trackNumber??=t),r>0&&(this.metadataTags.tracksTotal??=r)}break;case"disc":case"disk":if(i instanceof Uint8Array&&i.length>=6){let e=(0,d.Zc)(i),t=e.getUint16(2,!1),r=e.getUint16(4,!1);t>0&&(this.metadataTags.discNumber??=t),r>0&&(this.metadataTags.discsTotal??=r)}}}}return e.filePos=a,!0}}class y{constructor(e){this.internalTrack=e,this.packetToSampleIndex=new WeakMap,this.packetToFragmentLocation=new WeakMap}getId(){return this.internalTrack.id}getCodec(){throw Error("Not implemented on base class.")}getInternalCodecId(){return this.internalTrack.internalCodecId}getName(){return this.internalTrack.name}getLanguageCode(){return this.internalTrack.languageCode}getTimeResolution(){return this.internalTrack.timescale}getDisposition(){return this.internalTrack.disposition}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}async getFirstTimestamp(){let e=await this.getFirstPacket({metadataOnly:!0});return e?.timestamp??0}async getFirstPacket(e){let t=await this.fetchPacketForSampleIndex(0,e);return t||!this.internalTrack.demuxer.isFragmented?t:this.performFragmentedLookup(null,e=>e.trackData.get(this.internalTrack.id)?{sampleIndex:0,correctSampleFound:!0}:{sampleIndex:-1,correctSampleFound:!1},-1/0,1/0,e)}mapTimestampIntoTimescale(e){return(0,d.aI)(e*this.internalTrack.timescale)+this.internalTrack.editListOffset}async getPacket(e,t){let r=this.mapTimestampIntoTimescale(e),i=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),a=w(i,r),n=await this.fetchPacketForSampleIndex(a,t);return P(i)&&this.internalTrack.demuxer.isFragmented?this.performFragmentedLookup(null,e=>{let t=e.trackData.get(this.internalTrack.id);if(!t)return{sampleIndex:-1,correctSampleFound:!1};let i=(0,d.eE)(t.presentationTimestamps,r,e=>e.presentationTimestamp);return{sampleIndex:-1!==i?t.presentationTimestamps[i].sampleIndex:-1,correctSampleFound:-1!==i&&r<t.endTimestamp}},r,r,t):n}async getNextPacket(e,t){let r=this.packetToSampleIndex.get(e);if(void 0!==r)return this.fetchPacketForSampleIndex(r+1,t);let i=this.packetToFragmentLocation.get(e);if(void 0===i)throw Error("Packet was not created from this track.");return this.performFragmentedLookup(i.fragment,e=>{if(e===i.fragment){let t=e.trackData.get(this.internalTrack.id);if(i.sampleIndex+1<t.samples.length)return{sampleIndex:i.sampleIndex+1,correctSampleFound:!0}}else if(e.trackData.get(this.internalTrack.id))return{sampleIndex:0,correctSampleFound:!0};return{sampleIndex:-1,correctSampleFound:!1}},-1/0,1/0,t)}async getKeyPacket(e,t){let r=this.mapTimestampIntoTimescale(e),i=this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),a=v(i,r),n=await this.fetchPacketForSampleIndex(a,t);return P(i)&&this.internalTrack.demuxer.isFragmented?this.performFragmentedLookup(null,e=>{let t=e.trackData.get(this.internalTrack.id);if(!t)return{sampleIndex:-1,correctSampleFound:!1};let i=(0,d.Kl)(t.presentationTimestamps,e=>t.samples[e.sampleIndex].isKeyFrame&&e.presentationTimestamp<=r);return{sampleIndex:-1!==i?t.presentationTimestamps[i].sampleIndex:-1,correctSampleFound:-1!==i&&r<t.endTimestamp}},r,r,t):n}async getNextKeyPacket(e,t){let r=this.packetToSampleIndex.get(e);if(void 0!==r){let e=T(this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),r);return this.fetchPacketForSampleIndex(e,t)}let i=this.packetToFragmentLocation.get(e);if(void 0===i)throw Error("Packet was not created from this track.");return this.performFragmentedLookup(i.fragment,e=>{if(e===i.fragment){let t=e.trackData.get(this.internalTrack.id).samples.findIndex((e,t)=>e.isKeyFrame&&t>i.sampleIndex);if(-1!==t)return{sampleIndex:t,correctSampleFound:!0}}else{let t=e.trackData.get(this.internalTrack.id);if(t&&null!==t.firstKeyFrameTimestamp){let e=t.samples.findIndex(e=>e.isKeyFrame);return(0,d.vA)(-1!==e),{sampleIndex:e,correctSampleFound:!0}}}return{sampleIndex:-1,correctSampleFound:!1}},-1/0,1/0,t)}async fetchPacketForSampleIndex(e,t){let r;if(-1===e)return null;let i=x(this.internalTrack.demuxer.getSampleTableForTrack(this.internalTrack),e);if(!i)return null;if(t.metadataOnly)r=u.T;else{let e=this.internalTrack.demuxer.reader.requestSlice(i.sampleOffset,i.sampleSize);e instanceof Promise&&(e=await e),(0,d.vA)(e),r=(0,m.io)(e,i.sampleSize)}let a=(i.presentationTimestamp-this.internalTrack.editListOffset)/this.internalTrack.timescale,n=i.duration/this.internalTrack.timescale,s=new u.Z(r,i.isKeyFrame?"key":"delta",a,n,e,i.sampleSize);return this.packetToSampleIndex.set(s,e),s}async fetchPacketInFragment(e,t,r){let i;if(-1===t)return null;let a=e.trackData.get(this.internalTrack.id).samples[t];if((0,d.vA)(a),r.metadataOnly)i=u.T;else{let e=this.internalTrack.demuxer.reader.requestSlice(a.byteOffset,a.byteSize);e instanceof Promise&&(e=await e),(0,d.vA)(e),i=(0,m.io)(e,a.byteSize)}let n=(a.presentationTimestamp-this.internalTrack.editListOffset)/this.internalTrack.timescale,s=a.duration/this.internalTrack.timescale,o=new u.Z(i,a.isKeyFrame?"key":"delta",n,s,e.moofOffset+t,a.byteSize);return this.packetToFragmentLocation.set(o,{fragment:e,sampleIndex:t}),o}async performFragmentedLookup(e,t,r,i,a){let n;let s=this.internalTrack.demuxer,o=null,l=null,c=-1;if(e){let{sampleIndex:r,correctSampleFound:i}=t(e);if(i)return this.fetchPacketInFragment(e,r,a);-1!==r&&(l=e,c=r)}let u=(0,d.eE)(this.internalTrack.fragmentLookupTable,r,e=>e.timestamp),h=-1!==u?this.internalTrack.fragmentLookupTable[u]:null,m=(0,d.eE)(this.internalTrack.fragmentPositionCache,r,e=>e.startTimestamp),p=-1!==m?this.internalTrack.fragmentPositionCache[m]:null,g=Math.max(h?.moofOffset??0,p?.moofOffset??0)||null;for(e?null===g||e.moofOffset>=g?(n=e.moofOffset+e.moofSize,o=e):n=g:n=g??0;;){if(o){let e=o.trackData.get(this.internalTrack.id);if(e&&e.startTimestamp>i)break}let e=s.reader.requestSliceRange(n,f.ZM,f.Xk);if(e instanceof Promise&&(e=await e),!e)break;let r=n,d=(0,f.Vl)(e);if(!d)break;if("moof"===d.name){let{sampleIndex:e,correctSampleFound:i}=t(o=await s.readFragment(r));if(i)return this.fetchPacketInFragment(o,e,a);-1!==e&&(l=o,c=e)}n=r+d.totalSize}if(h&&(!l||l.moofOffset<h.moofOffset)){let e=this.internalTrack.fragmentLookupTable[u-1];(0,d.vA)(!e||e.timestamp<h.timestamp);let r=e?.timestamp??-1/0;return this.performFragmentedLookup(null,t,r,i,a)}return l?this.fetchPacketInFragment(l,c,a):null}}class b extends y{constructor(e){super(e),this.decoderConfigPromise=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getCodedWidth(){return this.internalTrack.info.width}getCodedHeight(){return this.internalTrack.info.height}getRotation(){return this.internalTrack.rotation}async getColorSpace(){return{primaries:this.internalTrack.info.colorSpace?.primaries,transfer:this.internalTrack.info.colorSpace?.transfer,matrix:this.internalTrack.info.colorSpace?.matrix,fullRange:this.internalTrack.info.colorSpace?.fullRange}}async canBeTransparent(){return!1}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfigPromise??=(async()=>{if("vp9"!==this.internalTrack.info.codec||this.internalTrack.info.vp9CodecInfo){if("av1"===this.internalTrack.info.codec&&!this.internalTrack.info.av1CodecInfo){let e=await this.getFirstPacket({});this.internalTrack.info.av1CodecInfo=e&&(0,o.UU)(e.data)}}else{let e=await this.getFirstPacket({});this.internalTrack.info.vp9CodecInfo=e&&(0,o.bs)(e.data)}return{codec:(0,s.QP)(this.internalTrack.info),codedWidth:this.internalTrack.info.width,codedHeight:this.internalTrack.info.height,description:this.internalTrack.info.codecDescription??void 0,colorSpace:this.internalTrack.info.colorSpace??void 0}})():null}}class k extends y{constructor(e){super(e),this.decoderConfig=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getNumberOfChannels(){return this.internalTrack.info.numberOfChannels}getSampleRate(){return this.internalTrack.info.sampleRate}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfig??={codec:(0,s.X0)(this.internalTrack.info),numberOfChannels:this.internalTrack.info.numberOfChannels,sampleRate:this.internalTrack.info.sampleRate,description:this.internalTrack.info.codecDescription??void 0}:null}}let w=(e,t)=>{if(e.presentationTimestamps){let r=(0,d.eE)(e.presentationTimestamps,t,e=>e.presentationTimestamp);return -1===r?-1:e.presentationTimestamps[r].sampleIndex}{let r=(0,d.eE)(e.sampleTimingEntries,t,e=>e.startDecodeTimestamp);if(-1===r)return -1;let i=e.sampleTimingEntries[r];return i.startIndex+Math.min(Math.floor((t-i.startDecodeTimestamp)/i.delta),i.count-1)}},v=(e,t)=>{if(!e.keySampleIndices)return w(e,t);if(e.presentationTimestamps){let r=(0,d.eE)(e.presentationTimestamps,t,e=>e.presentationTimestamp);if(-1===r)return -1;for(let t=r;t>=0;t--){let r=e.presentationTimestamps[t].sampleIndex;if(-1!==(0,d.pl)(e.keySampleIndices,r,e=>e))return r}return -1}{let r=w(e,t),i=(0,d.eE)(e.keySampleIndices,r,e=>e);return e.keySampleIndices[i]??-1}},x=(e,t)=>{let r=(0,d.eE)(e.sampleTimingEntries,t,e=>e.startIndex),i=e.sampleTimingEntries[r];if(!i||i.startIndex+i.count<=t)return null;let a=i.startDecodeTimestamp+(t-i.startIndex)*i.delta,n=(0,d.eE)(e.sampleCompositionTimeOffsets,t,e=>e.startIndex),s=e.sampleCompositionTimeOffsets[n];s&&t-s.startIndex<s.count&&(a+=s.offset);let o=e.sampleSizes[Math.min(t,e.sampleSizes.length-1)],l=(0,d.eE)(e.sampleToChunk,t,e=>e.startSampleIndex),c=e.sampleToChunk[l];(0,d.vA)(c);let u=c.startChunkIndex+Math.floor((t-c.startSampleIndex)/c.samplesPerChunk),h=e.chunkOffsets[u],f=c.startSampleIndex+(u-c.startChunkIndex)*c.samplesPerChunk,m=0,p=h;if(1===e.sampleSizes.length)p+=o*(t-f),m+=o*c.samplesPerChunk;else for(let r=f;r<f+c.samplesPerChunk;r++){let i=e.sampleSizes[r];r<t&&(p+=i),m+=i}let g=i.delta;if(e.presentationTimestamps){let r=e.presentationTimestampIndexMap[t];(0,d.vA)(void 0!==r),r<e.presentationTimestamps.length-1&&(g=e.presentationTimestamps[r+1].presentationTimestamp-a)}return{presentationTimestamp:a,duration:g,sampleOffset:p,sampleSize:o,chunkOffset:h,chunkSize:m,isKeyFrame:!e.keySampleIndices||-1!==(0,d.pl)(e.keySampleIndices,t,e=>e)}},T=(e,t)=>{if(!e.keySampleIndices)return t+1;let r=(0,d.eE)(e.keySampleIndices,t,e=>e);return e.keySampleIndices[r+1]??-1},S=(e,t)=>{for(let r of(e.startTimestamp+=t,e.endTimestamp+=t,e.samples))r.presentationTimestamp+=t;for(let r of e.presentationTimestamps)r.presentationTimestamp+=t},C=e=>{let[t,,,r]=e,i=Math.hypot(t,r),a=-(180/Math.PI*Math.atan2(r/i,t/i));return Number.isFinite(a)?a:0},P=e=>0===e.sampleSizes.length;var I=r(4747),E=r(662);!function(e){e[e.None=0]="None",e[e.Xiph=1]="Xiph",e[e.FixedSize=2]="FixedSize",e[e.Ebml=3]="Ebml"}(i||(i={})),function(e){e[e.Block=1]="Block",e[e.Private=2]="Private",e[e.Next=4]="Next"}(a||(a={})),function(e){e[e.Zlib=0]="Zlib",e[e.Bzlib=1]="Bzlib",e[e.lzo1x=2]="lzo1x",e[e.HeaderStripping=3]="HeaderStripping"}(n||(n={}));let A=[{id:I.Cl.SeekHead,flag:"seekHeadSeen"},{id:I.Cl.Info,flag:"infoSeen"},{id:I.Cl.Tracks,flag:"tracksSeen"},{id:I.Cl.Cues,flag:"cuesSeen"}];class M extends l.B{constructor(e){super(e),this.readMetadataPromise=null,this.segments=[],this.currentSegment=null,this.currentTrack=null,this.currentCluster=null,this.currentBlock=null,this.currentBlockAdditional=null,this.currentCueTime=null,this.currentDecodingInstruction=null,this.currentTagTargetIsMovie=!0,this.currentSimpleTagName=null,this.currentAttachedFile=null,this.isWebM=!1,this.reader=e._reader}async computeDuration(){let e=await this.getTracks();return Math.max(0,...await Promise.all(e.map(e=>e.computeDuration())))}async getTracks(){return await this.readMetadata(),this.segments.flatMap(e=>e.tracks.map(e=>e.inputTrack))}async getMimeType(){await this.readMetadata();let e=await this.getTracks(),t=await Promise.all(e.map(e=>e.getCodecParameterString()));return(0,E.V)({isWebM:this.isWebM,hasVideo:this.segments.some(e=>e.tracks.some(e=>e.info?.type==="video")),hasAudio:this.segments.some(e=>e.tracks.some(e=>e.info?.type==="audio")),codecStrings:t.filter(Boolean)})}async getMetadataTags(){for(let e of(await this.readMetadata(),this.segments))e.metadataTagsCollected||(null!==this.reader.fileSize&&await this.loadSegmentMetadata(e),e.metadataTagsCollected=!0);let e={};for(let t of this.segments)e={...e,...t.metadataTags};return e}readMetadata(){return this.readMetadataPromise??=(async()=>{let e=0;for(;;){let t=this.reader.requestSliceRange(e,I.De,I.r1);if(t instanceof Promise&&(t=await t),!t)break;let r=(0,I.ur)(t);if(!r)break;let i=r.id,a=r.size,n=t.filePos;if(i===I.Cl.EBML){(0,I.p)(a);let e=this.reader.requestSlice(n,a);if(e instanceof Promise&&(e=await e),!e)break;this.readContiguousElements(e)}else if(i===I.Cl.Segment){if(await this.readSegment(n,a),void 0===a||null===this.reader.fileSize)break}else if(i===I.Cl.Cluster){if(null===this.reader.fileSize)break;void 0===a&&(a=(await (0,I.IQ)(this.reader,n,I.K9,this.reader.fileSize)).pos-n);let e=(0,d._g)(this.segments);e&&(e.elementEndPos=n+a)}(0,I.p)(a),e=n+a}})()}async readSegment(e,t){this.currentSegment={seekHeadSeen:!1,infoSeen:!1,tracksSeen:!1,cuesSeen:!1,tagsSeen:!1,attachmentsSeen:!1,timestampScale:-1,timestampFactor:-1,duration:-1,seekEntries:[],tracks:[],cuePoints:[],dataStartPos:e,elementEndPos:void 0===t?null:e+t,clusterSeekStartPos:e,lastReadCluster:null,metadataTags:{},metadataTagsCollected:!1},this.segments.push(this.currentSegment);let r=e;for(;null===this.currentSegment.elementEndPos||r<this.currentSegment.elementEndPos;){let e=this.reader.requestSliceRange(r,I.De,I.r1);if(e instanceof Promise&&(e=await e),!e)break;let t=r,i=(0,I.ur)(e);if(!i||!I.VE.includes(i.id)&&i.id!==I.Cl.Void){let e=await (0,I.nE)(this.reader,t,I.VE,Math.min(this.currentSegment.elementEndPos??1/0,t+0xa00000));if(e){r=e;continue}break}let{id:a,size:n}=i,s=e.filePos,o=A.findIndex(e=>e.id===a);if(-1!==o){let e=A[o].flag;this.currentSegment[e]=!0,(0,I.p)(n);let t=this.reader.requestSlice(s,n);t instanceof Promise&&(t=await t),t&&this.readContiguousElements(t)}else if(a===I.Cl.Tags||a===I.Cl.Attachments){a===I.Cl.Tags?this.currentSegment.tagsSeen=!0:this.currentSegment.attachmentsSeen=!0,(0,I.p)(n);let e=this.reader.requestSlice(s,n);e instanceof Promise&&(e=await e),e&&this.readContiguousElements(e)}else if(a===I.Cl.Cluster){this.currentSegment.clusterSeekStartPos=t;break}if(void 0===n)break;r=s+n}if(this.currentSegment.seekEntries.sort((e,t)=>e.segmentPosition-t.segmentPosition),null!==this.reader.fileSize)for(let t of this.currentSegment.seekEntries){let r=A.find(e=>e.id===t.id);if(!r||this.currentSegment[r.flag])continue;let i=this.reader.requestSliceRange(e+t.segmentPosition,I.De,I.r1);if(i instanceof Promise&&(i=await i),!i)continue;let a=(0,I.ur)(i);if(!a)continue;let{id:n,size:s}=a;if(n!==r.id)continue;(0,I.p)(s),this.currentSegment[r.flag]=!0;let o=this.reader.requestSlice(i.filePos,s);o instanceof Promise&&(o=await o),o&&this.readContiguousElements(o)}for(let e of(-1===this.currentSegment.timestampScale&&(this.currentSegment.timestampScale=1e6,this.currentSegment.timestampFactor=1e3),this.currentSegment.tracks))null!==e.defaultDurationNs&&(e.defaultDuration=this.currentSegment.timestampFactor*e.defaultDurationNs/1e9);this.currentSegment.tracks.sort((e,t)=>Number(t.disposition.default)-Number(e.disposition.default));let i=new Map(this.currentSegment.tracks.map(e=>[e.id,e]));for(let e of this.currentSegment.cuePoints){let t=i.get(e.trackId);t&&t.cuePoints.push(e)}for(let e of this.currentSegment.tracks){e.cuePoints.sort((e,t)=>e.time-t.time);for(let t=0;t<e.cuePoints.length-1;t++){let r=e.cuePoints[t],i=e.cuePoints[t+1];r.time===i.time&&(e.cuePoints.splice(t+1,1),t--)}}let a=null,n=-1/0;for(let e of this.currentSegment.tracks)e.cuePoints.length>n&&(n=e.cuePoints.length,a=e);for(let e of this.currentSegment.tracks)0===e.cuePoints.length&&(e.cuePoints=a.cuePoints);this.currentSegment=null}async readCluster(e,t){if(t.lastReadCluster?.elementStartPos===e)return t.lastReadCluster;let r=this.reader.requestSliceRange(e,I.De,I.r1);r instanceof Promise&&(r=await r),(0,d.vA)(r);let a=(0,I.ur)(r);(0,d.vA)(a);let n=a.id;(0,d.vA)(n===I.Cl.Cluster);let s=a.size,o=r.filePos;void 0===s&&(s=(await (0,I.IQ)(this.reader,o,I.K9,t.elementEndPos)).pos-o);let l=this.reader.requestSlice(o,s);l instanceof Promise&&(l=await l);let c={segment:t,elementStartPos:e,elementEndPos:o+s,dataStartPos:o,timestamp:-1,trackData:new Map};for(let[,t]of(this.currentCluster=c,l&&(c.elementEndPos=this.readContiguousElements(l,I.K9)),c.trackData)){let r=t.track;(0,d.vA)(t.blocks.length>0);let a=!1;for(let e=0;e<t.blocks.length;e++){let r=t.blocks[e];r.timestamp+=c.timestamp,a||=r.lacing!==i.None}t.presentationTimestamps=t.blocks.map((e,t)=>({timestamp:e.timestamp,blockIndex:t})).sort((e,t)=>e.timestamp-t.timestamp);for(let e=0;e<t.presentationTimestamps.length;e++){let a=t.presentationTimestamps[e],n=t.blocks[a.blockIndex];null===t.firstKeyFrameTimestamp&&n.isKeyFrame&&(t.firstKeyFrameTimestamp=n.timestamp),e<t.presentationTimestamps.length-1?n.duration=t.presentationTimestamps[e+1].timestamp-n.timestamp:0===n.duration&&null!=r.defaultDuration&&n.lacing===i.None&&(n.duration=r.defaultDuration)}a&&(this.expandLacedBlocks(t.blocks,r),t.presentationTimestamps=t.blocks.map((e,t)=>({timestamp:e.timestamp,blockIndex:t})).sort((e,t)=>e.timestamp-t.timestamp));let n=t.blocks[t.presentationTimestamps[0].blockIndex],s=t.blocks[(0,d._g)(t.presentationTimestamps).blockIndex];t.startTimestamp=n.timestamp,t.endTimestamp=s.timestamp+s.duration;let o=(0,d.eE)(r.clusterPositionCache,t.startTimestamp,e=>e.startTimestamp);(-1===o||r.clusterPositionCache[o].elementStartPos!==e)&&r.clusterPositionCache.splice(o+1,0,{elementStartPos:c.elementStartPos,startTimestamp:t.startTimestamp})}return t.lastReadCluster=c,c}getTrackDataInCluster(e,t){let r=e.trackData.get(t);if(!r){let i=e.segment.tracks.find(e=>e.id===t);if(!i)return null;r={track:i,startTimestamp:0,endTimestamp:0,firstKeyFrameTimestamp:null,blocks:[],presentationTimestamps:[]},e.trackData.set(t,r)}return r}expandLacedBlocks(e,t){for(let r=0;r<e.length;r++){let a=e[r];if(a.lacing===i.None)continue;a.decoded||(a.data=this.decodeBlockData(t,a.data),a.decoded=!0);let n=m.x$.tempFromBytes(a.data),s=[],o=(0,m.eo)(n)+1;switch(a.lacing){case i.Xiph:{let e=0;for(let t=0;t<o-1;t++){let t=0;for(;n.bufferPos<n.length;){let r=(0,m.eo)(n);if(t+=r,r<255){s.push(t),e+=t;break}}}s.push(n.length-(n.bufferPos+e))}break;case i.FixedSize:{let e=Math.floor((n.length-1)/o);for(let t=0;t<o;t++)s.push(e)}break;case i.Ebml:{let e=(0,I.pT)(n);(0,d.vA)(null!==e);let t=e;s.push(t);let r=t;for(let e=1;e<o-1;e++){let e=n.bufferPos,i=(0,I.pT)(n);(0,d.vA)(null!==i),t+=i-((1<<7*(n.bufferPos-e)-1)-1),s.push(t),r+=t}s.push(n.length-(n.bufferPos+r))}break;default:(0,d.vA)(!1)}(0,d.vA)(s.length===o),e.splice(r,1);let l=a.duration||o*(t.defaultDuration??0);for(let t=0;t<o;t++){let c=s[t],d=(0,m.io)(n,c),u=a.timestamp+l*t/o,h=l/o;e.splice(r+t,0,{timestamp:u,duration:h,isKeyFrame:a.isKeyFrame,data:d,lacing:i.None,decoded:!0,mainAdditional:a.mainAdditional})}r+=o,r--}}async loadSegmentMetadata(e){for(let t of e.seekEntries){if((t.id!==I.Cl.Tags||e.tagsSeen)&&(t.id!==I.Cl.Attachments||e.attachmentsSeen))continue;let r=this.reader.requestSliceRange(e.dataStartPos+t.segmentPosition,I.De,I.r1);if(r instanceof Promise&&(r=await r),!r)continue;let i=(0,I.ur)(r);if(!i||i.id!==t.id)continue;let{size:a}=i;(0,I.p)(a),(0,d.vA)(!this.currentSegment),this.currentSegment=e;let n=this.reader.requestSlice(r.filePos,a);n instanceof Promise&&(n=await n),n&&this.readContiguousElements(n),this.currentSegment=null,t.id===I.Cl.Tags?e.tagsSeen=!0:t.id===I.Cl.Attachments&&(e.attachmentsSeen=!0)}}readContiguousElements(e,t){for(;e.remainingLength>=I.De;){let r=e.filePos;if(!this.traverseElement(e,t))return r}return e.filePos}traverseElement(e,t){let r=(0,I.ur)(e);if(!r||t&&t.includes(r.id))return!1;let{id:i,size:o}=r,l=e.filePos;switch((0,I.p)(o),i){case I.Cl.DocType:this.isWebM="webm"===(0,I.IX)(e,o);break;case I.Cl.Seek:{if(!this.currentSegment)break;let t={id:-1,segmentPosition:-1};this.currentSegment.seekEntries.push(t),this.readContiguousElements(e.slice(l,o)),(-1===t.id||-1===t.segmentPosition)&&this.currentSegment.seekEntries.pop()}break;case I.Cl.SeekID:{let t=this.currentSegment?.seekEntries[this.currentSegment.seekEntries.length-1];if(!t)break;t.id=(0,I.dl)(e,o)}break;case I.Cl.SeekPosition:{let t=this.currentSegment?.seekEntries[this.currentSegment.seekEntries.length-1];if(!t)break;t.segmentPosition=(0,I.dl)(e,o)}break;case I.Cl.TimestampScale:if(!this.currentSegment)break;this.currentSegment.timestampScale=(0,I.dl)(e,o),this.currentSegment.timestampFactor=1e9/this.currentSegment.timestampScale;break;case I.Cl.Duration:if(!this.currentSegment)break;this.currentSegment.duration=(0,I.zH)(e,o);break;case I.Cl.TrackEntry:if(!this.currentSegment||(this.currentTrack={id:-1,segment:this.currentSegment,demuxer:this,clusterPositionCache:[],cuePoints:[],disposition:{...p.gM},inputTrack:null,codecId:null,codecPrivate:null,defaultDuration:null,defaultDurationNs:null,name:null,languageCode:d.IR,decodingInstructions:[],info:null},this.readContiguousElements(e.slice(l,o)),!this.currentTrack))break;if(this.currentTrack.decodingInstructions.some(e=>e.data?.type!=="decompress"||e.scope!==a.Block||e.data.algorithm!==n.HeaderStripping)&&(console.warn(`Track #${this.currentTrack.id} has an unsupported content encoding; dropping.`),this.currentTrack=null),this.currentTrack&&-1!==this.currentTrack.id&&this.currentTrack.codecId&&this.currentTrack.info){let e=this.currentTrack.codecId.indexOf("/"),t=-1===e?this.currentTrack.codecId:this.currentTrack.codecId.slice(0,e);if("video"===this.currentTrack.info.type&&-1!==this.currentTrack.info.width&&-1!==this.currentTrack.info.height){this.currentTrack.codecId===I.oo.avc?(this.currentTrack.info.codec="avc",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):this.currentTrack.codecId===I.oo.hevc?(this.currentTrack.info.codec="hevc",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):t===I.oo.vp8?this.currentTrack.info.codec="vp8":t===I.oo.vp9?this.currentTrack.info.codec="vp9":t===I.oo.av1&&(this.currentTrack.info.codec="av1");let e=this.currentTrack,r=new c.N0(this.input,new B(e));this.currentTrack.inputTrack=r,this.currentSegment.tracks.push(this.currentTrack)}else if("audio"===this.currentTrack.info.type&&-1!==this.currentTrack.info.numberOfChannels&&-1!==this.currentTrack.info.sampleRate){t===I.oo.aac?(this.currentTrack.info.codec="aac",this.currentTrack.info.aacCodecInfo={isMpeg2:this.currentTrack.codecId.includes("MPEG2"),objectType:null},this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):this.currentTrack.codecId===I.oo.mp3?this.currentTrack.info.codec="mp3":t===I.oo.opus?(this.currentTrack.info.codec="opus",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate,this.currentTrack.info.sampleRate=s.yo):t===I.oo.vorbis?(this.currentTrack.info.codec="vorbis",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):t===I.oo.flac?(this.currentTrack.info.codec="flac",this.currentTrack.info.codecDescription=this.currentTrack.codecPrivate):"A_PCM/INT/LIT"===this.currentTrack.codecId?8===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-u8":16===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s16":24===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s24":32===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-s32"):"A_PCM/INT/BIG"===this.currentTrack.codecId?8===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-u8":16===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s16be":24===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-s24be":32===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-s32be"):"A_PCM/FLOAT/IEEE"===this.currentTrack.codecId&&(32===this.currentTrack.info.bitDepth?this.currentTrack.info.codec="pcm-f32":64===this.currentTrack.info.bitDepth&&(this.currentTrack.info.codec="pcm-f64"));let e=this.currentTrack,r=new c.Yi(this.input,new L(e));this.currentTrack.inputTrack=r,this.currentSegment.tracks.push(this.currentTrack)}}this.currentTrack=null;break;case I.Cl.TrackNumber:if(!this.currentTrack)break;this.currentTrack.id=(0,I.dl)(e,o);break;case I.Cl.TrackType:{if(!this.currentTrack)break;let t=(0,I.dl)(e,o);1===t?this.currentTrack.info={type:"video",width:-1,height:-1,rotation:0,codec:null,codecDescription:null,colorSpace:null,alphaMode:!1}:2===t&&(this.currentTrack.info={type:"audio",numberOfChannels:-1,sampleRate:-1,bitDepth:-1,codec:null,codecDescription:null,aacCodecInfo:null})}break;case I.Cl.FlagEnabled:if(!this.currentTrack)break;(0,I.dl)(e,o)||(this.currentTrack=null);break;case I.Cl.FlagDefault:if(!this.currentTrack)break;this.currentTrack.disposition.default=!!(0,I.dl)(e,o);break;case I.Cl.FlagForced:if(!this.currentTrack)break;this.currentTrack.disposition.forced=!!(0,I.dl)(e,o);break;case I.Cl.FlagOriginal:if(!this.currentTrack)break;this.currentTrack.disposition.original=!!(0,I.dl)(e,o);break;case I.Cl.FlagHearingImpaired:if(!this.currentTrack)break;this.currentTrack.disposition.hearingImpaired=!!(0,I.dl)(e,o);break;case I.Cl.FlagVisualImpaired:if(!this.currentTrack)break;this.currentTrack.disposition.visuallyImpaired=!!(0,I.dl)(e,o);break;case I.Cl.FlagCommentary:if(!this.currentTrack)break;this.currentTrack.disposition.commentary=!!(0,I.dl)(e,o);break;case I.Cl.CodecID:if(!this.currentTrack)break;this.currentTrack.codecId=(0,I.IX)(e,o);break;case I.Cl.CodecPrivate:if(!this.currentTrack)break;this.currentTrack.codecPrivate=(0,m.io)(e,o);break;case I.Cl.DefaultDuration:if(!this.currentTrack)break;this.currentTrack.defaultDurationNs=(0,I.dl)(e,o);break;case I.Cl.Name:if(!this.currentTrack)break;this.currentTrack.name=(0,I.jR)(e,o);break;case I.Cl.Language:if(!this.currentTrack||this.currentTrack.languageCode!==d.IR)break;this.currentTrack.languageCode=(0,I.IX)(e,o),(0,d.Nu)(this.currentTrack.languageCode)||(this.currentTrack.languageCode=d.IR);break;case I.Cl.LanguageBCP47:{if(!this.currentTrack)break;let t=(0,I.IX)(e,o).split("-")[0];t?this.currentTrack.languageCode=t:this.currentTrack.languageCode=d.IR}break;case I.Cl.Video:if(this.currentTrack?.info?.type!=="video")break;this.readContiguousElements(e.slice(l,o));break;case I.Cl.PixelWidth:if(this.currentTrack?.info?.type!=="video")break;this.currentTrack.info.width=(0,I.dl)(e,o);break;case I.Cl.PixelHeight:if(this.currentTrack?.info?.type!=="video")break;this.currentTrack.info.height=(0,I.dl)(e,o);break;case I.Cl.AlphaMode:if(this.currentTrack?.info?.type!=="video")break;this.currentTrack.info.alphaMode=1===(0,I.dl)(e,o);break;case I.Cl.Colour:if(this.currentTrack?.info?.type!=="video")break;this.currentTrack.info.colorSpace={},this.readContiguousElements(e.slice(l,o));break;case I.Cl.MatrixCoefficients:{if(this.currentTrack?.info?.type!=="video"||!this.currentTrack.info.colorSpace)break;let t=(0,I.dl)(e,o),r=d.fl[t]??null;this.currentTrack.info.colorSpace.matrix=r}break;case I.Cl.Range:if(this.currentTrack?.info?.type!=="video"||!this.currentTrack.info.colorSpace)break;this.currentTrack.info.colorSpace.fullRange=2===(0,I.dl)(e,o);break;case I.Cl.TransferCharacteristics:{if(this.currentTrack?.info?.type!=="video"||!this.currentTrack.info.colorSpace)break;let t=(0,I.dl)(e,o),r=d.x_[t]??null;this.currentTrack.info.colorSpace.transfer=r}break;case I.Cl.Primaries:{if(this.currentTrack?.info?.type!=="video"||!this.currentTrack.info.colorSpace)break;let t=(0,I.dl)(e,o),r=d.BL[t]??null;this.currentTrack.info.colorSpace.primaries=r}break;case I.Cl.Projection:if(this.currentTrack?.info?.type!=="video")break;this.readContiguousElements(e.slice(l,o));break;case I.Cl.ProjectionPoseRoll:{if(this.currentTrack?.info?.type!=="video")break;let t=(0,I.zH)(e,o);try{this.currentTrack.info.rotation=(0,d.qT)(-t)}catch{}}break;case I.Cl.Audio:if(this.currentTrack?.info?.type!=="audio")break;this.readContiguousElements(e.slice(l,o));break;case I.Cl.SamplingFrequency:if(this.currentTrack?.info?.type!=="audio")break;this.currentTrack.info.sampleRate=(0,I.zH)(e,o);break;case I.Cl.Channels:if(this.currentTrack?.info?.type!=="audio")break;this.currentTrack.info.numberOfChannels=(0,I.dl)(e,o);break;case I.Cl.BitDepth:if(this.currentTrack?.info?.type!=="audio")break;this.currentTrack.info.bitDepth=(0,I.dl)(e,o);break;case I.Cl.CuePoint:if(!this.currentSegment)break;this.readContiguousElements(e.slice(l,o)),this.currentCueTime=null;break;case I.Cl.CueTime:this.currentCueTime=(0,I.dl)(e,o);break;case I.Cl.CueTrackPositions:{if(null===this.currentCueTime)break;(0,d.vA)(this.currentSegment);let t={time:this.currentCueTime,trackId:-1,clusterPosition:-1};this.currentSegment.cuePoints.push(t),this.readContiguousElements(e.slice(l,o)),(-1===t.trackId||-1===t.clusterPosition)&&this.currentSegment.cuePoints.pop()}break;case I.Cl.CueTrack:{let t=this.currentSegment?.cuePoints[this.currentSegment.cuePoints.length-1];if(!t)break;t.trackId=(0,I.dl)(e,o)}break;case I.Cl.CueClusterPosition:{let t=this.currentSegment?.cuePoints[this.currentSegment.cuePoints.length-1];if(!t)break;(0,d.vA)(this.currentSegment),t.clusterPosition=this.currentSegment.dataStartPos+(0,I.dl)(e,o)}break;case I.Cl.Timestamp:if(!this.currentCluster)break;this.currentCluster.timestamp=(0,I.dl)(e,o);break;case I.Cl.SimpleBlock:{if(!this.currentCluster)break;let t=(0,I.pT)(e);if(null===t)break;let r=this.getTrackDataInCluster(this.currentCluster,t);if(!r)break;let i=(0,m.iH)(e),a=(0,m.eo)(e),n=!!(128&a);r.track.info?.type==="audio"&&r.track.info.codec&&(n=!0);let s=(0,m.io)(e,o-(e.filePos-l)),c=r.track.decodingInstructions.length>0;r.blocks.push({timestamp:i,duration:0,isKeyFrame:n,data:s,lacing:a>>1&3,decoded:!c,mainAdditional:null})}break;case I.Cl.BlockGroup:if(!this.currentCluster)break;this.readContiguousElements(e.slice(l,o)),this.currentBlock=null;break;case I.Cl.Block:{if(!this.currentCluster)break;let t=(0,I.pT)(e);if(null===t)break;let r=this.getTrackDataInCluster(this.currentCluster,t);if(!r)break;let i=(0,m.iH)(e),a=(0,m.eo)(e),n=(0,m.io)(e,o-(e.filePos-l)),s=r.track.decodingInstructions.length>0;this.currentBlock={timestamp:i,duration:0,isKeyFrame:!0,data:n,lacing:a>>1&3,decoded:!s,mainAdditional:null},r.blocks.push(this.currentBlock)}break;case I.Cl.BlockAdditions:this.readContiguousElements(e.slice(l,o));break;case I.Cl.BlockMore:if(!this.currentBlock)break;this.currentBlockAdditional={addId:1,data:null},this.readContiguousElements(e.slice(l,o)),this.currentBlockAdditional.data&&1===this.currentBlockAdditional.addId&&(this.currentBlock.mainAdditional=this.currentBlockAdditional.data),this.currentBlockAdditional=null;break;case I.Cl.BlockAdditional:if(!this.currentBlockAdditional)break;this.currentBlockAdditional.data=(0,m.io)(e,o);break;case I.Cl.BlockAddID:if(!this.currentBlockAdditional)break;this.currentBlockAdditional.addId=(0,I.dl)(e,o);break;case I.Cl.BlockDuration:if(!this.currentBlock)break;this.currentBlock.duration=(0,I.dl)(e,o);break;case I.Cl.ReferenceBlock:if(!this.currentBlock)break;this.currentBlock.isKeyFrame=!1;break;case I.Cl.Tag:this.currentTagTargetIsMovie=!0,this.readContiguousElements(e.slice(l,o));break;case I.Cl.Targets:this.readContiguousElements(e.slice(l,o));break;case I.Cl.TargetTypeValue:50!==(0,I.dl)(e,o)&&(this.currentTagTargetIsMovie=!1);break;case I.Cl.TagTrackUID:case I.Cl.TagEditionUID:case I.Cl.TagChapterUID:case I.Cl.TagAttachmentUID:this.currentTagTargetIsMovie=!1;break;case I.Cl.SimpleTag:if(!this.currentTagTargetIsMovie)break;this.currentSimpleTagName=null,this.readContiguousElements(e.slice(l,o));break;case I.Cl.TagName:this.currentSimpleTagName=(0,I.jR)(e,o);break;case I.Cl.TagString:{if(!this.currentSimpleTagName)break;let t=(0,I.jR)(e,o);this.processTagValue(this.currentSimpleTagName,t)}break;case I.Cl.TagBinary:{if(!this.currentSimpleTagName)break;let t=(0,m.io)(e,o);this.processTagValue(this.currentSimpleTagName,t)}break;case I.Cl.AttachedFile:{if(!this.currentSegment)break;this.currentAttachedFile={fileUid:null,fileName:null,fileMediaType:null,fileData:null,fileDescription:null},this.readContiguousElements(e.slice(l,o));let t=this.currentSegment.metadataTags;if(this.currentAttachedFile.fileUid&&this.currentAttachedFile.fileData&&(t.raw??={},t.raw[this.currentAttachedFile.fileUid.toString()]=new p.VF(this.currentAttachedFile.fileData,this.currentAttachedFile.fileMediaType??void 0,this.currentAttachedFile.fileName??void 0,this.currentAttachedFile.fileDescription??void 0)),this.currentAttachedFile.fileMediaType?.startsWith("image/")&&this.currentAttachedFile.fileData){let e=this.currentAttachedFile.fileName,r="unknown";if(e){let t=e.toLowerCase();t.startsWith("cover.")?r="coverFront":t.startsWith("back.")&&(r="coverBack")}t.images??=[],t.images.push({data:this.currentAttachedFile.fileData,mimeType:this.currentAttachedFile.fileMediaType,kind:r,name:this.currentAttachedFile.fileName??void 0,description:this.currentAttachedFile.fileDescription??void 0})}this.currentAttachedFile=null}break;case I.Cl.FileUID:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileUid=(0,I.Ry)(e,o);break;case I.Cl.FileName:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileName=(0,I.jR)(e,o);break;case I.Cl.FileMediaType:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileMediaType=(0,I.IX)(e,o);break;case I.Cl.FileData:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileData=(0,m.io)(e,o);break;case I.Cl.FileDescription:if(!this.currentAttachedFile)break;this.currentAttachedFile.fileDescription=(0,I.jR)(e,o);break;case I.Cl.ContentEncodings:if(!this.currentTrack)break;this.readContiguousElements(e.slice(l,o)),this.currentTrack.decodingInstructions.sort((e,t)=>t.order-e.order);break;case I.Cl.ContentEncoding:this.currentDecodingInstruction={order:0,scope:a.Block,data:null},this.readContiguousElements(e.slice(l,o)),this.currentDecodingInstruction.data&&this.currentTrack.decodingInstructions.push(this.currentDecodingInstruction),this.currentDecodingInstruction=null;break;case I.Cl.ContentEncodingOrder:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.order=(0,I.dl)(e,o);break;case I.Cl.ContentEncodingScope:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.scope=(0,I.dl)(e,o);break;case I.Cl.ContentCompression:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.data={type:"decompress",algorithm:n.Zlib,settings:null},this.readContiguousElements(e.slice(l,o));break;case I.Cl.ContentCompAlgo:if(this.currentDecodingInstruction?.data?.type!=="decompress")break;this.currentDecodingInstruction.data.algorithm=(0,I.dl)(e,o);break;case I.Cl.ContentCompSettings:if(this.currentDecodingInstruction?.data?.type!=="decompress")break;this.currentDecodingInstruction.data.settings=(0,m.io)(e,o);break;case I.Cl.ContentEncryption:if(!this.currentDecodingInstruction)break;this.currentDecodingInstruction.data={type:"decrypt"}}return e.filePos=l+o,!0}decodeBlockData(e,t){(0,d.vA)(e.decodingInstructions.length>0);let r=t;for(let t of e.decodingInstructions)if((0,d.vA)(t.data),"decompress"===t.data.type&&t.data.algorithm===n.HeaderStripping&&t.data.settings&&t.data.settings.length>0){let e=t.data.settings,i=new Uint8Array(e.length+r.length);i.set(e,0),i.set(r,e.length),r=i}return r}processTagValue(e,t){if(!this.currentSegment?.metadataTags)return;let r=this.currentSegment.metadataTags;if(r.raw??={},r.raw[e]??=t,"string"==typeof t)switch(e.toLowerCase()){case"title":r.title??=t;break;case"description":r.description??=t;break;case"artist":r.artist??=t;break;case"album":r.album??=t;break;case"album_artist":r.albumArtist??=t;break;case"genre":r.genre??=t;break;case"comment":r.comment??=t;break;case"lyrics":r.lyrics??=t;break;case"date":{let e=new Date(t);Number.isNaN(e.getTime())||(r.date??=e)}break;case"track_number":case"part_number":{let e=t.split("/"),i=Number.parseInt(e[0],10),a=e[1]&&Number.parseInt(e[1],10);Number.isInteger(i)&&i>0&&(r.trackNumber??=i),a&&Number.isInteger(a)&&a>0&&(r.tracksTotal??=a)}break;case"disc_number":case"disc":{let e=t.split("/"),i=Number.parseInt(e[0],10),a=e[1]&&Number.parseInt(e[1],10);Number.isInteger(i)&&i>0&&(r.discNumber??=i),a&&Number.isInteger(a)&&a>0&&(r.discsTotal??=a)}}}}class F{constructor(e){this.internalTrack=e,this.packetToClusterLocation=new WeakMap}getId(){return this.internalTrack.id}getCodec(){throw Error("Not implemented on base class.")}getInternalCodecId(){return this.internalTrack.codecId}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}getName(){return this.internalTrack.name}getLanguageCode(){return this.internalTrack.languageCode}async getFirstTimestamp(){let e=await this.getFirstPacket({metadataOnly:!0});return e?.timestamp??0}getTimeResolution(){return this.internalTrack.segment.timestampFactor}getDisposition(){return this.internalTrack.disposition}async getFirstPacket(e){return this.performClusterLookup(null,e=>e.trackData.get(this.internalTrack.id)?{blockIndex:0,correctBlockFound:!0}:{blockIndex:-1,correctBlockFound:!1},-1/0,1/0,e)}intoTimescale(e){return(0,d.aI)(e*this.internalTrack.segment.timestampFactor)}async getPacket(e,t){let r=this.intoTimescale(e);return this.performClusterLookup(null,e=>{let t=e.trackData.get(this.internalTrack.id);if(!t)return{blockIndex:-1,correctBlockFound:!1};let i=(0,d.eE)(t.presentationTimestamps,r,e=>e.timestamp);return{blockIndex:-1!==i?t.presentationTimestamps[i].blockIndex:-1,correctBlockFound:-1!==i&&r<t.endTimestamp}},r,r,t)}async getNextPacket(e,t){let r=this.packetToClusterLocation.get(e);if(void 0===r)throw Error("Packet was not created from this track.");return this.performClusterLookup(r.cluster,e=>{if(e===r.cluster){let t=e.trackData.get(this.internalTrack.id);if(r.blockIndex+1<t.blocks.length)return{blockIndex:r.blockIndex+1,correctBlockFound:!0}}else if(e.trackData.get(this.internalTrack.id))return{blockIndex:0,correctBlockFound:!0};return{blockIndex:-1,correctBlockFound:!1}},-1/0,1/0,t)}async getKeyPacket(e,t){let r=this.intoTimescale(e);return this.performClusterLookup(null,e=>{let t=e.trackData.get(this.internalTrack.id);if(!t)return{blockIndex:-1,correctBlockFound:!1};let i=(0,d.Kl)(t.presentationTimestamps,e=>t.blocks[e.blockIndex].isKeyFrame&&e.timestamp<=r);return{blockIndex:-1!==i?t.presentationTimestamps[i].blockIndex:-1,correctBlockFound:-1!==i&&r<t.endTimestamp}},r,r,t)}async getNextKeyPacket(e,t){let r=this.packetToClusterLocation.get(e);if(void 0===r)throw Error("Packet was not created from this track.");return this.performClusterLookup(r.cluster,e=>{if(e===r.cluster){let t=e.trackData.get(this.internalTrack.id).blocks.findIndex((e,t)=>e.isKeyFrame&&t>r.blockIndex);if(-1!==t)return{blockIndex:t,correctBlockFound:!0}}else{let t=e.trackData.get(this.internalTrack.id);if(t&&null!==t.firstKeyFrameTimestamp){let e=t.blocks.findIndex(e=>e.isKeyFrame);return(0,d.vA)(-1!==e),{blockIndex:e,correctBlockFound:!0}}}return{blockIndex:-1,correctBlockFound:!1}},-1/0,1/0,t)}async fetchPacketInCluster(e,t,r){if(-1===t)return null;let i=e.trackData.get(this.internalTrack.id).blocks[t];(0,d.vA)(i),i.decoded||(i.data=this.internalTrack.demuxer.decodeBlockData(this.internalTrack,i.data),i.decoded=!0);let a=r.metadataOnly?u.T:i.data,n=i.timestamp/this.internalTrack.segment.timestampFactor,s=i.duration/this.internalTrack.segment.timestampFactor,o={};i.mainAdditional&&this.internalTrack.info?.type==="video"&&this.internalTrack.info.alphaMode&&(o.alpha=r.metadataOnly?u.T:i.mainAdditional,o.alphaByteLength=i.mainAdditional.byteLength);let l=new u.Z(a,i.isKeyFrame?"key":"delta",n,s,e.dataStartPos+t,i.data.byteLength,o);return this.packetToClusterLocation.set(l,{cluster:e,blockIndex:t}),l}async performClusterLookup(e,t,r,i,a){let n;let{demuxer:s,segment:o}=this.internalTrack,l=null,c=null,u=-1;if(e){let{blockIndex:r,correctBlockFound:i}=t(e);if(i)return this.fetchPacketInCluster(e,r,a);-1!==r&&(c=e,u=r)}let h=(0,d.eE)(this.internalTrack.cuePoints,r,e=>e.time),f=-1!==h?this.internalTrack.cuePoints[h]:null,m=(0,d.eE)(this.internalTrack.clusterPositionCache,r,e=>e.startTimestamp),p=-1!==m?this.internalTrack.clusterPositionCache[m]:null,g=Math.max(f?.clusterPosition??0,p?.elementStartPos??0)||null;for(e?null===g||e.elementStartPos>=g?(n=e.elementEndPos,l=e):n=g:n=g??o.clusterSeekStartPos;null===o.elementEndPos||n<=o.elementEndPos-I.De;){if(l){let e=l.trackData.get(this.internalTrack.id);if(e&&e.startTimestamp>i)break}let e=s.reader.requestSliceRange(n,I.De,I.r1);if(e instanceof Promise&&(e=await e),!e)break;let r=n,h=(0,I.ur)(e);if(!h||!I.VE.includes(h.id)&&h.id!==I.Cl.Void){let e=await (0,I.nE)(s.reader,r,I.VE,Math.min(o.elementEndPos??1/0,r+0xa00000));if(e){n=e;continue}break}let f=h.id,m=h.size,p=e.filePos;if(f===I.Cl.Cluster){m=(l=await s.readCluster(r,o)).elementEndPos-p;let{blockIndex:e,correctBlockFound:i}=t(l);if(i)return this.fetchPacketInCluster(l,e,a);-1!==e&&(c=l,u=e)}void 0===m&&((0,d.vA)(f!==I.Cl.Cluster),m=(await (0,I.IQ)(s.reader,p,I.K9,o.elementEndPos)).pos-p);let g=p+m;if(null===o.elementEndPos){let e=s.reader.requestSliceRange(g,I.De,I.r1);if(e instanceof Promise&&(e=await e),!e)break;if((0,I.SR)(e)===I.Cl.Segment){o.elementEndPos=g;break}}n=g}if(f&&(!c||c.elementStartPos<f.clusterPosition)){let e=this.internalTrack.cuePoints[h-1];(0,d.vA)(!e||e.time<f.time);let r=e?.time??-1/0;return this.performClusterLookup(null,t,r,i,a)}return c?this.fetchPacketInCluster(c,u,a):null}}class B extends F{constructor(e){super(e),this.decoderConfigPromise=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getCodedWidth(){return this.internalTrack.info.width}getCodedHeight(){return this.internalTrack.info.height}getRotation(){return this.internalTrack.info.rotation}async getColorSpace(){return{primaries:this.internalTrack.info.colorSpace?.primaries,transfer:this.internalTrack.info.colorSpace?.transfer,matrix:this.internalTrack.info.colorSpace?.matrix,fullRange:this.internalTrack.info.colorSpace?.fullRange}}async canBeTransparent(){return this.internalTrack.info.alphaMode}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfigPromise??=(async()=>{let e=null;return"vp9"!==this.internalTrack.info.codec&&"av1"!==this.internalTrack.info.codec&&("avc"!==this.internalTrack.info.codec||this.internalTrack.info.codecDescription)&&("hevc"!==this.internalTrack.info.codec||this.internalTrack.info.codecDescription)||(e=await this.getFirstPacket({})),{codec:(0,s.QP)({width:this.internalTrack.info.width,height:this.internalTrack.info.height,codec:this.internalTrack.info.codec,codecDescription:this.internalTrack.info.codecDescription,colorSpace:this.internalTrack.info.colorSpace,avcType:1,avcCodecInfo:"avc"===this.internalTrack.info.codec&&e?(0,o.fH)(e.data):null,hevcCodecInfo:"hevc"===this.internalTrack.info.codec&&e?(0,o.D5)(e.data):null,vp9CodecInfo:"vp9"===this.internalTrack.info.codec&&e?(0,o.bs)(e.data):null,av1CodecInfo:"av1"===this.internalTrack.info.codec&&e?(0,o.UU)(e.data):null}),codedWidth:this.internalTrack.info.width,codedHeight:this.internalTrack.info.height,description:this.internalTrack.info.codecDescription??void 0,colorSpace:this.internalTrack.info.colorSpace??void 0}})():null}}class L extends F{constructor(e){super(e),this.decoderConfig=null,this.internalTrack=e}getCodec(){return this.internalTrack.info.codec}getNumberOfChannels(){return this.internalTrack.info.numberOfChannels}getSampleRate(){return this.internalTrack.info.sampleRate}async getDecoderConfig(){return this.internalTrack.info.codec?this.decoderConfig??={codec:(0,s.X0)({codec:this.internalTrack.info.codec,codecDescription:this.internalTrack.info.codecDescription,aacCodecInfo:this.internalTrack.info.aacCodecInfo}),numberOfChannels:this.internalTrack.info.numberOfChannels,sampleRate:this.internalTrack.info.sampleRate,description:this.internalTrack.info.codecDescription??void 0}:null}}var U=r(4700),R=r(9044);let D=async(e,t,r)=>{let i=t;for(;null===r||i<r;){let t=e.requestSlice(i,U.Yq);if(t instanceof Promise&&(t=await t),!t)break;let r=(0,m.cN)(t),a=(0,U.P8)(r,null!==e.fileSize?e.fileSize-i:null);if(a.header)return{header:a.header,startPos:i};i+=a.bytesAdvanced}return null};class N extends l.B{constructor(e){super(e),this.metadataPromise=null,this.firstFrameHeader=null,this.loadedSamples=[],this.metadataTags=null,this.tracks=[],this.readingMutex=new d.aD,this.lastSampleLoaded=!1,this.lastLoadedPos=0,this.nextTimestampInSamples=0,this.reader=e._reader}async readMetadata(){return this.metadataPromise??=(async()=>{for(;!this.firstFrameHeader&&!this.lastSampleLoaded;)await this.advanceReader();if(!this.firstFrameHeader)throw Error("No valid MP3 frame found.");this.tracks=[new c.Yi(this.input,new _(this))]})()}async advanceReader(){if(0===this.lastLoadedPos)for(;;){let e=this.reader.requestSlice(this.lastLoadedPos,R.sY);if(e instanceof Promise&&(e=await e),!e){this.lastSampleLoaded=!0;return}let t=(0,R.IX)(e);if(!t)break;this.lastLoadedPos=e.filePos+t.size}let e=await D(this.reader,this.lastLoadedPos,this.reader.fileSize);if(!e){this.lastSampleLoaded=!0;return}let t=e.header;this.lastLoadedPos=e.startPos+t.totalSize-1;let r=(0,U.EZ)(t.mpegVersionId,t.channel),i=this.reader.requestSlice(e.startPos+r,4);if(i instanceof Promise&&(i=await i),i){let e=(0,m.cN)(i);if(e===U.hY||e===U.rD)return}this.firstFrameHeader||(this.firstFrameHeader=t),t.sampleRate!==this.firstFrameHeader.sampleRate&&console.warn(`MP3 changed sample rate mid-file: ${this.firstFrameHeader.sampleRate} Hz to ${t.sampleRate} Hz. Might be a bug, so please report this file.`);let a=t.audioSamplesInFrame/this.firstFrameHeader.sampleRate,n={timestamp:this.nextTimestampInSamples/this.firstFrameHeader.sampleRate,duration:a,dataStart:e.startPos,dataSize:t.totalSize};this.loadedSamples.push(n),this.nextTimestampInSamples+=t.audioSamplesInFrame}async getMimeType(){return"audio/mpeg"}async getTracks(){return await this.readMetadata(),this.tracks}async computeDuration(){await this.readMetadata();let e=this.tracks[0];return(0,d.vA)(e),e.computeDuration()}async getMetadataTags(){let e=await this.readingMutex.acquire();try{if(await this.readMetadata(),this.metadataTags)return this.metadataTags;this.metadataTags={};let e=0,t=!1;for(;;){let r=this.reader.requestSlice(e,R.sY);if(r instanceof Promise&&(r=await r),!r)break;let i=(0,R.IX)(r);if(!i)break;t=!0;let a=this.reader.requestSlice(r.filePos,i.size);if(a instanceof Promise&&(a=await a),!a)break;(0,R.cG)(a,i,this.metadataTags),e=r.filePos+i.size}if(!t&&null!==this.reader.fileSize&&this.reader.fileSize>=R.aU){let e=this.reader.requestSlice(this.reader.fileSize-R.aU,R.aU);e instanceof Promise&&(e=await e),(0,d.vA)(e);let t=(0,m.IT)(e,3);"TAG"===t&&(0,R.p_)(e,this.metadataTags)}return this.metadataTags}finally{e()}}}class _{constructor(e){this.demuxer=e}getId(){return 1}async getFirstTimestamp(){return 0}getTimeResolution(){return(0,d.vA)(this.demuxer.firstFrameHeader),this.demuxer.firstFrameHeader.sampleRate/this.demuxer.firstFrameHeader.audioSamplesInFrame}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}getName(){return null}getLanguageCode(){return d.IR}getCodec(){return"mp3"}getInternalCodecId(){return null}getNumberOfChannels(){return(0,d.vA)(this.demuxer.firstFrameHeader),3===this.demuxer.firstFrameHeader.channel?1:2}getSampleRate(){return(0,d.vA)(this.demuxer.firstFrameHeader),this.demuxer.firstFrameHeader.sampleRate}getDisposition(){return{...p.gM}}async getDecoderConfig(){return(0,d.vA)(this.demuxer.firstFrameHeader),{codec:"mp3",numberOfChannels:3===this.demuxer.firstFrameHeader.channel?1:2,sampleRate:this.demuxer.firstFrameHeader.sampleRate}}async getPacketAtIndex(e,t){let r;if(-1===e)return null;let i=this.demuxer.loadedSamples[e];if(!i)return null;if(t.metadataOnly)r=u.T;else{let e=this.demuxer.reader.requestSlice(i.dataStart,i.dataSize);if(e instanceof Promise&&(e=await e),!e)return null;r=(0,m.io)(e,i.dataSize)}return new u.Z(r,"key",i.timestamp,i.duration,e,i.dataSize)}getFirstPacket(e){return this.getPacketAtIndex(0,e)}async getNextPacket(e,t){let r=await this.demuxer.readingMutex.acquire();try{let r=(0,d.pl)(this.demuxer.loadedSamples,e.timestamp,e=>e.timestamp);if(-1===r)throw Error("Packet was not created from this track.");let i=r+1;for(;i>=this.demuxer.loadedSamples.length&&!this.demuxer.lastSampleLoaded;)await this.demuxer.advanceReader();return this.getPacketAtIndex(i,t)}finally{r()}}async getPacket(e,t){let r=await this.demuxer.readingMutex.acquire();try{for(;;){let r=(0,d.eE)(this.demuxer.loadedSamples,e,e=>e.timestamp);if(-1===r&&this.demuxer.loadedSamples.length>0)return null;if(this.demuxer.lastSampleLoaded||r>=0&&r+1<this.demuxer.loadedSamples.length)return this.getPacketAtIndex(r,t);await this.demuxer.advanceReader()}}finally{r()}}getKeyPacket(e,t){return this.getPacket(e,t)}getNextKeyPacket(e,t){return this.getNextPacket(e,t)}}var z=r(7408),O=r(8195);class V extends l.B{constructor(e){super(e),this.metadataPromise=null,this.bitstreams=[],this.tracks=[],this.metadataTags={},this.reader=e._reader}async readMetadata(){return this.metadataPromise??=(async()=>{let e=0;for(;;){let t=this.reader.requestSliceRange(e,O.b0,O.H9);if(t instanceof Promise&&(t=await t),!t)break;let r=(0,O.BF)(t);if(!r||!(2&r.headerType))break;this.bitstreams.push({serialNumber:r.serialNumber,bosPage:r,description:null,numberOfChannels:-1,sampleRate:-1,codecInfo:{codec:null,vorbisInfo:null,opusInfo:null},lastMetadataPacket:null}),e=r.headerStartPos+r.totalSize}for(let e of this.bitstreams){let t=await this.readPacket(e.bosPage,0);t&&(t.data.byteLength>=7&&1===t.data[0]&&118===t.data[1]&&111===t.data[2]&&114===t.data[3]&&98===t.data[4]&&105===t.data[5]&&115===t.data[6]?await this.readVorbisMetadata(t,e):t.data.byteLength>=8&&79===t.data[0]&&112===t.data[1]&&117===t.data[2]&&115===t.data[3]&&72===t.data[4]&&101===t.data[5]&&97===t.data[6]&&100===t.data[7]&&await this.readOpusMetadata(t,e),null!==e.codecInfo.codec&&this.tracks.push(new c.Yi(this.input,new $(e,this))))}})()}async readVorbisMetadata(e,t){let r=await this.findNextPacketStart(e);if(!r)return;let i=await this.readPacket(r.startPage,r.startSegmentIndex);if(!i||!(r=await this.findNextPacketStart(i)))return;let a=await this.readPacket(r.startPage,r.startSegmentIndex);if(!a||3!==i.data[0]||5!==a.data[0])return;let n=[],s=e=>{for(;n.push(Math.min(255,e)),!(e<255);)e-=255};s(e.data.length),s(i.data.length);let l=new Uint8Array(1+n.length+e.data.length+i.data.length+a.data.length);l[0]=2,l.set(n,1),l.set(e.data,1+n.length),l.set(i.data,1+n.length+e.data.length),l.set(a.data,1+n.length+e.data.length+i.data.length),t.codecInfo.codec="vorbis",t.description=l,t.lastMetadataPacket=a;let c=(0,d.Zc)(e.data);t.numberOfChannels=c.getUint8(11),t.sampleRate=c.getUint32(12,!0);let u=c.getUint8(28);t.codecInfo.vorbisInfo={blocksizes:[1<<(15&u),1<<(u>>4)],modeBlockflags:(0,o.Co)(a.data).modeBlockflags},(0,o.Oc)(i.data.subarray(7),this.metadataTags)}async readOpusMetadata(e,t){let r=await this.findNextPacketStart(e);if(!r)return;let i=await this.readPacket(r.startPage,r.startSegmentIndex);if(!i)return;t.codecInfo.codec="opus",t.description=e.data,t.lastMetadataPacket=i;let a=(0,o.Qf)(e.data);t.numberOfChannels=a.outputChannelCount,t.sampleRate=s.yo,t.codecInfo.opusInfo={preSkip:a.preSkip},(0,o.Oc)(i.data.subarray(8),this.metadataTags)}async readPacket(e,t){(0,d.vA)(t<e.lacingValues.length);let r=0;for(let i=0;i<t;i++)r+=e.lacingValues[i];let i=e,a=r,n=t,s=[];e:for(;;){let t=this.reader.requestSlice(i.dataStartPos,i.dataSize);t instanceof Promise&&(t=await t),(0,d.vA)(t);let o=(0,m.io)(t,i.dataSize);for(;;){if(n===i.lacingValues.length){s.push(o.subarray(r,a));break}let e=i.lacingValues[n];if(a+=e,e<255){s.push(o.subarray(r,a));break e}n++}let l=i.headerStartPos+i.totalSize;for(;;){let t=this.reader.requestSliceRange(l,O.b0,O.H9);if(t instanceof Promise&&(t=await t),!t)return null;let r=(0,O.BF)(t);if(!r)return null;if((i=r).serialNumber===e.serialNumber)break;l=i.headerStartPos+i.totalSize}r=0,a=0,n=0}let o=s.reduce((e,t)=>e+t.length,0);if(0===o)return null;let l=new Uint8Array(o),c=0;for(let e=0;e<s.length;e++){let t=s[e];l.set(t,c),c+=t.length}return{data:l,endPage:i,endSegmentIndex:n}}async findNextPacketStart(e){if(e.endSegmentIndex<e.endPage.lacingValues.length-1)return{startPage:e.endPage,startSegmentIndex:e.endSegmentIndex+1};if(4&e.endPage.headerType)return null;let t=e.endPage.headerStartPos+e.endPage.totalSize;for(;;){let r=this.reader.requestSliceRange(t,O.b0,O.H9);if(r instanceof Promise&&(r=await r),!r)return null;let i=(0,O.BF)(r);if(!i)return null;if(i.serialNumber===e.endPage.serialNumber)return{startPage:i,startSegmentIndex:0};t=i.headerStartPos+i.totalSize}}async getMimeType(){await this.readMetadata();let e=await Promise.all(this.tracks.map(e=>e.getCodecParameterString()));return(0,z.Ob)({codecStrings:e.filter(Boolean)})}async getTracks(){return await this.readMetadata(),this.tracks}async computeDuration(){let e=await this.getTracks();return Math.max(0,...await Promise.all(e.map(e=>e.computeDuration())))}async getMetadataTags(){return await this.readMetadata(),this.metadataTags}}class ${constructor(e,t){this.bitstream=e,this.demuxer=t,this.encodedPacketToMetadata=new WeakMap,this.sequentialScanCache=[],this.sequentialScanMutex=new d.aD,this.internalSampleRate="opus"===e.codecInfo.codec?s.yo:e.sampleRate}getId(){return this.bitstream.serialNumber}getNumberOfChannels(){return this.bitstream.numberOfChannels}getSampleRate(){return this.bitstream.sampleRate}getTimeResolution(){return this.bitstream.sampleRate}getCodec(){return this.bitstream.codecInfo.codec}getInternalCodecId(){return null}async getDecoderConfig(){return(0,d.vA)(this.bitstream.codecInfo.codec),{codec:this.bitstream.codecInfo.codec,numberOfChannels:this.bitstream.numberOfChannels,sampleRate:this.bitstream.sampleRate,description:this.bitstream.description??void 0}}getName(){return null}getLanguageCode(){return d.IR}getDisposition(){return{...p.gM}}async getFirstTimestamp(){return 0}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}granulePositionToTimestampInSamples(e){return"opus"===this.bitstream.codecInfo.codec?((0,d.vA)(this.bitstream.codecInfo.opusInfo),e-this.bitstream.codecInfo.opusInfo.preSkip):e}createEncodedPacketFromOggPacket(e,t,r){if(!e)return null;let{durationInSamples:i,vorbisBlockSize:a}=(0,z.nL)(e.data,this.bitstream.codecInfo,t.vorbisLastBlocksize),n=new u.Z(r.metadataOnly?u.T:e.data,"key",Math.max(0,t.timestampInSamples)/this.internalSampleRate,i/this.internalSampleRate,e.endPage.headerStartPos+e.endSegmentIndex,e.data.byteLength);return this.encodedPacketToMetadata.set(n,{packet:e,timestampInSamples:t.timestampInSamples,durationInSamples:i,vorbisLastBlockSize:t.vorbisLastBlocksize,vorbisBlockSize:a}),n}async getFirstPacket(e){(0,d.vA)(this.bitstream.lastMetadataPacket);let t=await this.demuxer.findNextPacketStart(this.bitstream.lastMetadataPacket);if(!t)return null;let r=0;"opus"===this.bitstream.codecInfo.codec&&((0,d.vA)(this.bitstream.codecInfo.opusInfo),r-=this.bitstream.codecInfo.opusInfo.preSkip);let i=await this.demuxer.readPacket(t.startPage,t.startSegmentIndex);return this.createEncodedPacketFromOggPacket(i,{timestampInSamples:r,vorbisLastBlocksize:null},e)}async getNextPacket(e,t){let r=this.encodedPacketToMetadata.get(e);if(!r)throw Error("Packet was not created from this track.");let i=await this.demuxer.findNextPacketStart(r.packet);if(!i)return null;let a=r.timestampInSamples+r.durationInSamples,n=await this.demuxer.readPacket(i.startPage,i.startSegmentIndex);return this.createEncodedPacketFromOggPacket(n,{timestampInSamples:a,vorbisLastBlocksize:r.vorbisBlockSize},t)}async getPacket(e,t){let r,i;if(null===this.demuxer.reader.fileSize)return this.getPacketSequential(e,t);let a=(0,d.aI)(e*this.internalSampleRate);if(0===a)return this.getFirstPacket(t);if(a<0)return null;(0,d.vA)(this.bitstream.lastMetadataPacket);let n=await this.demuxer.findNextPacketStart(this.bitstream.lastMetadataPacket);if(!n)return null;let s=n.startPage,o=this.demuxer.reader.fileSize,l=[s];e:for(;s.headerStartPos+s.totalSize<o;){let e=Math.floor((s.headerStartPos+o)/2),t=e;for(;;){let r=Math.min(t+O.H4,o-O.b0),i=this.demuxer.reader.requestSlice(t,r-t);if(i instanceof Promise&&(i=await i),(0,d.vA)(i),!(0,O.v5)(i,r)){o=e+O.b0;continue e}let n=this.demuxer.reader.requestSliceRange(i.filePos,O.b0,O.H9);n instanceof Promise&&(n=await n),(0,d.vA)(n);let c=(0,O.BF)(n);(0,d.vA)(c);let u=!1;if(c.serialNumber===this.bitstream.serialNumber)u=!0;else{let e=this.demuxer.reader.requestSlice(c.headerStartPos,c.totalSize);e instanceof Promise&&(e=await e),(0,d.vA)(e);let t=(0,m.io)(e,c.totalSize);u=(0,z._S)(t)===c.checksum}if(!u){t=c.headerStartPos+4;continue}if(u&&c.serialNumber!==this.bitstream.serialNumber||-1===c.granulePosition){t=c.headerStartPos+c.totalSize;continue}this.granulePositionToTimestampInSamples(c.granulePosition)>a?o=c.headerStartPos:(s=c,l.push(c));continue e}}let c=n.startPage;for(let e of l){if(e.granulePosition===s.granulePosition)break;(!c||e.headerStartPos>c.headerStartPos)&&(c=e)}let h=c,f=[h];for(;h.serialNumber!==this.bitstream.serialNumber||h.granulePosition!==s.granulePosition;){let e=h.headerStartPos+h.totalSize,t=this.demuxer.reader.requestSliceRange(e,O.b0,O.H9);t instanceof Promise&&(t=await t),(0,d.vA)(t);let r=(0,O.BF)(t);(0,d.vA)(r),(h=r).serialNumber===this.bitstream.serialNumber&&f.push(h)}(0,d.vA)(-1!==h.granulePosition);let p=null,g=h,y=0;if(h.headerStartPos===n.startPage.headerStartPos)r=this.granulePositionToTimestampInSamples(0),i=!0,p=0;else{r=0,i=!1;for(let e=h.lacingValues.length-1;e>=0;e--)if(h.lacingValues[e]<255){p=e+1;break}if(null===p)throw Error("Invalid page with granule position: no packets end on this page.");y=p-1;let e={data:u.T,endPage:g,endSegmentIndex:y};if(await this.demuxer.findNextPacketStart(e)){let e=H(f,h,p);(0,d.vA)(e);let t=j(f,e.page,e.segmentIndex);t&&(h=t.page,p=t.segmentIndex)}else for(;;){let e=H(f,h,p);if(!e)break;let t=j(f,e.page,e.segmentIndex);if(!t)break;if(h=t.page,p=t.segmentIndex,e.page.headerStartPos!==g.headerStartPos){g=e.page,y=e.segmentIndex;break}}}let b=null,k=null;for(;null!==h;){(0,d.vA)(null!==p);let e=await this.demuxer.readPacket(h,p);if(!e)break;if(!(h.headerStartPos===n.startPage.headerStartPos&&p<n.startSegmentIndex)){let n=this.createEncodedPacketFromOggPacket(e,{timestampInSamples:r,vorbisLastBlocksize:k?.vorbisBlockSize??null},t);(0,d.vA)(n);let s=this.encodedPacketToMetadata.get(n);if((0,d.vA)(s),i||e.endPage.headerStartPos!==g.headerStartPos||e.endSegmentIndex!==y?r+=s.durationInSamples:(r=this.granulePositionToTimestampInSamples(h.granulePosition),i=!0,n=this.createEncodedPacketFromOggPacket(e,{timestampInSamples:r-s.durationInSamples,vorbisLastBlocksize:k?.vorbisBlockSize??null},t),(0,d.vA)(n),s=this.encodedPacketToMetadata.get(n),(0,d.vA)(s)),b=n,k=s,i&&(Math.max(r,0)>a||Math.max(s.timestampInSamples,0)===a))break}let s=await this.demuxer.findNextPacketStart(e);if(!s)break;h=s.startPage,p=s.startSegmentIndex}return b}async getPacketSequential(e,t){let r=await this.sequentialScanMutex.acquire();try{let r;let i=(0,d.aI)(e*this.internalSampleRate);e=i/this.internalSampleRate;let a=(0,d.eE)(this.sequentialScanCache,i,e=>e.timestampInSamples);if(-1!==a){let e=this.sequentialScanCache[a];r=this.createEncodedPacketFromOggPacket(e.packet,{timestampInSamples:e.timestampInSamples,vorbisLastBlocksize:e.vorbisLastBlockSize},t)}else r=await this.getFirstPacket(t);let n=0;for(;r&&r.timestamp<e;){let i=await this.getNextPacket(r,t);if(!i||i.timestamp>e)break;if(r=i,n++,100===n){n=0;let e=this.encodedPacketToMetadata.get(r);(0,d.vA)(e),this.sequentialScanCache.length>0&&(0,d.vA)((0,d._g)(this.sequentialScanCache).timestampInSamples<=e.timestampInSamples),this.sequentialScanCache.push(e)}}return r}finally{r()}}getKeyPacket(e,t){return this.getPacket(e,t)}getNextKeyPacket(e,t){return this.getNextPacket(e,t)}}let j=(e,t,r)=>{let i=t,a=r;e:for(;;){for(a--;a>=0;a--)if(i.lacingValues[a]<255){a++;break e}if((0,d.vA)(-1===a),!(1&i.headerType)){a=0;break}let t=(0,d.Uk)(e,e=>e.headerStartPos<i.headerStartPos);if(!t)return null;a=(i=t).lacingValues.length}if((0,d.vA)(-1!==a),a===i.lacingValues.length){let t=e[e.indexOf(i)+1];(0,d.vA)(t),i=t,a=0}return{page:i,segmentIndex:a}},H=(e,t,r)=>{if(r>0)return{page:t,segmentIndex:r-1};let i=(0,d.Uk)(e,e=>e.headerStartPos<t.headerStartPos);return i?{page:i,segmentIndex:i.lacingValues.length-1}:null};var q=r(3520),K=r(9313);class W extends l.B{constructor(e){super(e),this.metadataPromise=null,this.firstFrameHeader=null,this.loadedSamples=[],this.tracks=[],this.readingMutex=new d.aD,this.lastSampleLoaded=!1,this.lastLoadedPos=0,this.nextTimestampInSamples=0,this.reader=e._reader}async readMetadata(){return this.metadataPromise??=(async()=>{for(;!this.firstFrameHeader&&!this.lastSampleLoaded;)await this.advanceReader();(0,d.vA)(this.firstFrameHeader),this.tracks=[new c.Yi(this.input,new X(this))]})()}async advanceReader(){let e=this.reader.requestSliceRange(this.lastLoadedPos,K.gc,K.Y$);if(e instanceof Promise&&(e=await e),!e){this.lastSampleLoaded=!0;return}let t=(0,K.lh)(e);if(!t||null!==this.reader.fileSize&&t.startPos+t.frameLength>this.reader.fileSize){this.lastSampleLoaded=!0;return}this.firstFrameHeader||(this.firstFrameHeader=t);let r=s.Im[t.samplingFrequencyIndex];(0,d.vA)(void 0!==r);let i={timestamp:this.nextTimestampInSamples/r,duration:1024/r,dataStart:t.startPos,dataSize:t.frameLength};this.loadedSamples.push(i),this.nextTimestampInSamples+=1024,this.lastLoadedPos=t.startPos+t.frameLength}async getMimeType(){return"audio/aac"}async getTracks(){return await this.readMetadata(),this.tracks}async computeDuration(){await this.readMetadata();let e=this.tracks[0];return(0,d.vA)(e),e.computeDuration()}async getMetadataTags(){return{}}}class X{constructor(e){this.demuxer=e}getId(){return 1}async getFirstTimestamp(){return 0}getTimeResolution(){return this.getSampleRate()/1024}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}getName(){return null}getLanguageCode(){return d.IR}getCodec(){return"aac"}getInternalCodecId(){return(0,d.vA)(this.demuxer.firstFrameHeader),this.demuxer.firstFrameHeader.objectType}getNumberOfChannels(){(0,d.vA)(this.demuxer.firstFrameHeader);let e=s.Ti[this.demuxer.firstFrameHeader.channelConfiguration];return(0,d.vA)(void 0!==e),e}getSampleRate(){(0,d.vA)(this.demuxer.firstFrameHeader);let e=s.Im[this.demuxer.firstFrameHeader.samplingFrequencyIndex];return(0,d.vA)(void 0!==e),e}getDisposition(){return{...p.gM}}async getDecoderConfig(){return(0,d.vA)(this.demuxer.firstFrameHeader),{codec:`mp4a.40.${this.demuxer.firstFrameHeader.objectType}`,numberOfChannels:this.getNumberOfChannels(),sampleRate:this.getSampleRate()}}async getPacketAtIndex(e,t){let r;if(-1===e)return null;let i=this.demuxer.loadedSamples[e];if(!i)return null;if(t.metadataOnly)r=u.T;else{let e=this.demuxer.reader.requestSlice(i.dataStart,i.dataSize);if(e instanceof Promise&&(e=await e),!e)return null;r=(0,m.io)(e,i.dataSize)}return new u.Z(r,"key",i.timestamp,i.duration,e,i.dataSize)}getFirstPacket(e){return this.getPacketAtIndex(0,e)}async getNextPacket(e,t){let r=await this.demuxer.readingMutex.acquire();try{let r=(0,d.pl)(this.demuxer.loadedSamples,e.timestamp,e=>e.timestamp);if(-1===r)throw Error("Packet was not created from this track.");let i=r+1;for(;i>=this.demuxer.loadedSamples.length&&!this.demuxer.lastSampleLoaded;)await this.demuxer.advanceReader();return this.getPacketAtIndex(i,t)}finally{r()}}async getPacket(e,t){let r=await this.demuxer.readingMutex.acquire();try{for(;;){let r=(0,d.eE)(this.demuxer.loadedSamples,e,e=>e.timestamp);if(-1===r&&this.demuxer.loadedSamples.length>0)return null;if(this.demuxer.lastSampleLoaded||r>=0&&r+1<this.demuxer.loadedSamples.length)return this.getPacketAtIndex(r,t);await this.demuxer.advanceReader()}}finally{r()}}getKeyPacket(e,t){return this.getPacket(e,t)}getNextKeyPacket(e,t){return this.getNextPacket(e,t)}}var Q=r(2778);class J extends l.B{constructor(e){super(e),this.loadedSamples=[],this.metadataPromise=null,this.track=null,this.metadataTags={},this.audioInfo=null,this.lastLoadedPos=null,this.blockingBit=null,this.readingMutex=new d.aD,this.lastSampleLoaded=!1,this.reader=e._reader}async computeDuration(){return await this.readMetadata(),(0,d.vA)(this.track),this.track.computeDuration()}async getMetadataTags(){return await this.readMetadata(),this.metadataTags}async getTracks(){return await this.readMetadata(),(0,d.vA)(this.track),[this.track]}async getMimeType(){return"audio/flac"}async readMetadata(){let e=4;return this.metadataPromise??=(async()=>{for(;null===this.reader.fileSize||e<this.reader.fileSize;){let t=this.reader.requestSlice(e,4);if(t instanceof Promise&&(t=await t),e+=4,null===t)throw Error(`Metadata block at position ${e} is too small! Corrupted file.`);(0,d.vA)(t);let r=(0,m.eo)(t),i=(0,m.n2)(t),a=(128&r)!=0;switch(127&r){case o.A3.STREAMINFO:{let t=this.reader.requestSlice(e,i);if(t instanceof Promise&&(t=await t),(0,d.vA)(t),null===t)throw Error(`StreamInfo block at position ${e} is too small! Corrupted file.`);let r=(0,m.io)(t,34),a=new d._c(r),n=a.readBits(16),s=a.readBits(16),o=a.readBits(24),l=a.readBits(24),u=a.readBits(20),h=a.readBits(3)+1;a.readBits(5);let f=a.readBits(36);a.skipBits(128);let p=new Uint8Array(42);p.set(new Uint8Array([102,76,97,67]),0),p.set(new Uint8Array([128,0,0,34]),4),p.set(r,8),this.audioInfo={numberOfChannels:h,sampleRate:u,totalSamples:f,minimumBlockSize:n,maximumBlockSize:s,minimumFrameSize:o,maximumFrameSize:l,description:p},this.track=new c.Yi(this.input,new Z(this));break}case o.A3.VORBIS_COMMENT:{let t=this.reader.requestSlice(e,i);t instanceof Promise&&(t=await t),(0,d.vA)(t),(0,o.Oc)((0,m.io)(t,i),this.metadataTags);break}case o.A3.PICTURE:{let t=this.reader.requestSlice(e,i);t instanceof Promise&&(t=await t),(0,d.vA)(t);let r=(0,m.cN)(t),a=(0,m.cN)(t),n=d.su.decode((0,m.io)(t,a)),s=(0,m.cN)(t),o=d.su.decode((0,m.io)(t,s));t.skip(16);let l=(0,m.cN)(t),c=(0,m.io)(t,l);this.metadataTags.images??=[],this.metadataTags.images.push({data:c,mimeType:n,kind:3===r?"coverFront":4===r?"coverBack":"unknown",description:o})}}if(e+=i,a){this.lastLoadedPos=e;break}}})()}async readNextFlacFrame({startPos:e,isFirstPacket:t}){(0,d.vA)(this.audioInfo);let r=this.audioInfo.maximumFrameSize+16,i=await this.reader.requestSliceRange(e,this.audioInfo.minimumFrameSize,r);if(!i)return null;let a=this.readFlacFrameHeader({slice:i,isFirstPacket:t});if(!a)return null;for(i.filePos=e+this.audioInfo.minimumFrameSize;;){if(i.filePos>i.end-6)return{num:a.num,blockSize:a.blockSize,sampleRate:a.sampleRate,size:i.end-e,isLastFrame:!0};if(255===(0,m.eo)(i)){let t=i.filePos;if((0,m.eo)(i)!==(1===this.blockingBit?249:248)){i.filePos=t;continue}i.skip(-2);let r=i.filePos-e,n=this.readFlacFrameHeader({slice:i,isFirstPacket:!1});if(!n){i.filePos=t;continue}if(0===this.blockingBit){if(n.num-a.num!=1){i.filePos=t;continue}}else if(n.num-a.num!==a.blockSize){i.filePos=t;continue}return{num:a.num,blockSize:a.blockSize,sampleRate:a.sampleRate,size:r,isLastFrame:!1}}}}readFlacFrameHeader({slice:e,isFirstPacket:t}){let r=e.filePos,i=(0,m.io)(e,4),a=new d._c(i);if(32764!==a.readBits(15))return null;if(null===this.blockingBit){(0,d.vA)(t);let e=a.readBits(1);this.blockingBit=e}else if(1===this.blockingBit){if((0,d.vA)(!t),1!==a.readBits(1))return null}else if(0===this.blockingBit){if((0,d.vA)(!t),0!==a.readBits(1))return null}else throw Error("Invalid blocking bit");let n=(0,Q.iv)(a.readBits(4));if(!n)return null;(0,d.vA)(this.audioInfo);let s=(0,Q.oP)(a.readBits(4),this.audioInfo.sampleRate);if(!s||(a.readBits(4),a.readBits(3),0!==a.readBits(1)))return null;let o=(0,Q.X7)(e),l=(0,Q.f6)(e,n),c=(0,Q.Ld)(e,s);if(null===c||c!==this.audioInfo.sampleRate)return null;let u=e.filePos-r,h=(0,m.eo)(e);return(e.skip(-u),e.skip(-1),h!==(0,Q.Be)((0,m.io)(e,u)))?null:{num:o,blockSize:l,sampleRate:c}}async advanceReader(){await this.readMetadata(),(0,d.vA)(null!==this.lastLoadedPos),(0,d.vA)(this.audioInfo);let e=this.lastLoadedPos,t=await this.readNextFlacFrame({startPos:e,isFirstPacket:0===this.loadedSamples.length});if(!t){this.lastSampleLoaded=!0;return}let r=this.loadedSamples[this.loadedSamples.length-1],i={blockOffset:r?r.blockOffset+r.blockSize:0,blockSize:t.blockSize,byteOffset:e,byteSize:t.size};if(this.lastLoadedPos=this.lastLoadedPos+t.size,this.loadedSamples.push(i),t.isLastFrame){this.lastSampleLoaded=!0;return}}}class Z{constructor(e){this.demuxer=e}getId(){return 1}getCodec(){return"flac"}getInternalCodecId(){return null}getNumberOfChannels(){return(0,d.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.numberOfChannels}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}getSampleRate(){return(0,d.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.sampleRate}getName(){return null}getLanguageCode(){return d.IR}getTimeResolution(){return(0,d.vA)(this.demuxer.audioInfo),this.demuxer.audioInfo.sampleRate}getDisposition(){return{...p.gM}}async getFirstTimestamp(){return 0}async getDecoderConfig(){return(0,d.vA)(this.demuxer.audioInfo),{codec:"flac",numberOfChannels:this.demuxer.audioInfo.numberOfChannels,sampleRate:this.demuxer.audioInfo.sampleRate,description:this.demuxer.audioInfo.description}}async getPacket(e,t){if((0,d.vA)(this.demuxer.audioInfo),e<0)throw Error("Timestamp cannot be negative");let r=await this.demuxer.readingMutex.acquire();try{for(;;){let r=(0,d.eE)(this.demuxer.loadedSamples,e,e=>e.blockOffset/this.demuxer.audioInfo.sampleRate);if(-1===r){await this.demuxer.advanceReader();continue}let i=this.demuxer.loadedSamples[r],a=i.blockOffset/this.demuxer.audioInfo.sampleRate,n=i.blockSize/this.demuxer.audioInfo.sampleRate;if(a+n<=e){if(this.demuxer.lastSampleLoaded)return this.getPacketAtIndex(this.demuxer.loadedSamples.length-1,t);await this.demuxer.advanceReader();continue}return this.getPacketAtIndex(r,t)}}finally{r()}}async getNextPacket(e,t){let r=await this.demuxer.readingMutex.acquire();try{let r=e.sequenceNumber+1;if(this.demuxer.lastSampleLoaded&&r>=this.demuxer.loadedSamples.length)return null;for(;r>=this.demuxer.loadedSamples.length&&!this.demuxer.lastSampleLoaded;)await this.demuxer.advanceReader();return this.getPacketAtIndex(r,t)}finally{r()}}getKeyPacket(e,t){return this.getPacket(e,t)}getNextKeyPacket(e,t){return this.getNextPacket(e,t)}async getPacketAtIndex(e,t){let r;let i=this.demuxer.loadedSamples[e];if(!i)return null;if(t.metadataOnly)r=u.T;else{let e=this.demuxer.reader.requestSlice(i.byteOffset,i.byteSize);if(e instanceof Promise&&(e=await e),!e)return null;r=(0,m.io)(e,i.byteSize)}(0,d.vA)(this.demuxer.audioInfo);let a=i.blockOffset/this.demuxer.audioInfo.sampleRate,n=i.blockSize/this.demuxer.audioInfo.sampleRate;return new u.Z(r,"key",a,n,e,i.byteSize)}async getFirstPacket(e){for(;0===this.demuxer.loadedSamples.length&&!this.demuxer.lastSampleLoaded;)await this.demuxer.advanceReader();return this.getPacketAtIndex(0,e)}}var G=r(5296);let Y="No PES packet found where one was expected.";class ee extends l.B{constructor(e){super(e),this.metadataPromise=null,this.elementaryStreams=[],this.tracks=[],this.packetOffset=0,this.packetStride=-1,this.reader=e._reader}async readMetadata(){return this.metadataPromise??=(async()=>{let e=G.ZT+16+1,t=this.reader.requestSlice(0,e);t instanceof Promise&&(t=await t),(0,d.vA)(t);let r=(0,m.io)(t,e);if(71===r[0]&&71===r[G.ZT])this.packetOffset=0,this.packetStride=G.ZT;else if(71===r[0]&&71===r[G.ZT+16])this.packetOffset=0,this.packetStride=G.ZT+16;else if(71===r[4]&&71===r[4+G.ZT])this.packetOffset=4,this.packetStride=G.ZT;else throw Error("Unreachable.");let i=this.packetOffset,a=null,n=!1,l=!1;for(;;){let e=await this.readSection(i,!0);if(!e)break;if(0!==e.pid||n){if(e.pid!==a||l){let t=this.elementaryStreams.find(t=>t.pid===e.pid);if(t&&!t.initialized){let r=er(e);if(!r)throw Error(`Couldn't read first PES packet for Elementary Stream with PID ${t.pid}`);if(t.firstSection=e,"video"===t.info.type){if("avc"===t.info.codec){if(t.info.avcCodecInfo=(0,o.fH)(r.data),!t.info.avcCodecInfo)throw Error("Invalid AVC video stream; could not extract AVCDecoderConfigurationRecord from first packet.");let e=t.info.avcCodecInfo.sequenceParameterSets[0];(0,d.vA)(e);let i=(0,o.eM)(e);t.info.width=i.displayWidth,t.info.height=i.displayHeight,t.info.colorSpace={primaries:d.BL[i.colourPrimaries],transfer:d.x_[i.transferCharacteristics],matrix:d.fl[i.matrixCoefficients],fullRange:!!i.fullRangeFlag},t.info.reorderSize=i.maxDecFrameBuffering,t.initialized=!0}else if("hevc"===t.info.codec){if(t.info.hevcCodecInfo=(0,o.D5)(r.data),!t.info.hevcCodecInfo)throw Error("Invalid HEVC video stream; could not extract HVCDecoderConfigurationRecord from first packet.");let e=t.info.hevcCodecInfo.arrays.find(e=>e.nalUnitType===o.iJ.SPS_NUT).nalUnits[0];(0,d.vA)(e);let i=(0,o.gT)(e);t.info.width=i.displayWidth,t.info.height=i.displayHeight,t.info.colorSpace={primaries:d.BL[i.colourPrimaries],transfer:d.x_[i.transferCharacteristics],matrix:d.fl[i.matrixCoefficients],fullRange:!!i.fullRangeFlag},t.info.reorderSize=i.maxDecFrameBuffering,t.initialized=!0}else throw Error("Unhandled.")}else if("aac"===t.info.codec){let e=m.x$.tempFromBytes(r.data),i=(0,K.lh)(e);if(!i)throw Error("Invalid AAC audio stream; could not read ADTS frame header from first packet.");t.info.aacCodecInfo={isMpeg2:!1,objectType:i.objectType},t.info.numberOfChannels=s.Ti[i.channelConfiguration],t.info.sampleRate=s.Im[i.samplingFrequencyIndex],t.initialized=!0}else if("mp3"===t.info.codec){let e=(0,m.cN)(m.x$.tempFromBytes(r.data)),i=(0,U.P8)(e,r.data.byteLength);if(!i.header)throw Error("Invalid MP3 audio stream; could not read frame header from first packet.");t.info.numberOfChannels=3===i.header.channel?1:2,t.info.sampleRate=i.header.sampleRate,t.initialized=!0}else throw Error("Unhandled.")}}else{let t=new d._c(e.payload),r=t.readAlignedByte();t.skipBits(8*r),t.skipBits(12);let i=t.readBits(12);t.skipBits(43),t.readBits(13),t.skipBits(6);let a=t.readBits(10);for(t.skipBits(8*a);8*(i+3)-t.pos>32;){let e=t.readBits(8);t.skipBits(3);let r=t.readBits(13);t.skipBits(6);let i=t.readBits(10);t.skipBits(8*i);let a=null;switch(e){case 3:case 4:case 15:a={type:"audio",codec:15===e?"aac":"mp3",aacCodecInfo:null,numberOfChannels:-1,sampleRate:-1};break;case 27:case 36:a={type:"video",codec:27===e?"avc":"hevc",avcCodecInfo:null,hevcCodecInfo:null,colorSpace:{primaries:null,transfer:null,matrix:null,fullRange:null},width:-1,height:-1,reorderSize:-1}}a&&this.elementaryStreams.push({demuxer:this,pid:r,streamType:e,initialized:!1,firstSection:null,info:a})}l=!0}}else{let t=new d._c(e.payload),r=t.readAlignedByte();t.skipBits(8*r),t.skipBits(14);let i=t.readBits(10);for(t.skipBits(40);8*(i+3)-t.pos>32;){let e=t.readBits(16);if(t.skipBits(3),0!==e){if(null!==a)throw Error("Only files with a single program are supported.");a=t.readBits(13)}}if(null===a)throw Error("Program Association Table must link to a Program Map Table.");n=!0}if(l&&this.elementaryStreams.every(e=>e.initialized))break;(0,d.vA)(null!==e.endPos),i=e.endPos}for(let e of this.elementaryStreams)"video"===e.info.type?this.tracks.push(new c.N0(this.input,new ea(e))):this.tracks.push(new c.Yi(this.input,new en(e)))})()}async getTracks(){return await this.readMetadata(),this.tracks}async getMetadataTags(){return{}}async computeDuration(){let e=await this.getTracks();return Math.max(0,...await Promise.all(e.map(e=>e.computeDuration())))}async getMimeType(){await this.readMetadata();let e=await this.getTracks(),t=await Promise.all(e.map(e=>e.getCodecParameterString()));return(0,G.Vx)(t)}async readSection(e,t){let r,i=e,a=e,n=[],s=0,o=null;for(;;){let e=await this.readPacket(a);if(a+=this.packetStride,!e)break;if(o){if(e.pid!==o.pid)continue;if(1===e.payloadUnitStartIndicator)break}else{if(0===e.payloadUnitStartIndicator)break;o=e}let r=!!(2&e.adaptationFieldControl),l=!!(1&e.adaptationFieldControl),c=0;if(r&&(c=1+e.body[0]),l&&(0===c?(n.push(e.body),s+=e.body.byteLength):(n.push(e.body.subarray(c)),s+=e.body.byteLength-c)),i=a,!t&&s>=64)break}if(!o)return null;if(1===n.length)r=n[0];else{r=new Uint8Array(n.reduce((e,t)=>e+t.length,0));let e=0;for(let t of n)r.set(t,e),e+=t.length}return{startPos:e,endPos:t?i:null,pid:o.pid,payload:r}}async readPacketHeader(e){let t=this.reader.requestSlice(e,4);if(t instanceof Promise&&(t=await t),!t)return null;if(71!==(0,m.eo)(t))throw Error("Invalid TS packet sync byte. Likely an internal bug, please report this file.");let r=(0,m.mH)(t);return{payloadUnitStartIndicator:r>>14&1,pid:8191&r,adaptationFieldControl:(0,m.eo)(t)>>4&3}}async readPacket(e){let t=this.reader.requestSlice(e,G.ZT);if(t instanceof Promise&&(t=await t),!t)return null;let r=(0,m.io)(t,G.ZT);if(71!==r[0])throw Error("Invalid TS packet sync byte. Likely an internal bug, please report this file.");let i=(r[1]<<8)+r[2];return{payloadUnitStartIndicator:i>>14&1,pid:8191&i,adaptationFieldControl:r[3]>>4&3,body:r.subarray(4)}}}let et=e=>{let t=new d._c(e.payload);if(1!==t.readBits(24))return null;let r=t.readBits(8);if(t.skipBits(16),188===r||190===r||191===r||240===r||241===r||255===r||242===r||248===r)return null;t.skipBits(8);let i=t.readBits(2);t.skipBits(14);let a=0;if(2===i||3===i)t.skipBits(4),a+=0x40000000*t.readBits(3),t.skipBits(1),a+=32768*t.readBits(15),t.skipBits(1),a+=t.readBits(15);else throw Error("PES packets without PTS are not currently supported. If you think this file should be supported, please report it.");return{sectionStartPos:e.startPos,sectionEndPos:e.endPos,pts:a}},er=e=>{(0,d.vA)(null!==e.endPos);let t=et(e);if(!t)return null;let r=new d._c(e.payload);r.skipBits(32);let i=r.readBits(16);r.skipBits(16);let a=r.readBits(8),n=r.pos+8*a;r.pos=n;let s=n/8;(0,d.vA)(Number.isInteger(s));let o=e.payload.subarray(s,i>0?6+i:e.payload.byteLength);return{...t,data:o}};class ei{constructor(e){this.elementaryStream=e,this.referencePesPackets=[],this.endReferencePesPacketAdded=!1,this.packetBuffers=new WeakMap,this.packetSectionStarts=new WeakMap,this.mutex=new d.aD}getId(){return this.elementaryStream.pid}getCodec(){throw Error("Not implemented on base class.")}getInternalCodecId(){return this.elementaryStream.streamType}getName(){return null}getLanguageCode(){return d.IR}getDisposition(){return p.gM}getTimeResolution(){return G.cS}async computeDuration(){let e=await this.getPacket(1/0,{metadataOnly:!0});return(e?.timestamp??0)+(e?.duration??0)}async getFirstTimestamp(){let e=await this.getFirstPacket({metadataOnly:!0});return e?.timestamp??0}createEncodedPacket(e,t,r){return new u.Z(r.metadataOnly?u.T:e.data,this.getPacketType(e.data),e.pts/G.cS,Math.max(t/G.cS,0),e.sequenceNumber,e.data.byteLength)}maybeInsertReferencePacket(e,t,r){if(r&&this.mutex.pending>0)return;let i=(0,d.eE)(this.referencePesPackets,e.pts,e=>e.pts);if(i>=0){let r=this.referencePesPackets[i];if(e.sectionStartPos<=r.sectionStartPos||!t&&e.pts-r.pts<G.cS/2)return!1;if(i<this.referencePesPackets.length-1){let r=this.referencePesPackets[i+1];if(r.sectionStartPos<e.sectionStartPos||!t&&r.pts-e.pts<G.cS/2)return!1}}return this.referencePesPackets.splice(i+1,0,e),!0}async getFirstPacket(e){let t=this.elementaryStream.firstSection;(0,d.vA)(t);let r=er(t);(0,d.vA)(r);let i=new eo(this,new es(this,r,!0)),a=await i.readNext();if(!a)return null;let n=this.createEncodedPacket(a.packet,a.duration,e);return this.packetBuffers.set(n,i),this.packetSectionStarts.set(n,a.packet.sectionStartPos),n}async getNextPacket(e,t){let r=this.packetBuffers.get(e);if(r){let i=await r.readNext();if(!i)return null;this.packetBuffers.delete(e);let a=this.createEncodedPacket(i.packet,i.duration,t);return this.packetBuffers.set(a,r),this.packetSectionStarts.set(a,i.packet.sectionStartPos),a}let i=this.packetSectionStarts.get(e);if(void 0===i)throw Error("Packet was not created from this track.");let a=this.elementaryStream.demuxer,n=await a.readSection(i,!0);(0,d.vA)(n);let s=er(n);(0,d.vA)(s),r=new eo(this,new es(this,s,!0));let o=e.sequenceNumber;for(;;){let e=await r.readNext();if(!e)return null;if(e.packet.sequenceNumber>o){let i=this.createEncodedPacket(e.packet,e.duration,t);return this.packetBuffers.set(i,r),this.packetSectionStarts.set(i,e.packet.sectionStartPos),i}}}async getNextKeyPacket(e,t){let r=e;for(;;){if(!(r=await this.getNextPacket(r,t)))return null;if("key"===r.type)return r}}getPacket(e,t){return this.doPacketLookup(e,!1,t)}getKeyPacket(e,t){return this.doPacketLookup(e,!0,t)}async doPacketLookup(e,t,r){let i;let a=(0,d.aI)(e*G.cS),n=this.elementaryStream.demuxer,s=n.reader,o=await this.mutex.acquire();try{if(0===this.referencePesPackets.length){let e=this.elementaryStream.firstSection;(0,d.vA)(e);let t=et(e);(0,d.vA)(t),this.maybeInsertReferencePacket(t,!1,!1),(0,d.vA)(1===this.referencePesPackets.length)}let e=(0,d.eE)(this.referencePesPackets,a,e=>e.pts);if(-1===e)return null;if(null!==s.fileSize&&e===this.referencePesPackets.length-1&&!this.endReferencePesPacketAdded){let e=s.fileSize-n.packetStride+n.packetOffset,t=await n.readPacketHeader(e);if(!t)return null;for(;t.pid!==this.elementaryStream.pid||0===t.payloadUnitStartIndicator;){e-=n.packetStride;let r=await n.readPacketHeader(e);if(!r)return null;t=r}let r=await n.readSection(e,!1);(0,d.vA)(r);let i=et(r);if(!i)throw Error(Y);this.maybeInsertReferencePacket(i,!0,!1),this.endReferencePesPacketAdded=!0}for(e=(0,d.eE)(this.referencePesPackets,a,e=>e.pts),(0,d.vA)(-1!==e);null!==s.fileSize;){let t=this.referencePesPackets[e],r=this.referencePesPackets[e+1];if(a-t.pts<G.cS||!r)break;let i=(0,d.in)((t.sectionStartPos+r.sectionStartPos)/2,n.packetStride)+n.packetOffset,s=await n.readPacketHeader(i);for((0,d.vA)(s);i<r.sectionStartPos&&(s.pid!==this.elementaryStream.pid||0===s.payloadUnitStartIndicator);){i+=n.packetStride;let e=await n.readPacketHeader(i);if(!e)return null;s=e}if(i>=r.sectionStartPos)break;let o=await n.readSection(i,!1);(0,d.vA)(o);let l=et(o);if(!l)throw Error(Y);if(!this.maybeInsertReferencePacket(l,!1,!1))break;l.pts<=a&&e++}i=this.referencePesPackets[e],(0,d.vA)(i.pts<=a)}finally{o()}o();e:for(;;){let e=i.sectionStartPos+n.packetStride;for(;;){let t=await n.readPacketHeader(e);if(!t)break e;if(t.pid===this.elementaryStream.pid&&1===t.payloadUnitStartIndicator)break;e+=n.packetStride}let t=await n.readSection(e,!1);if(!t)break;let r=et(t);if(!r)throw Error(Y);if(r.pts>a)break;i=r,null===s.fileSize&&this.maybeInsertReferencePacket(r,!1,!0)}let l=this.getReorderSize();for(let e=0;e<l;e++){let e=i.sectionStartPos-n.packetStride;for(;;){let t=await n.readPacketHeader(e);if(!t)break;if(t.pid===this.elementaryStream.pid&&1===t.payloadUnitStartIndicator){let t=await n.readSection(e,!1);(0,d.vA)(t);let r=et(t);if(!r)throw Error(Y);i=r;break}e-=n.packetStride}}let c=await n.readSection(i.sectionStartPos,!0);(0,d.vA)(c);let u=er(c);(0,d.vA)(u);let h=new eo(this,new es(this,u,!0));for(;!((d._g(h.presentationOrderPackets)?.pts??-1/0)>=a)&&await h.readNextDecodeOrderPacket(););let f=(0,d.Kl)(h.presentationOrderPackets,e=>e.pts<=a&&(!t||"key"===this.getPacketType(e.data)));if(-1!==f){let e=h.presentationOrderPackets[f],t=0===f?0:e.pts-h.presentationOrderPackets[f-1].pts;for(;h.decodeOrderPackets[0]!==e;)h.decodeOrderPackets.shift();h.lastDuration=t;let i=await h.readNext();(0,d.vA)(i);let a=this.createEncodedPacket(i.packet,i.duration,r);return this.packetBuffers.set(a,h),this.packetSectionStarts.set(a,i.packet.sectionStartPos),a}if(!t)return null;let m=i.sectionStartPos;for(;;){m-=n.packetStride;let e=await n.readPacketHeader(m);if(!e)return null;if(e.pid!==this.elementaryStream.pid||1!==e.payloadUnitStartIndicator)continue;let t=await n.readSection(m,!0);(0,d.vA)(t);let i=er(t);if(!i)throw Error(Y);let a=new es(this,i,!1);if(await this.markNextPacket(a),!a.suppliedPacket||"key"!==this.getPacketType(a.suppliedPacket.data))continue;a.uncapped=!0;let s=new eo(this,a),o=await s.readNext();(0,d.vA)(o);let l=this.createEncodedPacket(o.packet,o.duration,r);return this.packetBuffers.set(l,s),this.packetSectionStarts.set(l,o.packet.sectionStartPos),l}}}class ea extends ei{constructor(e){super(e),this.elementaryStream=e,this.decoderConfig={codec:(0,s.QP)({width:this.elementaryStream.info.width,height:this.elementaryStream.info.height,codec:this.elementaryStream.info.codec,codecDescription:null,colorSpace:this.elementaryStream.info.colorSpace,avcType:1,avcCodecInfo:this.elementaryStream.info.avcCodecInfo,hevcCodecInfo:this.elementaryStream.info.hevcCodecInfo,vp9CodecInfo:null,av1CodecInfo:null}),codedWidth:this.elementaryStream.info.width,codedHeight:this.elementaryStream.info.height,colorSpace:this.elementaryStream.info.colorSpace}}getCodec(){return this.elementaryStream.info.codec}getCodedWidth(){return this.elementaryStream.info.width}getCodedHeight(){return this.elementaryStream.info.height}getRotation(){return 0}async getColorSpace(){return this.elementaryStream.info.colorSpace}async canBeTransparent(){return!1}async getDecoderConfig(){return this.decoderConfig}getPacketType(e){return(0,o.PR)(this.elementaryStream.info.codec,this.decoderConfig,e)??"key"}getReorderSize(){return this.elementaryStream.info.reorderSize}async markNextPacket(e){(0,d.vA)(!e.suppliedPacket);let t=this.elementaryStream.info.codec,r=null;for(;;){let i=e.ensureBuffered(1024);if(i instanceof Promise&&(i=await i),0===i)break;let a=e.currentPos,n=e.readBytes(i),s=n.byteLength,l=0;for(;l<s;){let i=n.indexOf(0,l);if(-1===i||i>=s)break;let c=a+(l=i);if(l+4>=s){e.seekTo(c);break}let d=n[l+1],u=n[l+2],h=n[l+3],f=0,m=null;if(0===d&&0===u&&1===h?(f=4,m=n[l+4]):0===d&&1===u&&(f=3,m=h),0===f){l++;continue}if(null===r){r=c,l+=f;continue}if(null!==m){let i="avc"===t?(0,o.uN)(m):(0,o.O9)(m);if("avc"===t?i===o.mY.AUD:i===o.iJ.AUD_NUT){let t=c-r;return e.seekTo(r),e.supplyPacket(t,0)}}l+=f}if(i<1024)break}if(null!==r){let t=e.endPos-r;return e.seekTo(r),e.supplyPacket(t,0)}}}class en extends ei{constructor(e){super(e),this.elementaryStream=e}getCodec(){return this.elementaryStream.info.codec}getNumberOfChannels(){return this.elementaryStream.info.numberOfChannels}getSampleRate(){return this.elementaryStream.info.sampleRate}async getDecoderConfig(){return{codec:(0,s.X0)({codec:this.elementaryStream.info.codec,codecDescription:null,aacCodecInfo:this.elementaryStream.info.aacCodecInfo}),numberOfChannels:this.elementaryStream.info.numberOfChannels,sampleRate:this.elementaryStream.info.sampleRate}}getPacketType(e){return"key"}getReorderSize(){return 1}async markNextPacket(e){(0,d.vA)(!e.suppliedPacket);let t=this.elementaryStream.info.codec;for(;;){let r=e.ensureBuffered(128);r instanceof Promise&&(r=await r);let i=e.currentPos;for(;e.currentPos-i<r;){let r=e.readU8();if("aac"===t){if(255!==r)continue;e.skip(-1);let t=e.currentPos,i=e.ensureBuffered(K.Y$);if(i instanceof Promise&&(i=await i),i<K.Y$)return;let a=e.readBytes(K.Y$),n=(0,K.lh)(m.x$.tempFromBytes(a));if(n){e.seekTo(t);let r=e.ensureBuffered(n.frameLength);return r instanceof Promise&&(r=await r),e.supplyPacket(r,Math.round(1024*G.cS/this.elementaryStream.info.sampleRate))}e.seekTo(t+1)}else if("mp3"===t){if(255!==r)continue;e.skip(-1);let t=e.currentPos,i=e.ensureBuffered(U.Yq);if(i instanceof Promise&&(i=await i),i<U.Yq)return;let a=e.readBytes(U.Yq),n=(0,d.Zc)(a).getUint32(0),s=(0,U.P8)(n,null);if(s.header){e.seekTo(t);let r=e.ensureBuffered(s.header.totalSize);r instanceof Promise&&(r=await r);let i=s.header.audioSamplesInFrame*G.cS/this.elementaryStream.info.sampleRate;return e.supplyPacket(r,Math.round(i))}e.seekTo(t+1)}else throw Error("Unreachable")}if(r<128)break}}}class es{constructor(e,t,r){this.currentPos=0,this.pesPackets=[],this.currentPesPacketIndex=0,this.currentPesPacketPos=0,this.endPos=0,this.nextPts=0,this.suppliedPacket=null,this.backing=e,this.pid=e.elementaryStream.pid,this.demuxer=e.elementaryStream.demuxer,this.startingPesPacket=t,this.uncapped=r}clone(){let e=new es(this.backing,this.startingPesPacket,!0);return e.currentPos=this.currentPos,e.pesPackets=[...this.pesPackets],e.currentPesPacketIndex=this.currentPesPacketIndex,e.currentPesPacketPos=this.currentPesPacketPos,e.endPos=this.endPos,e.nextPts=this.nextPts,e}ensureBuffered(e){let t=this.endPos-this.currentPos;return t>=e?e:this.bufferData(e-t).then(()=>Math.min(this.endPos-this.currentPos,e))}getCurrentPesPacket(){let e=this.pesPackets[this.currentPesPacketIndex];return(0,d.vA)(e),e}async bufferData(e){let t=this.endPos+e;for(;this.endPos<t;){let e;if(0===this.pesPackets.length)e=this.startingPesPacket;else{let t=(0,d._g)(this.pesPackets).sectionEndPos;for((0,d.vA)(null!==t);;){let e=await this.demuxer.readPacketHeader(t);if(!e)return;if(e.pid===this.pid)break;t+=this.demuxer.packetStride}let r=await this.demuxer.readSection(t,!0);if(!r)return;let i=er(r);if(!i)throw Error(Y);e=i}this.pesPackets.push(e),this.endPos+=e.data.byteLength,1===this.pesPackets.length&&(this.nextPts=e.pts)}}readBytes(e){let t=this.getCurrentPesPacket(),r=this.currentPos-this.currentPesPacketPos,i=r+e;if(this.currentPos+=e,i<=t.data.byteLength)return t.data.subarray(r,i);let a=new Uint8Array(e);a.set(t.data.subarray(r));let n=t.data.byteLength-r;for(;;){this.advanceCurrentPacket();let t=this.getCurrentPesPacket(),r=e-n;if(r<=t.data.byteLength){a.set(t.data.subarray(0,r),n);break}a.set(t.data,n),n+=t.data.byteLength}return a}readU8(){let e=this.getCurrentPesPacket(),t=this.currentPos-this.currentPesPacketPos;return(this.currentPos++,t<e.data.byteLength)?e.data[t]:(this.advanceCurrentPacket(),(e=this.getCurrentPesPacket()).data[0])}seekTo(e){if(e!==this.currentPos){if(e<this.currentPos)for(;e<this.currentPesPacketPos;){this.currentPesPacketIndex--;let e=this.getCurrentPesPacket();this.currentPesPacketPos-=e.data.byteLength,this.nextPts=e.pts}else for(;;){let t=this.getCurrentPesPacket();if(e<this.currentPesPacketPos+t.data.byteLength)break;this.currentPesPacketPos+=t.data.byteLength,this.currentPesPacketIndex++,this.nextPts=this.getCurrentPesPacket().pts}this.currentPos=e}}skip(e){this.seekTo(this.currentPos+e)}advanceCurrentPacket(){this.currentPesPacketPos+=this.getCurrentPesPacket().data.byteLength,this.currentPesPacketIndex++,this.nextPts=this.getCurrentPesPacket().pts}supplyPacket(e,t){let r=this.getCurrentPesPacket();if(!this.uncapped&&r!==this.startingPesPacket){this.suppliedPacket=null;return}this.backing.maybeInsertReferencePacket(r,!1,!0);let i=this.nextPts;this.nextPts+=t;let a=r.sectionStartPos,n=a+(this.currentPos-this.currentPesPacketPos),s=this.readBytes(e);this.suppliedPacket={pts:i,data:s,sequenceNumber:n,sectionStartPos:a},this.pesPackets.splice(0,this.currentPesPacketIndex),this.currentPesPacketIndex=0}}class eo{constructor(e,t){this.decodeOrderPackets=[],this.reorderBuffer=[],this.presentationOrderPackets=[],this.reachedEnd=!1,this.lastDuration=0,this.backing=e,this.context=t,this.reorderSize=e.getReorderSize(),(0,d.vA)(this.reorderSize>=0)}async readNext(){let e;if(0===this.decodeOrderPackets.length&&!await this.readNextDecodeOrderPacket())return null;await this.ensureCurrentPacketHasNext();let t=this.decodeOrderPackets[0],r=this.presentationOrderPackets.indexOf(t);for((0,d.vA)(-1!==r),r===this.presentationOrderPackets.length-1?e=this.lastDuration:(e=this.presentationOrderPackets[r+1].pts-t.pts,this.lastDuration=e),this.decodeOrderPackets.shift();this.presentationOrderPackets.length>0;){let e=this.presentationOrderPackets[0];if(this.decodeOrderPackets.includes(e))break;this.presentationOrderPackets.shift()}return{packet:t,duration:e}}async readNextDecodeOrderPacket(){let e;return!this.reachedEnd&&((this.context.suppliedPacket||await this.backing.markNextPacket(this.context),e=this.context.suppliedPacket,this.context.suppliedPacket=null,e)?(this.decodeOrderPackets.push(e),this.processPacketThroughReorderBuffer(e),!0):(this.reachedEnd=!0,this.flushReorderBuffer(),!1))}async ensureCurrentPacketHasNext(){let e=this.decodeOrderPackets[0];for((0,d.vA)(e);;){let t=this.presentationOrderPackets.indexOf(e);if(-1!==t&&t<=this.presentationOrderPackets.length-2||!await this.readNextDecodeOrderPacket())break}}processPacketThroughReorderBuffer(e){if(this.reorderBuffer.push(e),this.reorderBuffer.length>=this.reorderSize){let e=0;for(let t=1;t<this.reorderBuffer.length;t++)this.reorderBuffer[t].pts<this.reorderBuffer[e].pts&&(e=t);let t=this.reorderBuffer.splice(e,1)[0];this.presentationOrderPackets.push(t)}}flushReorderBuffer(){this.reorderBuffer.sort((e,t)=>e.pts-t.pts),this.presentationOrderPackets.push(...this.reorderBuffer),this.reorderBuffer.length=0}}class el{}class ec extends el{async _getMajorBrand(e){let t=e._reader.requestSlice(0,12);return(t instanceof Promise&&(t=await t),t)?(t.skip(4),"ftyp"!==(0,m.IT)(t,4))?null:(0,m.IT)(t,4):null}_createDemuxer(e){return new g(e)}}class ed extends ec{async _canReadInput(e){let t=await this._getMajorBrand(e);return!!t&&"qt  "!==t}get name(){return"MP4"}get mimeType(){return"video/mp4"}}class eu extends ec{async _canReadInput(e){return"qt  "===await this._getMajorBrand(e)}get name(){return"QuickTime File Format"}get mimeType(){return"video/quicktime"}}class eh extends el{async isSupportedEBMLOfDocType(e,t){let r=e._reader.requestSlice(0,I.r1);if(r instanceof Promise&&(r=await r),!r)return!1;let i=(0,I.YO)(r);if(null===i||i<1||i>8||(0,I.dl)(r,i)!==I.Cl.EBML)return!1;let a=(0,I.Kb)(r);if("number"!=typeof a)return!1;let n=e._reader.requestSlice(r.filePos,a);if(n instanceof Promise&&(n=await n),!n)return!1;let s=r.filePos;for(;n.filePos<=s+a-I.De;){let e=(0,I.ur)(n);if(!e)break;let{id:r,size:i}=e,a=n.filePos;if(void 0===i)return!1;switch(r){case I.Cl.EBMLVersion:case I.Cl.EBMLReadVersion:if(1!==(0,I.dl)(n,i))return!1;break;case I.Cl.DocType:if((0,I.IX)(n,i)!==t)return!1;break;case I.Cl.DocTypeVersion:if((0,I.dl)(n,i)>4)return!1}n.filePos=a+i}return!0}_canReadInput(e){return this.isSupportedEBMLOfDocType(e,"matroska")}_createDemuxer(e){return new M(e)}get name(){return"Matroska"}get mimeType(){return"video/x-matroska"}}class ef extends eh{_canReadInput(e){return this.isSupportedEBMLOfDocType(e,"webm")}get name(){return"WebM"}get mimeType(){return"video/webm"}}class em extends el{async _canReadInput(e){let t=e._reader.requestSlice(0,10);if(t instanceof Promise&&(t=await t),!t)return!1;let r=0,i=!1;for(;;){let t=e._reader.requestSlice(r,R.sY);if(t instanceof Promise&&(t=await t),!t)break;let a=(0,R.IX)(t);if(!a)break;i=!0,r=t.filePos+a.size}let a=await D(e._reader,r,r+4096);if(!a)return!1;if(i)return!0;r=a.startPos+a.header.totalSize;let n=await D(e._reader,r,r+U.Yq);if(!n)return!1;let s=a.header,o=n.header;return s.channel===o.channel&&s.sampleRate===o.sampleRate}_createDemuxer(e){return new N(e)}get name(){return"MP3"}get mimeType(){return"audio/mpeg"}}class ep extends el{async _canReadInput(e){let t=e._reader.requestSlice(0,12);if(t instanceof Promise&&(t=await t),!t)return!1;let r=(0,m.IT)(t,4);return("RIFF"===r||"RIFX"===r||"RF64"===r)&&(t.skip(4),"WAVE"===(0,m.IT)(t,4))}_createDemuxer(e){return new q.E(e)}get name(){return"WAVE"}get mimeType(){return"audio/wav"}}class eg extends el{async _canReadInput(e){let t=e._reader.requestSlice(0,4);return t instanceof Promise&&(t=await t),!!t&&"OggS"===(0,m.IT)(t,4)}_createDemuxer(e){return new V(e)}get name(){return"Ogg"}get mimeType(){return"application/ogg"}}class ey extends el{async _canReadInput(e){let t=e._reader.requestSlice(0,4);return t instanceof Promise&&(t=await t),!!t&&"fLaC"===(0,m.IT)(t,4)}get name(){return"FLAC"}get mimeType(){return"audio/flac"}_createDemuxer(e){return new J(e)}}class eb extends el{async _canReadInput(e){let t=e._reader.requestSliceRange(0,K.gc,K.Y$);if(t instanceof Promise&&(t=await t),!t)return!1;let r=(0,K.lh)(t);if(!r||((t=e._reader.requestSliceRange(r.frameLength,K.gc,K.Y$))instanceof Promise&&(t=await t),!t))return!1;let i=(0,K.lh)(t);return!!i&&r.objectType===i.objectType&&r.samplingFrequencyIndex===i.samplingFrequencyIndex&&r.channelConfiguration===i.channelConfiguration}_createDemuxer(e){return new W(e)}get name(){return"ADTS"}get mimeType(){return"audio/aac"}}class ek extends el{async _canReadInput(e){let t=G.ZT+16+1,r=e._reader.requestSlice(0,t);if(r instanceof Promise&&(r=await r),!r)return!1;let i=(0,m.io)(r,t);return 71===i[0]&&71===i[G.ZT]||71===i[0]&&71===i[G.ZT+16]||71===i[4]&&71===i[4+G.ZT]}_createDemuxer(e){return new ee(e)}get name(){return"MPEG Transport Stream"}get mimeType(){return"video/MP2T"}}let ew=new ed,ev=new eu,ex=new eh,eT=new ef,eS=new em,eC=new ep,eP=new eg,eI=new eb,eE=[ew,ev,ex,eT,eC,eP,new ey,eS,eI,new ek]},5247:(e,t,r)=>{r.d(t,{Ts:()=>c,kL:()=>o});var i,a=r(8734),n=r(1845),s=r(6194);void 0!==(i||(i=r.t(n,2)))&&(i||(i=r.t(n,2)));class o{constructor(){this._disposed=!1,this._sizePromise=null,this.onread=null}async getSizeOrNull(){if(this._disposed)throw new s.Q;return this._sizePromise??=Promise.resolve(this._retrieveSize())}async getSize(){if(this._disposed)throw new s.Q;let e=await this.getSizeOrNull();if(null===e)throw Error("Cannot determine the size of an unsized source.");return e}}let l=(e,t,r)=>{if(t instanceof Error&&(t.message.includes("Failed to fetch")||t.message.includes("Load failed")||t.message.includes("NetworkError when attempting to fetch resource"))){let e=null;try{"undefined"!=typeof window&&void 0!==window.location&&(e=new URL(r instanceof Request?r.url:r,window.location.href).origin)}catch{}if(("undefined"==typeof navigator||"boolean"!=typeof navigator.onLine||navigator.onLine)&&null!==e&&e!==window.location.origin)return console.warn("Request will not be retried because a CORS error was suspected due to different origins. You can modify this behavior by providing your own function for the 'getRetryDelay' option."),null}return Math.min(2**(e-2),16)};class c extends o{constructor(e,t={}){if("string"!=typeof e&&!(e instanceof URL)&&!("undefined"!=typeof Request&&e instanceof Request))throw TypeError("url must be a string, URL or Request.");if(!t||"object"!=typeof t)throw TypeError("options must be an object.");if(void 0!==t.requestInit&&(!t.requestInit||"object"!=typeof t.requestInit))throw TypeError("options.requestInit, when provided, must be an object.");if(void 0!==t.getRetryDelay&&"function"!=typeof t.getRetryDelay)throw TypeError("options.getRetryDelay, when provided, must be a function.");if(void 0!==t.maxCacheSize&&(!(0,a.Et)(t.maxCacheSize)||t.maxCacheSize<0))throw TypeError("options.maxCacheSize, when provided, must be a non-negative number.");if(void 0!==t.fetchFn&&"function"!=typeof t.fetchFn)throw TypeError("options.fetchFn, when provided, must be a function.");super(),this._existingResponses=new WeakMap,this._url=e,this._options=t,this._getRetryDelay=t.getRetryDelay??l,this._orchestrator=new u({maxCacheSize:t.maxCacheSize??0x4000000,maxWorkerCount:2,runWorker:this._runWorker.bind(this),prefetchProfile:d.network})}async _retrieveSize(){let e,t;let r=new AbortController,i=await (0,a.G8)(this._options.fetchFn??fetch,this._url,(0,a._h)(this._options.requestInit??{},{headers:{Range:"bytes=0-"},signal:r.signal}),this._getRetryDelay,()=>this._disposed);if(!i.ok)throw Error(`Error fetching ${String(this._url)}: ${i.status} ${i.statusText}`);if(206===i.status)t=this._getTotalLengthFromRangeResponse(i),e=this._orchestrator.createWorker(0,Math.min(t,524288));else{let r=i.headers.get("Content-Length");if(r)t=Number(r),e=this._orchestrator.createWorker(0,t),this._orchestrator.options.maxCacheSize=1/0,console.warn("HTTP server did not respond with 206 Partial Content, meaning the entire remote resource now has to be downloaded. For efficient media file streaming across a network, please make sure your server supports range requests.");else throw Error(`HTTP response (status ${i.status}) must surface Content-Length header.`)}return this._orchestrator.fileSize=t,this._existingResponses.set(e,{response:i,abortController:r}),this._orchestrator.runWorker(e),t}_read(e,t){return this._orchestrator.read(e,t)}async _runWorker(e){for(;;){let t=this._existingResponses.get(e);this._existingResponses.delete(e);let r=t?.abortController,i=t?.response;if(r||(r=new AbortController,i=await (0,a.G8)(this._options.fetchFn??fetch,this._url,(0,a._h)(this._options.requestInit??{},{headers:{Range:`bytes=${e.currentPos}-`},signal:r.signal}),this._getRetryDelay,()=>this._disposed)),(0,a.vA)(i),!i.ok)throw Error(`Error fetching ${String(this._url)}: ${i.status} ${i.statusText}`);if(e.currentPos>0&&206!==i.status)throw Error("HTTP server did not respond with 206 Partial Content to a range request. To enable efficient media file streaming across a network, please make sure your server supports range requests.");if(!i.body)throw Error("Missing HTTP response body stream. The used fetch function must provide the response body as a ReadableStream.");let n=i.body.getReader();for(;;){let t;if(e.currentPos>=e.targetPos||e.aborted){r.abort(),e.running=!1;return}try{t=await n.read()}catch(t){if(this._disposed)throw t;let e=this._getRetryDelay(1,t,this._url);if(null!==e){console.error("Error while reading response stream. Attempting to resume.",t),await new Promise(t=>setTimeout(t,1e3*e));break}throw t}if(e.aborted)continue;let{done:i,value:a}=t;if(i){if(e.currentPos>=e.targetPos){this._orchestrator.forgetWorker(e),e.running=!1;return}break}this.onread?.(e.currentPos,e.currentPos+a.length),this._orchestrator.supplyWorkerData(e,a)}}}_getTotalLengthFromRangeResponse(e){let t=e.headers.get("Content-Range");if(t){let e=/\/(\d+)/.exec(t);if(e)return Number(e[1])}let r=e.headers.get("Content-Length");if(r)return Number(r);throw Error("Partial HTTP response (status 206) must surface either Content-Range or Content-Length header.")}_dispose(){this._orchestrator.dispose()}}let d={network:(e,t,r)=>{for(let i of(e=Math.max(0,65536*Math.floor((e-65536)/65536)),r)){let r=Math.max((i.startPos+i.targetPos)/2,i.targetPos-8388608);if((0,a.oX)(e,t,r,i.targetPos)){let e=i.targetPos-i.startPos,r=8388608*Math.ceil((e+1)/8388608),a=Math.min(2**Math.ceil(Math.log2(e+1)),r);t=Math.max(t,i.startPos+a)}}return t=Math.max(t,e+524288),{start:e,end:t}}};class u{constructor(e){this.options=e,this.fileSize=null,this.nextAge=0,this.workers=[],this.cache=[],this.currentCacheSize=0,this.disposed=!1}read(e,t){(0,a.vA)(null!==this.fileSize);let r=this.options.prefetchProfile(e,t,this.workers),i=Math.max(r.start,0),n=Math.min(r.end,this.fileSize);(0,a.vA)(i<=e&&t<=n);let s=null,o=(0,a.eE)(this.cache,e,e=>e.start),l=-1!==o?this.cache[o]:null;l&&l.start<=e&&t<=l.end&&(l.age=this.nextAge++,s={bytes:l.bytes,view:l.view,offset:l.start});let c=(0,a.eE)(this.cache,i,e=>e.start),d=s?null:new Uint8Array(t-e),u=0,h=i,f=[];if(-1!==c){for(let r=c;r<this.cache.length;r++){let s=this.cache[r];if(s.start>=n)break;if(s.end<=i)continue;let o=Math.max(i,s.start),l=Math.min(n,s.end);if((0,a.vA)(o<=l),h<o&&f.push({start:h,end:o}),h=l,d){let r=Math.max(e,s.start),i=Math.min(t,s.end);if(r<i){let t=r-e;d.set(s.bytes.subarray(r-s.start,i-s.start),t),t===u&&(u=i-e)}}s.age=this.nextAge++}h<n&&f.push({start:h,end:n})}else f.push({start:i,end:n});if(d&&u>=d.length&&(s={bytes:d,view:(0,a.Zc)(d),offset:e}),0===f.length)return(0,a.vA)(s),s;let{promise:m,resolve:p,reject:g}=(0,a.nJ)(),y=[];for(let r of f){let i=Math.max(e,r.start),a=Math.min(t,r.end);i===r.start&&a===r.end?y.push(r):i<a&&y.push({start:i,end:a})}for(let t of f){let r=d&&{start:e,bytes:d,holes:y,resolve:p,reject:g},i=!1;for(let e of this.workers)if((0,a.oX)(t.start-131072,t.start,e.currentPos,e.targetPos)){e.targetPos=Math.max(e.targetPos,t.end),i=!0,r&&!e.pendingSlices.includes(r)&&e.pendingSlices.push(r),e.running||this.runWorker(e);break}if(!i){let e=this.createWorker(t.start,t.end);r&&(e.pendingSlices=[r]),this.runWorker(e)}}return s||((0,a.vA)(d),s=m.then(t=>({bytes:t,view:(0,a.Zc)(t),offset:e}))),s}createWorker(e,t){let r={startPos:e,currentPos:e,targetPos:t,running:!1,aborted:this.disposed,pendingSlices:[],age:this.nextAge++};for(this.workers.push(r);this.workers.length>this.options.maxWorkerCount;){let e=0,t=this.workers[0];for(let r=1;r<this.workers.length;r++){let i=this.workers[r];i.age<t.age&&(e=r,t=i)}if(t.running&&t.pendingSlices.length>0)break;t.aborted=!0,this.workers.splice(e,1)}return r}runWorker(e){(0,a.vA)(!e.running),(0,a.vA)(e.currentPos<e.targetPos),e.running=!0,e.age=this.nextAge++,this.options.runWorker(e).catch(t=>{if(e.running=!1,e.pendingSlices.length>0)e.pendingSlices.forEach(e=>e.reject(t)),e.pendingSlices.length=0;else throw t})}supplyWorkerData(e,t){(0,a.vA)(!e.aborted);let r=e.currentPos,i=r+t.length;this.insertIntoCache({start:r,end:i,bytes:t,view:(0,a.Zc)(t),age:this.nextAge++}),e.currentPos+=t.length,e.targetPos=Math.max(e.targetPos,e.currentPos);for(let a=0;a<e.pendingSlices.length;a++){let n=e.pendingSlices[a],s=Math.max(r,n.start),o=Math.min(i,n.start+n.bytes.length);s<o&&n.bytes.set(t.subarray(s-r,o-r),s-n.start);for(let e=0;e<n.holes.length;e++){let t=n.holes[e];r<=t.start&&i>t.start&&(t.start=i),t.end<=t.start&&(n.holes.splice(e,1),e--)}0===n.holes.length&&(n.resolve(n.bytes),e.pendingSlices.splice(a,1),a--)}for(let t=0;t<this.workers.length;t++){let n=this.workers[t];e!==n&&!n.running&&(0,a.oX)(r,i,n.currentPos,n.targetPos)&&(this.workers.splice(t,1),t--)}}forgetWorker(e){let t=this.workers.indexOf(e);(0,a.vA)(-1!==t),this.workers.splice(t,1)}insertIntoCache(e){if(0===this.options.maxCacheSize)return;let t=(0,a.eE)(this.cache,e.start,e=>e.start)+1;if(t>0){let r=this.cache[t-1];if(r.end>=e.end)return;if(r.end>e.start){let i=new Uint8Array(e.end-r.start);i.set(r.bytes,0),i.set(e.bytes,e.start-r.start),this.currentCacheSize+=e.end-r.end,r.bytes=i,r.view=(0,a.Zc)(i),r.end=e.end,t--,e=r}else this.cache.splice(t,0,e),this.currentCacheSize+=e.bytes.length}else this.cache.splice(t,0,e),this.currentCacheSize+=e.bytes.length;for(let r=t+1;r<this.cache.length;r++){let t=this.cache[r];if(e.end<=t.start)break;if(e.end>=t.end){this.cache.splice(r,1),this.currentCacheSize-=t.bytes.length,r--;continue}let i=new Uint8Array(t.end-e.start);i.set(e.bytes,0),i.set(t.bytes,t.start-e.start),this.currentCacheSize-=e.end-t.start,e.bytes=i,e.view=(0,a.Zc)(i),e.end=t.end,this.cache.splice(r,1);break}for(;this.currentCacheSize>this.options.maxCacheSize;){let e=0,t=this.cache[0];for(let r=1;r<this.cache.length;r++){let i=this.cache[r];i.age<t.age&&(e=r,t=i)}if(this.currentCacheSize-t.bytes.length<=this.options.maxCacheSize)break;this.cache.splice(e,1),this.currentCacheSize-=t.bytes.length}}dispose(){for(let e of this.workers)e.aborted=!0;this.workers.length=0,this.cache.length=0,this.disposed=!0}}},5296:(e,t,r)=>{r.d(t,{Vx:()=>n,ZT:()=>a,cS:()=>i});let i=9e4,a=188,n=e=>{let t="video/MP2T",r=[...new Set(e.filter(Boolean))];return r.length>0&&(t+=`; codecs="${r.join(", ")}"`),t}},5356:(e,t,r)=>{r.d(t,{B1:()=>b,U2:()=>c,px:()=>h,wS:()=>f});var i=r(8734);(0,i.XQ)();let a=-1/0,n=-1/0,s=null;"undefined"!=typeof FinalizationRegistry&&(s=new FinalizationRegistry(e=>{let t=Date.now();"video"===e.type?(t-a>=1e3&&(console.error("A VideoSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your VideoSamples as soon as you're done using them."),a=t),"undefined"!=typeof VideoFrame&&e.data instanceof VideoFrame&&e.data.close()):(t-n>=1e3&&(console.error("An AudioSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your AudioSamples as soon as you're done using them."),n=t),"undefined"!=typeof AudioData&&e.data instanceof AudioData&&e.data.close())}));let o=["I420","I420P10","I420P12","I420A","I420AP10","I420AP12","I422","I422P10","I422P12","I422A","I422AP10","I422AP12","I444","I444P10","I444P12","I444A","I444AP10","I444AP12","NV12","RGBA","RGBX","BGRA","BGRX"],l=new Set(o);class c{get displayWidth(){return this.rotation%180==0?this.codedWidth:this.codedHeight}get displayHeight(){return this.rotation%180==0?this.codedHeight:this.codedWidth}get microsecondTimestamp(){return Math.trunc(i.MW*this.timestamp)}get microsecondDuration(){return Math.trunc(i.MW*this.duration)}get hasAlpha(){return this.format&&this.format.includes("A")}constructor(e,t){if(this._closed=!1,e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer||ArrayBuffer.isView(e)){if(!t||"object"!=typeof t)throw TypeError("init must be an object.");if(void 0===t.format||!l.has(t.format))throw TypeError("init.format must be one of: "+o.join(", "));if(!Number.isInteger(t.codedWidth)||t.codedWidth<=0)throw TypeError("init.codedWidth must be a positive integer.");if(!Number.isInteger(t.codedHeight)||t.codedHeight<=0)throw TypeError("init.codedHeight must be a positive integer.");if(void 0!==t.rotation&&![0,90,180,270].includes(t.rotation))throw TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(t.timestamp))throw TypeError("init.timestamp must be a number.");if(void 0!==t.duration&&(!Number.isFinite(t.duration)||t.duration<0))throw TypeError("init.duration, when provided, must be a non-negative number.");this._data=(0,i.Fo)(e).slice(),this._layout=t.layout??p(t.format,t.codedWidth,t.codedHeight),this.format=t.format,this.codedWidth=t.codedWidth,this.codedHeight=t.codedHeight,this.rotation=t.rotation??0,this.timestamp=t.timestamp,this.duration=t.duration??0,this.colorSpace=new d(t.colorSpace)}else if("undefined"!=typeof VideoFrame&&e instanceof VideoFrame){if(t?.rotation!==void 0&&![0,90,180,270].includes(t.rotation))throw TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(t?.timestamp!==void 0&&!Number.isFinite(t?.timestamp))throw TypeError("init.timestamp, when provided, must be a number.");if(t?.duration!==void 0&&(!Number.isFinite(t.duration)||t.duration<0))throw TypeError("init.duration, when provided, must be a non-negative number.");this._data=e,this._layout=null,this.format=e.format,this.codedWidth=e.displayWidth,this.codedHeight=e.displayHeight,this.rotation=t?.rotation??0,this.timestamp=t?.timestamp??e.timestamp/1e6,this.duration=t?.duration??(e.duration??0)/1e6,this.colorSpace=new d(e.colorSpace)}else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof SVGImageElement&&e instanceof SVGImageElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){if(!t||"object"!=typeof t)throw TypeError("init must be an object.");if(void 0!==t.rotation&&![0,90,180,270].includes(t.rotation))throw TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(t.timestamp))throw TypeError("init.timestamp must be a number.");if(void 0!==t.duration&&(!Number.isFinite(t.duration)||t.duration<0))throw TypeError("init.duration, when provided, must be a non-negative number.");if("undefined"!=typeof VideoFrame)return new c(new VideoFrame(e,{timestamp:Math.trunc(t.timestamp*i.MW),duration:Math.trunc((t.duration??0)*i.MW)||void 0}),t);let r=0,a=0;if("naturalWidth"in e?(r=e.naturalWidth,a=e.naturalHeight):"videoWidth"in e?(r=e.videoWidth,a=e.videoHeight):"width"in e&&(r=Number(e.width),a=Number(e.height)),!r||!a)throw TypeError("Could not determine dimensions.");let n=new OffscreenCanvas(r,a),s=n.getContext("2d",{alpha:(0,i.gm)(),willReadFrequently:!0});(0,i.vA)(s),s.drawImage(e,0,0),this._data=n,this._layout=null,this.format="RGBX",this.codedWidth=r,this.codedHeight=a,this.rotation=t.rotation??0,this.timestamp=t.timestamp,this.duration=t.duration??0,this.colorSpace=new d({matrix:"rgb",primaries:"bt709",transfer:"iec61966-2-1",fullRange:!0})}else throw TypeError("Invalid data type: Must be a BufferSource or CanvasImageSource.");s?.register(this,{type:"video",data:this._data},this)}clone(){if(this._closed)throw Error("VideoSample is closed.");return((0,i.vA)(null!==this._data),u(this._data))?new c(this._data.clone(),{timestamp:this.timestamp,duration:this.duration,rotation:this.rotation}):this._data instanceof Uint8Array?((0,i.vA)(this._layout),new c(this._data,{format:this.format,layout:this._layout,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})):new c(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})}close(){!this._closed&&(s?.unregister(this),u(this._data)?this._data.close():this._data=null,this._closed=!0)}allocationSize(e={}){if(m(e),this._closed)throw Error("VideoSample is closed.");if(null===this.format)throw Error("Cannot get allocation size when format is null. Sorry!");if((0,i.vA)(null!==this._data),!u(this._data)&&(e.colorSpace||e.format&&e.format!==this.format||e.layout||e.rect)){let t=this.toVideoFrame(),r=t.allocationSize(e);return t.close(),r}return u(this._data)?this._data.allocationSize(e):this._data instanceof Uint8Array?this._data.byteLength:this.codedWidth*this.codedHeight*4}async copyTo(e,t={}){if(!(0,i.SM)(e))throw TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(m(t),this._closed)throw Error("VideoSample is closed.");if(null===this.format)throw Error("Cannot copy video sample data when format is null. Sorry!");if((0,i.vA)(null!==this._data),!u(this._data)&&(t.colorSpace||t.format&&t.format!==this.format||t.layout||t.rect)){let r=this.toVideoFrame(),i=await r.copyTo(e,t);return r.close(),i}if(u(this._data))return this._data.copyTo(e,t);if(this._data instanceof Uint8Array)return(0,i.vA)(this._layout),(0,i.Fo)(e).set(this._data),this._layout;{let t=this._data.getContext("2d");(0,i.vA)(t);let r=t.getImageData(0,0,this.codedWidth,this.codedHeight);return(0,i.Fo)(e).set(r.data),[{offset:0,stride:4*this.codedWidth}]}}toVideoFrame(){if(this._closed)throw Error("VideoSample is closed.");return((0,i.vA)(null!==this._data),u(this._data))?new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0}):this._data instanceof Uint8Array?new VideoFrame(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0,colorSpace:this.colorSpace}):new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0})}draw(e,t,r,i,a,n,s,o,l){let c=0,d=0,u=this.displayWidth,h=this.displayHeight,f=0,m=0,p=this.displayWidth,g=this.displayHeight;if(void 0!==n?(c=t,d=r,u=i,h=a,f=n,m=s,void 0!==o?(p=o,g=l):(p=u,g=h)):(f=t,m=r,void 0!==i&&(p=i,g=a)),!("undefined"!=typeof CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!=typeof OffscreenCanvasRenderingContext2D&&e instanceof OffscreenCanvasRenderingContext2D))throw TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!Number.isFinite(c))throw TypeError("sx must be a number.");if(!Number.isFinite(d))throw TypeError("sy must be a number.");if(!Number.isFinite(u)||u<0)throw TypeError("sWidth must be a non-negative number.");if(!Number.isFinite(h)||h<0)throw TypeError("sHeight must be a non-negative number.");if(!Number.isFinite(f))throw TypeError("dx must be a number.");if(!Number.isFinite(m))throw TypeError("dy must be a number.");if(!Number.isFinite(p)||p<0)throw TypeError("dWidth must be a non-negative number.");if(!Number.isFinite(g)||g<0)throw TypeError("dHeight must be a non-negative number.");if(this._closed)throw Error("VideoSample is closed.");({sx:c,sy:d,sWidth:u,sHeight:h}=this._rotateSourceRegion(c,d,u,h,this.rotation));let y=this.toCanvasImageSource();e.save();let b=f+p/2,k=m+g/2;e.translate(b,k),e.rotate(this.rotation*Math.PI/180);let w=this.rotation%180==0?1:p/g;e.scale(1/w,w),e.drawImage(y,c,d,u,h,-p/2,-g/2,p,g),e.restore()}drawWithFit(e,t){let r,i,a,n;if(!("undefined"!=typeof CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!=typeof OffscreenCanvasRenderingContext2D&&e instanceof OffscreenCanvasRenderingContext2D))throw TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!t||"object"!=typeof t)throw TypeError("options must be an object.");if(!["fill","contain","cover"].includes(t.fit))throw TypeError("options.fit must be 'fill', 'contain', or 'cover'.");if(void 0!==t.rotation&&![0,90,180,270].includes(t.rotation))throw TypeError("options.rotation, when provided, must be 0, 90, 180, or 270.");void 0!==t.crop&&f(t.crop,"options.");let s=e.canvas.width,o=e.canvas.height,l=t.rotation??this.rotation,[c,d]=l%180==0?[this.codedWidth,this.codedHeight]:[this.codedHeight,this.codedWidth];t.crop&&h(t.crop,c,d);let{sx:u,sy:m,sWidth:p,sHeight:g}=this._rotateSourceRegion(t.crop?.left??0,t.crop?.top??0,t.crop?.width??c,t.crop?.height??d,l);if("fill"===t.fit)r=0,i=0,a=s,n=o;else{let[e,l]=t.crop?[t.crop.width,t.crop.height]:[c,d],u="contain"===t.fit?Math.min(s/e,o/l):Math.max(s/e,o/l);a=e*u,n=l*u,r=(s-a)/2,i=(o-n)/2}e.save();let y=l%180==0?1:a/n;e.translate(s/2,o/2),e.rotate(l*Math.PI/180),e.scale(1/y,y),e.translate(-s/2,-o/2),e.drawImage(this.toCanvasImageSource(),u,m,p,g,r,i,a,n),e.restore()}_rotateSourceRegion(e,t,r,i,a){return 90===a?[e,t,r,i]=[t,this.codedHeight-e-r,i,r]:180===a?[e,t]=[this.codedWidth-e-r,this.codedHeight-t-i]:270===a&&([e,t,r,i]=[this.codedWidth-t-i,e,i,r]),{sx:e,sy:t,sWidth:r,sHeight:i}}toCanvasImageSource(){if(this._closed)throw Error("VideoSample is closed.");if((0,i.vA)(null!==this._data),!(this._data instanceof Uint8Array))return this._data;{let e=this.toVideoFrame();return queueMicrotask(()=>e.close()),e}}setRotation(e){if(![0,90,180,270].includes(e))throw TypeError("newRotation must be 0, 90, 180, or 270.");this.rotation=e}setTimestamp(e){if(!Number.isFinite(e))throw TypeError("newTimestamp must be a number.");this.timestamp=e}setDuration(e){if(!Number.isFinite(e)||e<0)throw TypeError("newDuration must be a non-negative number.");this.duration=e}[Symbol.dispose](){this.close()}}class d{constructor(e){this.primaries=e?.primaries??null,this.transfer=e?.transfer??null,this.matrix=e?.matrix??null,this.fullRange=e?.fullRange??null}toJSON(){return{primaries:this.primaries,transfer:this.transfer,matrix:this.matrix,fullRange:this.fullRange}}}let u=e=>"undefined"!=typeof VideoFrame&&e instanceof VideoFrame,h=(e,t,r)=>{e.left=Math.min(e.left,t),e.top=Math.min(e.top,r),e.width=Math.min(e.width,t-e.left),e.height=Math.min(e.height,r-e.top),(0,i.vA)(e.width>=0),(0,i.vA)(e.height>=0)},f=(e,t)=>{if(!e||"object"!=typeof e)throw TypeError(t+"crop, when provided, must be an object.");if(!Number.isInteger(e.left)||e.left<0)throw TypeError(t+"crop.left must be a non-negative integer.");if(!Number.isInteger(e.top)||e.top<0)throw TypeError(t+"crop.top must be a non-negative integer.");if(!Number.isInteger(e.width)||e.width<0)throw TypeError(t+"crop.width must be a non-negative integer.");if(!Number.isInteger(e.height)||e.height<0)throw TypeError(t+"crop.height must be a non-negative integer.")},m=e=>{if(!e||"object"!=typeof e)throw TypeError("options must be an object.");if(void 0!==e.colorSpace&&!["display-p3","srgb"].includes(e.colorSpace))throw TypeError("options.colorSpace, when provided, must be 'display-p3' or 'srgb'.");if(void 0!==e.format&&"string"!=typeof e.format)throw TypeError("options.format, when provided, must be a string.");if(void 0!==e.layout){if(!Array.isArray(e.layout))throw TypeError("options.layout, when provided, must be an array.");for(let t of e.layout){if(!t||"object"!=typeof t)throw TypeError("Each entry in options.layout must be an object.");if(!Number.isInteger(t.offset)||t.offset<0)throw TypeError("plane.offset must be a non-negative integer.");if(!Number.isInteger(t.stride)||t.stride<0)throw TypeError("plane.stride must be a non-negative integer.")}}if(void 0!==e.rect){if(!e.rect||"object"!=typeof e.rect)throw TypeError("options.rect, when provided, must be an object.");if(void 0!==e.rect.x&&(!Number.isInteger(e.rect.x)||e.rect.x<0))throw TypeError("options.rect.x, when provided, must be a non-negative integer.");if(void 0!==e.rect.y&&(!Number.isInteger(e.rect.y)||e.rect.y<0))throw TypeError("options.rect.y, when provided, must be a non-negative integer.");if(void 0!==e.rect.width&&(!Number.isInteger(e.rect.width)||e.rect.width<0))throw TypeError("options.rect.width, when provided, must be a non-negative integer.");if(void 0!==e.rect.height&&(!Number.isInteger(e.rect.height)||e.rect.height<0))throw TypeError("options.rect.height, when provided, must be a non-negative integer.")}},p=(e,t,r)=>{let i=g(e),a=[],n=0;for(let e of i){let i=Math.ceil(t/e.widthDivisor),s=Math.ceil(r/e.heightDivisor),o=i*e.sampleBytes,l=o*s;a.push({offset:n,stride:o}),n+=l}return a},g=e=>{let t=(e,t,r,i,a)=>{let n=[{sampleBytes:e,widthDivisor:1,heightDivisor:1},{sampleBytes:t,widthDivisor:r,heightDivisor:i},{sampleBytes:t,widthDivisor:r,heightDivisor:i}];return a&&n.push({sampleBytes:e,widthDivisor:1,heightDivisor:1}),n};switch(e){case"I420":return t(1,1,2,2,!1);case"I420P10":case"I420P12":return t(2,2,2,2,!1);case"I420A":return t(1,1,2,2,!0);case"I420AP10":case"I420AP12":return t(2,2,2,2,!0);case"I422":return t(1,1,2,1,!1);case"I422P10":case"I422P12":return t(2,2,2,1,!1);case"I422A":return t(1,1,2,1,!0);case"I422AP10":case"I422AP12":return t(2,2,2,1,!0);case"I444":return t(1,1,1,1,!1);case"I444P10":case"I444P12":return t(2,2,1,1,!1);case"I444A":return t(1,1,1,1,!0);case"I444AP10":case"I444AP12":return t(2,2,1,1,!0);case"NV12":return[{sampleBytes:1,widthDivisor:1,heightDivisor:1},{sampleBytes:2,widthDivisor:2,heightDivisor:2}];case"RGBA":case"RGBX":case"BGRA":case"BGRX":return[{sampleBytes:4,widthDivisor:1,heightDivisor:1}];default:(0,i.xb)(e),(0,i.vA)(!1)}},y=new Set(["f32","f32-planar","s16","s16-planar","s32","s32-planar","u8","u8-planar"]);class b{get microsecondTimestamp(){return Math.trunc(i.MW*this.timestamp)}get microsecondDuration(){return Math.trunc(i.MW*this.duration)}constructor(e){if(this._closed=!1,T(e)){if(null===e.format)throw TypeError("AudioData with null format is not supported.");this._data=e,this.format=e.format,this.sampleRate=e.sampleRate,this.numberOfFrames=e.numberOfFrames,this.numberOfChannels=e.numberOfChannels,this.timestamp=e.timestamp/1e6,this.duration=e.numberOfFrames/e.sampleRate}else{let t;if(!e||"object"!=typeof e)throw TypeError("Invalid AudioDataInit: must be an object.");if(!y.has(e.format))throw TypeError("Invalid AudioDataInit: invalid format.");if(!Number.isFinite(e.sampleRate)||e.sampleRate<=0)throw TypeError("Invalid AudioDataInit: sampleRate must be > 0.");if(!Number.isInteger(e.numberOfChannels)||0===e.numberOfChannels)throw TypeError("Invalid AudioDataInit: numberOfChannels must be an integer > 0.");if(!Number.isFinite(e?.timestamp))throw TypeError("init.timestamp must be a number.");let r=e.data.byteLength/(k(e.format)*e.numberOfChannels);if(!Number.isInteger(r))throw TypeError("Invalid AudioDataInit: data size is not a multiple of frame size.");if(this.format=e.format,this.sampleRate=e.sampleRate,this.numberOfFrames=r,this.numberOfChannels=e.numberOfChannels,this.timestamp=e.timestamp,this.duration=r/e.sampleRate,e.data instanceof ArrayBuffer)t=new Uint8Array(e.data);else if(ArrayBuffer.isView(e.data))t=new Uint8Array(e.data.buffer,e.data.byteOffset,e.data.byteLength);else throw TypeError("Invalid AudioDataInit: data is not a BufferSource.");let i=this.numberOfFrames*this.numberOfChannels*k(this.format);if(t.byteLength<i)throw TypeError("Invalid AudioDataInit: insufficient data size.");this._data=t}s?.register(this,{type:"audio",data:this._data},this)}allocationSize(e){if(!e||"object"!=typeof e)throw TypeError("options must be an object.");if(!Number.isInteger(e.planeIndex)||e.planeIndex<0)throw TypeError("planeIndex must be a non-negative integer.");if(void 0!==e.format&&!y.has(e.format))throw TypeError("Invalid format.");if(void 0!==e.frameOffset&&(!Number.isInteger(e.frameOffset)||e.frameOffset<0))throw TypeError("frameOffset must be a non-negative integer.");if(void 0!==e.frameCount&&(!Number.isInteger(e.frameCount)||e.frameCount<0))throw TypeError("frameCount must be a non-negative integer.");if(this._closed)throw Error("AudioSample is closed.");let t=e.format??this.format,r=e.frameOffset??0;if(r>=this.numberOfFrames)throw RangeError("frameOffset out of range");let i=void 0!==e.frameCount?e.frameCount:this.numberOfFrames-r;if(i>this.numberOfFrames-r)throw RangeError("frameCount out of range");let a=k(t),n=w(t);if(n&&e.planeIndex>=this.numberOfChannels||!n&&0!==e.planeIndex)throw RangeError("planeIndex out of range");return(n?i:i*this.numberOfChannels)*a}copyTo(e,t){if(!(0,i.SM)(e))throw TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(!t||"object"!=typeof t)throw TypeError("options must be an object.");if(!Number.isInteger(t.planeIndex)||t.planeIndex<0)throw TypeError("planeIndex must be a non-negative integer.");if(void 0!==t.format&&!y.has(t.format))throw TypeError("Invalid format.");if(void 0!==t.frameOffset&&(!Number.isInteger(t.frameOffset)||t.frameOffset<0))throw TypeError("frameOffset must be a non-negative integer.");if(void 0!==t.frameCount&&(!Number.isInteger(t.frameCount)||t.frameCount<0))throw TypeError("frameCount must be a non-negative integer.");if(this._closed)throw Error("AudioSample is closed.");let{planeIndex:r,format:a,frameCount:n,frameOffset:s}=t,o=this.format,l=a??this.format;if(!l)throw Error("Destination format not determined");let c=this.numberOfFrames,d=this.numberOfChannels,u=s??0;if(u>=c)throw RangeError("frameOffset out of range");let h=void 0!==n?n:c-u;if(h>c-u)throw RangeError("frameCount out of range");let f=k(l),m=w(l);if(m&&r>=d||!m&&0!==r)throw RangeError("planeIndex out of range");let p=m?h:h*d;if(e.byteLength<p*f)throw RangeError("Destination buffer is too small");let g=(0,i.Zc)(e),b=x(l);if(T(this._data))(0,i.Tc)()&&d>2&&l!==o?S(this._data,g,o,l,d,r,u,h):this._data.copyTo(e,{planeIndex:r,frameOffset:u,frameCount:h,format:l});else{let e=this._data,t=(0,i.Zc)(e),a=v(o),n=k(o),s=w(o);for(let e=0;e<h;e++)if(m){let i;b(g,e*f,a(t,s?(r*c+(e+u))*n:((e+u)*d+r)*n))}else for(let r=0;r<d;r++){let i;b(g,(e*d+r)*f,a(t,s?(r*c+(e+u))*n:((e+u)*d+r)*n))}}}clone(){if(this._closed)throw Error("AudioSample is closed.");if(!T(this._data))return new b({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.timestamp,data:this._data});{let e=new b(this._data.clone());return e.setTimestamp(this.timestamp),e}}close(){!this._closed&&(s?.unregister(this),T(this._data)?this._data.close():this._data=new Uint8Array(0),this._closed=!0)}toAudioData(){if(this._closed)throw Error("AudioSample is closed.");if(!T(this._data))return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:this._data.buffer instanceof ArrayBuffer?this._data.buffer:this._data.slice()});if(this._data.timestamp===this.microsecondTimestamp)return this._data.clone();if(w(this.format)){let e=this.allocationSize({planeIndex:0,format:this.format}),t=new ArrayBuffer(e*this.numberOfChannels);for(let r=0;r<this.numberOfChannels;r++)this.copyTo(new Uint8Array(t,r*e,e),{planeIndex:r,format:this.format});return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:t})}{let e=new ArrayBuffer(this.allocationSize({planeIndex:0,format:this.format}));return this.copyTo(e,{planeIndex:0,format:this.format}),new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:e})}}toAudioBuffer(){if(this._closed)throw Error("AudioSample is closed.");let e=new AudioBuffer({numberOfChannels:this.numberOfChannels,length:this.numberOfFrames,sampleRate:this.sampleRate}),t=new Float32Array(this.allocationSize({planeIndex:0,format:"f32-planar"})/4);for(let r=0;r<this.numberOfChannels;r++)this.copyTo(t,{planeIndex:r,format:"f32-planar"}),e.copyToChannel(t,r);return e}setTimestamp(e){if(!Number.isFinite(e))throw TypeError("newTimestamp must be a number.");this.timestamp=e}[Symbol.dispose](){this.close()}static*_fromAudioBuffer(e,t){if(!(e instanceof AudioBuffer))throw TypeError("audioBuffer must be an AudioBuffer.");let r=e.numberOfChannels,i=e.sampleRate,a=e.length,n=Math.floor(24e4/r),s=0,o=a;for(;o>0;){let a=Math.min(n,o),l=new Float32Array(r*a);for(let t=0;t<r;t++)e.copyFromChannel(l.subarray(t*a,(t+1)*a),t,s);yield new b({format:"f32-planar",sampleRate:i,numberOfFrames:a,numberOfChannels:r,timestamp:t+s/i,data:l}),s+=a,o-=a}}static fromAudioBuffer(e,t){if(!(e instanceof AudioBuffer))throw TypeError("audioBuffer must be an AudioBuffer.");let r=e.numberOfChannels,i=e.sampleRate,a=e.length,n=Math.floor(24e4/r),s=0,o=a,l=[];for(;o>0;){let a=Math.min(n,o),c=new Float32Array(r*a);for(let t=0;t<r;t++)e.copyFromChannel(c.subarray(t*a,(t+1)*a),t,s);let d=new b({format:"f32-planar",sampleRate:i,numberOfFrames:a,numberOfChannels:r,timestamp:t+s/i,data:c});l.push(d),s+=a,o-=a}return l}}let k=e=>{switch(e){case"u8":case"u8-planar":return 1;case"s16":case"s16-planar":return 2;case"s32":case"s32-planar":case"f32":case"f32-planar":return 4;default:throw Error("Unknown AudioSampleFormat")}},w=e=>{switch(e){case"u8-planar":case"s16-planar":case"s32-planar":case"f32-planar":return!0;default:return!1}},v=e=>{switch(e){case"u8":case"u8-planar":return(e,t)=>(e.getUint8(t)-128)/128;case"s16":case"s16-planar":return(e,t)=>e.getInt16(t,!0)/32768;case"s32":case"s32-planar":return(e,t)=>e.getInt32(t,!0)/0x80000000;case"f32":case"f32-planar":return(e,t)=>e.getFloat32(t,!0)}},x=e=>{switch(e){case"u8":case"u8-planar":return(e,t,r)=>e.setUint8(t,(0,i.qE)((r+1)*127.5,0,255));case"s16":case"s16-planar":return(e,t,r)=>e.setInt16(t,(0,i.qE)(Math.round(32767*r),-32768,32767),!0);case"s32":case"s32-planar":return(e,t,r)=>e.setInt32(t,(0,i.qE)(Math.round(0x7fffffff*r),-0x80000000,0x7fffffff),!0);case"f32":case"f32-planar":return(e,t,r)=>e.setFloat32(t,r,!0)}},T=e=>"undefined"!=typeof AudioData&&e instanceof AudioData,S=(e,t,r,a,n,s,o,l)=>{let c=v(r),d=x(a),u=k(r),h=k(a),f=w(r);if(w(a)){if(f){let a=new ArrayBuffer(l*u),n=(0,i.Zc)(a);e.copyTo(a,{planeIndex:s,frameOffset:o,frameCount:l,format:r});for(let e=0;e<l;e++){let r=e*u;d(t,e*h,c(n,r))}}else{let a=new ArrayBuffer(l*n*u),f=(0,i.Zc)(a);e.copyTo(a,{planeIndex:0,frameOffset:o,frameCount:l,format:r});for(let e=0;e<l;e++){let r=(e*n+s)*u;d(t,e*h,c(f,r))}}}else if(f){let a=new ArrayBuffer(l*u),s=(0,i.Zc)(a);for(let i=0;i<n;i++){e.copyTo(a,{planeIndex:i,frameOffset:o,frameCount:l,format:r});for(let e=0;e<l;e++){let r=e*u;d(t,(e*n+i)*h,c(s,r))}}}else{let a=new ArrayBuffer(l*n*u),s=(0,i.Zc)(a);e.copyTo(a,{planeIndex:0,frameOffset:o,frameCount:l,format:r});for(let e=0;e<l;e++)for(let r=0;r<n;r++){let i=e*n+r,a=i*u;d(t,i*h,c(s,a))}}}},5555:(e,t,r)=>{r.d(t,{$L:()=>h,Cp:()=>f,IS:()=>d,Vl:()=>l,Xk:()=>o,ZM:()=>s,hs:()=>u,vX:()=>c});var i=r(4159),a=r(8734),n=r(8113);let s=8,o=16,l=e=>{let t=(0,n.cN)(e),r=(0,n.IT)(e,4),i=8;1===t&&(t=(0,n.th)(e),i=16);let a=t-i;return a<0?null:{name:r,totalSize:t,headerSize:i,contentSize:a}},c=e=>(0,n.Ar)(e)/65536,d=e=>(0,n.Ar)(e)/0x40000000,u=e=>{let t=0;for(let r=0;r<4;r++){t<<=7;let r=(0,n.eo)(e);if(t|=127&r,(128&r)==0)break}return t},h=e=>{let t=(0,n.mH)(e);return e.skip(2),t=Math.min(t,e.remainingLength),a.su.decode((0,n.io)(e,t))},f=e=>{let t=l(e);if(!t||"data"!==t.name||e.remainingLength<8)return null;let r=(0,n.cN)(e);e.skip(4);let s=(0,n.io)(e,t.contentSize-8);switch(r){case 1:return a.su.decode(s);case 2:return new TextDecoder("utf-16be").decode(s);case 13:return new i.sF(s,"image/jpeg");case 14:return new i.sF(s,"image/png");case 27:return new i.sF(s,"image/bmp");default:return s}}},5799:(e,t,r)=>{r.d(t,{A3:()=>n,BP:()=>w,Co:()=>j,D5:()=>I,GE:()=>p,HR:()=>c,KU:()=>k,O9:()=>C,Oc:()=>q,PR:()=>H,Qf:()=>O,RF:()=>T,RO:()=>d,UU:()=>z,Us:()=>R,WY:()=>K,Zi:()=>y,_u:()=>l,bs:()=>N,eM:()=>v,fH:()=>b,gT:()=>P,hf:()=>D,iJ:()=>a,ls:()=>$,mY:()=>i,pc:()=>g,uN:()=>h});var i,a,n,s=r(3468),o=r(8734);!function(e){e[e.NON_IDR_SLICE=1]="NON_IDR_SLICE",e[e.SLICE_DPA=2]="SLICE_DPA",e[e.SLICE_DPB=3]="SLICE_DPB",e[e.SLICE_DPC=4]="SLICE_DPC",e[e.IDR=5]="IDR",e[e.SEI=6]="SEI",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.AUD=9]="AUD",e[e.SPS_EXT=13]="SPS_EXT"}(i||(i={})),function(e){e[e.RASL_N=8]="RASL_N",e[e.RASL_R=9]="RASL_R",e[e.BLA_W_LP=16]="BLA_W_LP",e[e.RSV_IRAP_VCL23=23]="RSV_IRAP_VCL23",e[e.VPS_NUT=32]="VPS_NUT",e[e.SPS_NUT=33]="SPS_NUT",e[e.PPS_NUT=34]="PPS_NUT",e[e.AUD_NUT=35]="AUD_NUT",e[e.PREFIX_SEI_NUT=39]="PREFIX_SEI_NUT",e[e.SUFFIX_SEI_NUT=40]="SUFFIX_SEI_NUT"}(a||(a={}));let l=function*(e){let t=0,r=-1;for(;t<e.length-2;){let i=e.indexOf(0,t);if(-1===i||i>=e.length-2)break;let a=0;if((t=i)+3<e.length&&0===e[t+1]&&0===e[t+2]&&1===e[t+3]?a=4:0===e[t+1]&&1===e[t+2]&&(a=3),0===a){t++;continue}-1!==r&&t>r&&(yield{offset:r,length:t-r}),t=r=t+a}-1!==r&&r<e.length&&(yield{offset:r,length:e.length-r})},c=function*(e,t){let r=0,i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;r+t<=e.length;){let e;1===t?e=i.getUint8(r):2===t?e=i.getUint16(r,!1):3===t?e=(0,o.dq)(i,r,!1):((0,o.vA)(4===t),e=i.getUint32(r,!1)),r+=t,yield{offset:r,length:e},r+=e}},d=(e,t)=>t.description?c(e,(3&(0,o.Fo)(t.description)[4])+1):l(e),u=function*(e){yield*l(e)},h=e=>31&e,f=e=>{let t=[],r=e.length;for(let i=0;i<r;i++)i+2<r&&0===e[i]&&0===e[i+1]&&3===e[i+2]?(t.push(0,0),i+=2):t.push(e[i]);return new Uint8Array(t)},m=new Uint8Array([0,0,0,1]),p=e=>{let t=new Uint8Array(e.reduce((e,t)=>e+m.byteLength+t.byteLength,0)),r=0;for(let i of e)t.set(m,r),r+=m.byteLength,t.set(i,r),r+=i.byteLength;return t},g=(e,t)=>{let r=new Uint8Array(e.reduce((e,r)=>e+t+r.byteLength,0)),i=0;for(let a of e){let e=new DataView(r.buffer,r.byteOffset,r.byteLength);switch(t){case 1:e.setUint8(i,a.byteLength);break;case 2:e.setUint16(i,a.byteLength,!1);break;case 3:(0,o.jD)(e,i,a.byteLength,!1);break;case 4:e.setUint32(i,a.byteLength,!1)}i+=t,r.set(a,i),i+=a.byteLength}return r},y=(e,t)=>t.description?g(e,(3&(0,o.Fo)(t.description)[4])+1):p(e),b=e=>{try{let t=[],r=[],a=[];for(let n of u(e)){let s=e.subarray(n.offset,n.offset+n.length),o=h(s[0]);o===i.SPS?t.push(s):o===i.PPS?r.push(s):o===i.SPS_EXT&&a.push(s)}if(0===t.length||0===r.length)return null;let n=t[0],s=v(n);(0,o.vA)(null!==s);let l=100===s.profileIdc||110===s.profileIdc||122===s.profileIdc||144===s.profileIdc;return{configurationVersion:1,avcProfileIndication:s.profileIdc,profileCompatibility:s.constraintFlags,avcLevelIndication:s.levelIdc,lengthSizeMinusOne:3,sequenceParameterSets:t,pictureParameterSets:r,chromaFormat:l?s.chromaFormatIdc:null,bitDepthLumaMinus8:l?s.bitDepthLumaMinus8:null,bitDepthChromaMinus8:l?s.bitDepthChromaMinus8:null,sequenceParameterSetExt:l?a:null}}catch(e){return console.error("Error building AVC Decoder Configuration Record:",e),null}},k=e=>{let t=[];for(let r of(t.push(e.configurationVersion),t.push(e.avcProfileIndication),t.push(e.profileCompatibility),t.push(e.avcLevelIndication),t.push(252|3&e.lengthSizeMinusOne),t.push(224|31&e.sequenceParameterSets.length),e.sequenceParameterSets)){let e=r.byteLength;t.push(e>>8),t.push(255&e);for(let i=0;i<e;i++)t.push(r[i])}for(let r of(t.push(e.pictureParameterSets.length),e.pictureParameterSets)){let e=r.byteLength;t.push(e>>8),t.push(255&e);for(let i=0;i<e;i++)t.push(r[i])}if(100===e.avcProfileIndication||110===e.avcProfileIndication||122===e.avcProfileIndication||144===e.avcProfileIndication)for(let r of((0,o.vA)(null!==e.chromaFormat),(0,o.vA)(null!==e.bitDepthLumaMinus8),(0,o.vA)(null!==e.bitDepthChromaMinus8),(0,o.vA)(null!==e.sequenceParameterSetExt),t.push(252|3&e.chromaFormat),t.push(248|7&e.bitDepthLumaMinus8),t.push(248|7&e.bitDepthChromaMinus8),t.push(e.sequenceParameterSetExt.length),e.sequenceParameterSetExt)){let e=r.byteLength;t.push(e>>8),t.push(255&e);for(let i=0;i<e;i++)t.push(r[i])}return new Uint8Array(t)},w=e=>{try{let t=(0,o.Zc)(e),r=0,i=t.getUint8(r++),a=t.getUint8(r++),n=t.getUint8(r++),s=t.getUint8(r++),l=3&t.getUint8(r++),c=31&t.getUint8(r++),d=[];for(let i=0;i<c;i++){let i=t.getUint16(r,!1);r+=2,d.push(e.subarray(r,r+i)),r+=i}let u=t.getUint8(r++),h=[];for(let i=0;i<u;i++){let i=t.getUint16(r,!1);r+=2,h.push(e.subarray(r,r+i)),r+=i}let f={configurationVersion:i,avcProfileIndication:a,profileCompatibility:n,avcLevelIndication:s,lengthSizeMinusOne:l,sequenceParameterSets:d,pictureParameterSets:h,chromaFormat:null,bitDepthLumaMinus8:null,bitDepthChromaMinus8:null,sequenceParameterSetExt:null};if((100===a||110===a||122===a||144===a)&&r+4<=e.length){let i=3&t.getUint8(r++),a=7&t.getUint8(r++),n=7&t.getUint8(r++),s=t.getUint8(r++);f.chromaFormat=i,f.bitDepthLumaMinus8=a,f.bitDepthChromaMinus8=n;let o=[];for(let i=0;i<s;i++){let i=t.getUint16(r,!1);r+=2,o.push(e.subarray(r,r+i)),r+=i}f.sequenceParameterSetExt=o}return f}catch(e){return console.error("Error deserializing AVC Decoder Configuration Record:",e),null}},v=e=>{try{let t=new o._c(f(e));t.skipBits(1),t.skipBits(2);let r=t.readBits(5);if(7!==r)return null;let i=t.readAlignedByte(),a=t.readAlignedByte(),n=t.readAlignedByte();(0,o.IP)(t);let l=1,c=0,d=0,u=0;if((100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i)&&(l=(0,o.IP)(t),3===l&&(u=t.readBits(1)),c=(0,o.IP)(t),d=(0,o.IP)(t),t.skipBits(1),t.readBits(1))){for(let e=0;e<(3!==l?8:12);e++)if(t.readBits(1)){let r=e<6?16:64,i=8,a=8;for(let e=0;e<r;e++){if(0!==a){let e=(0,o.OO)(t);a=(i+e+256)%256}i=0===a?i:a}}}(0,o.IP)(t);let h=(0,o.IP)(t);if(0===h)(0,o.IP)(t);else if(1===h){t.skipBits(1),(0,o.OO)(t),(0,o.OO)(t);let e=(0,o.IP)(t);for(let r=0;r<e;r++)(0,o.OO)(t)}(0,o.IP)(t),t.skipBits(1);let m=(0,o.IP)(t),p=(0,o.IP)(t),g=16*(m+1),y=16*(p+1),b=g,k=y,w=t.readBits(1);if(w||t.skipBits(1),t.skipBits(1),t.readBits(1)){let e,r;let i=(0,o.IP)(t),a=(0,o.IP)(t),n=(0,o.IP)(t),s=(0,o.IP)(t),c=0===u?l:0;if(0===c)e=1,r=2-w;else{let t=3===l?1:2,i=1===l?2:1;e=t,r=i*(2-w)}b-=e*(i+a),k-=r*(n+s)}let v=2,T=2,S=2,C=0,P=null,I=null;if(t.readBits(1)){if(t.readBits(1)){let e=t.readBits(8);255===e&&(t.skipBits(16),t.skipBits(16))}t.readBits(1)&&t.skipBits(1),t.readBits(1)&&(t.skipBits(3),C=t.readBits(1),t.readBits(1)&&(v=t.readBits(8),T=t.readBits(8),S=t.readBits(8))),t.readBits(1)&&((0,o.IP)(t),(0,o.IP)(t)),t.readBits(1)&&(t.skipBits(32),t.skipBits(32),t.skipBits(1));let e=t.readBits(1);e&&x(t);let r=t.readBits(1);r&&x(t),(e||r)&&t.skipBits(1),t.skipBits(1),t.readBits(1)&&(t.skipBits(1),(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),P=(0,o.IP)(t),I=(0,o.IP)(t))}if(null===P){if((0,o.vA)(null===I),(44===i||86===i||100===i||110===i||122===i||244===i)&&16&a)P=0,I=0;else{let e=s.$3.find(e=>e.level>=n)??(0,o._g)(s.$3),t=Math.min(Math.floor(e.maxDpbMbs/((2-w)*(p+1)*(m+1))),16);P=t,I=t}}return(0,o.vA)(null!==I),{profileIdc:i,constraintFlags:a,levelIdc:n,frameMbsOnlyFlag:w,chromaFormatIdc:l,bitDepthLumaMinus8:c,bitDepthChromaMinus8:d,codedWidth:g,codedHeight:y,displayWidth:b,displayHeight:k,colourPrimaries:v,matrixCoefficients:S,transferCharacteristics:T,fullRangeFlag:C,numReorderFrames:P,maxDecFrameBuffering:I}}catch(e){return console.error("Error parsing AVC SPS:",e),null}},x=e=>{let t=(0,o.IP)(e);e.skipBits(4),e.skipBits(4);for(let r=0;r<=t;r++)(0,o.IP)(e),(0,o.IP)(e),e.skipBits(1);e.skipBits(5),e.skipBits(5),e.skipBits(5),e.skipBits(5)},T=(e,t)=>t.description?c(e,(3&(0,o.Fo)(t.description)[21])+1):l(e),S=function*(e){yield*l(e)},C=e=>e>>1&63,P=e=>{try{let t=new o._c(f(e));t.skipBits(16),t.readBits(4);let r=t.readBits(3),i=t.readBits(1),{general_profile_space:a,general_tier_flag:n,general_profile_idc:s,general_profile_compatibility_flags:l,general_constraint_indicator_flags:c,general_level_idc:d}=E(t,r);(0,o.IP)(t);let u=(0,o.IP)(t),h=0;3===u&&(h=t.readBits(1));let m=(0,o.IP)(t),p=(0,o.IP)(t),g=m,y=p;if(t.readBits(1)){let e=(0,o.IP)(t),r=(0,o.IP)(t),i=(0,o.IP)(t),a=(0,o.IP)(t),n=1,s=1,l=0===h?u:0;1===l?(n=2,s=2):2===l&&(n=2,s=1),g-=(e+r)*n,y-=(i+a)*s}let b=(0,o.IP)(t),k=(0,o.IP)(t);(0,o.IP)(t);let w=t.readBits(1)?0:r,v=0;for(let e=w;e<=r;e++)(0,o.IP)(t),v=(0,o.IP)(t),(0,o.IP)(t);(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),(0,o.IP)(t),t.readBits(1)&&t.readBits(1)&&A(t),t.skipBits(1),t.skipBits(1),t.readBits(1)&&(t.skipBits(4),t.skipBits(4),(0,o.IP)(t),(0,o.IP)(t),t.skipBits(1));let x=(0,o.IP)(t);if(M(t,x),t.readBits(1)){let e=(0,o.IP)(t);for(let r=0;r<e;r++)(0,o.IP)(t),t.skipBits(1)}t.skipBits(1),t.skipBits(1);let T=2,S=2,C=2,P=0,I=0;if(t.readBits(1)){let e=B(t,r);T=e.colourPrimaries,S=e.transferCharacteristics,C=e.matrixCoefficients,P=e.fullRangeFlag,I=e.minSpatialSegmentationIdc}return{displayWidth:g,displayHeight:y,colourPrimaries:T,transferCharacteristics:S,matrixCoefficients:C,fullRangeFlag:P,maxDecFrameBuffering:v+1,spsMaxSubLayersMinus1:r,spsTemporalIdNestingFlag:i,generalProfileSpace:a,generalTierFlag:n,generalProfileIdc:s,generalProfileCompatibilityFlags:l,generalConstraintIndicatorFlags:c,generalLevelIdc:d,chromaFormatIdc:u,bitDepthLumaMinus8:b,bitDepthChromaMinus8:k,minSpatialSegmentationIdc:I}}catch(e){return console.error("Error parsing HEVC SPS:",e),null}},I=e=>{try{let t=[],r=[],i=[],n=[];for(let s of S(e)){let o=e.subarray(s.offset,s.offset+s.length),l=C(o[0]);l===a.VPS_NUT?t.push(o):l===a.SPS_NUT?r.push(o):l===a.PPS_NUT?i.push(o):(l===a.PREFIX_SEI_NUT||l===a.SUFFIX_SEI_NUT)&&n.push(o)}if(0===r.length||0===i.length)return null;let s=P(r[0]);if(!s)return null;let l=0;if(i.length>0){let e=i[0],t=new o._c(f(e));t.skipBits(16),(0,o.IP)(t),(0,o.IP)(t),t.skipBits(1),t.skipBits(1),t.skipBits(3),t.skipBits(1),t.skipBits(1),(0,o.IP)(t),(0,o.IP)(t),(0,o.OO)(t),t.skipBits(1),t.skipBits(1),t.readBits(1)&&(0,o.IP)(t),(0,o.OO)(t),(0,o.OO)(t),t.skipBits(1),t.skipBits(1),t.skipBits(1),t.skipBits(1);let r=t.readBits(1),a=t.readBits(1);l=r||a?r&&!a?2:!r&&a?3:0:0}let c=[...t.length?[{arrayCompleteness:1,nalUnitType:a.VPS_NUT,nalUnits:t}]:[],...r.length?[{arrayCompleteness:1,nalUnitType:a.SPS_NUT,nalUnits:r}]:[],...i.length?[{arrayCompleteness:1,nalUnitType:a.PPS_NUT,nalUnits:i}]:[],...n.length?[{arrayCompleteness:1,nalUnitType:C(n[0][0]),nalUnits:n}]:[]];return{configurationVersion:1,generalProfileSpace:s.generalProfileSpace,generalTierFlag:s.generalTierFlag,generalProfileIdc:s.generalProfileIdc,generalProfileCompatibilityFlags:s.generalProfileCompatibilityFlags,generalConstraintIndicatorFlags:s.generalConstraintIndicatorFlags,generalLevelIdc:s.generalLevelIdc,minSpatialSegmentationIdc:s.minSpatialSegmentationIdc,parallelismType:l,chromaFormatIdc:s.chromaFormatIdc,bitDepthLumaMinus8:s.bitDepthLumaMinus8,bitDepthChromaMinus8:s.bitDepthChromaMinus8,avgFrameRate:0,constantFrameRate:0,numTemporalLayers:s.spsMaxSubLayersMinus1+1,temporalIdNested:s.spsTemporalIdNestingFlag,lengthSizeMinusOne:3,arrays:c}}catch(e){return console.error("Error building HEVC Decoder Configuration Record:",e),null}},E=(e,t)=>{let r=e.readBits(2),i=e.readBits(1),a=e.readBits(5),n=0;for(let t=0;t<32;t++)n=n<<1|e.readBits(1);let s=new Uint8Array(6);for(let t=0;t<6;t++)s[t]=e.readBits(8);let o=e.readBits(8),l=[],c=[];for(let r=0;r<t;r++)l.push(e.readBits(1)),c.push(e.readBits(1));if(t>0)for(let r=t;r<8;r++)e.skipBits(2);for(let r=0;r<t;r++)l[r]&&e.skipBits(88),c[r]&&e.skipBits(8);return{general_profile_space:r,general_tier_flag:i,general_profile_idc:a,general_profile_compatibility_flags:n,general_constraint_indicator_flags:s,general_level_idc:o}},A=e=>{for(let t=0;t<4;t++)for(let r=0;r<(3===t?2:6);r++)if(e.readBits(1)){let r=Math.min(64,1<<4+(t<<1));t>1&&(0,o.OO)(e);for(let t=0;t<r;t++)(0,o.OO)(e)}else(0,o.IP)(e)},M=(e,t)=>{let r=[];for(let i=0;i<t;i++)r[i]=F(e,i,t,r)},F=(e,t,r,i)=>{let a=0,n=0,s=0;if(0!==t&&(n=e.readBits(1)),n){s=t===r?t-((0,o.IP)(e)+1):t-1,e.readBits(1),(0,o.IP)(e);let n=i[s]??0;for(let t=0;t<=n;t++)e.readBits(1)||e.readBits(1);a=i[s]}else{let t=(0,o.IP)(e),r=(0,o.IP)(e);for(let r=0;r<t;r++)(0,o.IP)(e),e.readBits(1);for(let t=0;t<r;t++)(0,o.IP)(e),e.readBits(1);a=t+r}return a},B=(e,t)=>{let r=2,i=2,a=2,n=0,s=0;return e.readBits(1)&&255===e.readBits(8)&&(e.readBits(16),e.readBits(16)),e.readBits(1)&&e.readBits(1),e.readBits(1)&&(e.readBits(3),n=e.readBits(1),e.readBits(1)&&(r=e.readBits(8),i=e.readBits(8),a=e.readBits(8))),e.readBits(1)&&((0,o.IP)(e),(0,o.IP)(e)),e.readBits(1),e.readBits(1),e.readBits(1),e.readBits(1)&&((0,o.IP)(e),(0,o.IP)(e),(0,o.IP)(e),(0,o.IP)(e)),e.readBits(1)&&(e.readBits(32),e.readBits(32),e.readBits(1)&&(0,o.IP)(e),e.readBits(1)&&L(e,!0,t)),e.readBits(1)&&(e.readBits(1),e.readBits(1),e.readBits(1),s=(0,o.IP)(e),(0,o.IP)(e),(0,o.IP)(e),(0,o.IP)(e),(0,o.IP)(e)),{colourPrimaries:r,transferCharacteristics:i,matrixCoefficients:a,fullRangeFlag:n,minSpatialSegmentationIdc:s}},L=(e,t,r)=>{let i=!1,a=!1,n=!1;t&&(i=1===e.readBits(1),a=1===e.readBits(1),(i||a)&&((n=1===e.readBits(1))&&(e.readBits(8),e.readBits(5),e.readBits(1),e.readBits(5)),e.readBits(4),e.readBits(4),n&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5)));for(let t=0;t<=r;t++){let t=1===e.readBits(1),r=!0;t||(r=1===e.readBits(1));let s=!1;r?(0,o.IP)(e):s=1===e.readBits(1);let l=1;s||(l=(0,o.IP)(e)+1),i&&U(e,l,n),a&&U(e,l,n)}},U=(e,t,r)=>{for(let i=0;i<t;i++)(0,o.IP)(e),(0,o.IP)(e),r&&((0,o.IP)(e),(0,o.IP)(e)),e.readBits(1)},R=e=>{let t=[];for(let r of(t.push(e.configurationVersion),t.push((3&e.generalProfileSpace)<<6|(1&e.generalTierFlag)<<5|31&e.generalProfileIdc),t.push(e.generalProfileCompatibilityFlags>>>24&255),t.push(e.generalProfileCompatibilityFlags>>>16&255),t.push(e.generalProfileCompatibilityFlags>>>8&255),t.push(255&e.generalProfileCompatibilityFlags),t.push(...e.generalConstraintIndicatorFlags),t.push(255&e.generalLevelIdc),t.push(240|e.minSpatialSegmentationIdc>>8&15),t.push(255&e.minSpatialSegmentationIdc),t.push(252|3&e.parallelismType),t.push(252|3&e.chromaFormatIdc),t.push(248|7&e.bitDepthLumaMinus8),t.push(248|7&e.bitDepthChromaMinus8),t.push(e.avgFrameRate>>8&255),t.push(255&e.avgFrameRate),t.push((3&e.constantFrameRate)<<6|(7&e.numTemporalLayers)<<3|(1&e.temporalIdNested)<<2|3&e.lengthSizeMinusOne),t.push(255&e.arrays.length),e.arrays))for(let e of(t.push((1&r.arrayCompleteness)<<7|0|63&r.nalUnitType),t.push(r.nalUnits.length>>8&255),t.push(255&r.nalUnits.length),r.nalUnits)){t.push(e.length>>8&255),t.push(255&e.length);for(let r=0;r<e.length;r++)t.push(e[r])}return new Uint8Array(t)},D=e=>{try{let t=(0,o.Zc)(e),r=0,i=t.getUint8(r++),a=t.getUint8(r++),n=t.getUint32(r,!1);r+=4;let s=e.subarray(r,r+6);r+=6;let l=t.getUint8(r++),c=(15&t.getUint8(r++))<<8|t.getUint8(r++),d=3&t.getUint8(r++),u=3&t.getUint8(r++),h=7&t.getUint8(r++),f=7&t.getUint8(r++),m=t.getUint16(r,!1);r+=2;let p=t.getUint8(r++),g=t.getUint8(r++),y=[];for(let i=0;i<g;i++){let i=t.getUint8(r++),a=i>>7&1,n=63&i,s=t.getUint16(r,!1);r+=2;let o=[];for(let i=0;i<s;i++){let i=t.getUint16(r,!1);r+=2,o.push(e.subarray(r,r+i)),r+=i}y.push({arrayCompleteness:a,nalUnitType:n,nalUnits:o})}return{configurationVersion:i,generalProfileSpace:a>>6&3,generalTierFlag:a>>5&1,generalProfileIdc:31&a,generalProfileCompatibilityFlags:n,generalConstraintIndicatorFlags:s,generalLevelIdc:l,minSpatialSegmentationIdc:c,parallelismType:d,chromaFormatIdc:u,bitDepthLumaMinus8:h,bitDepthChromaMinus8:f,avgFrameRate:m,constantFrameRate:p>>6&3,numTemporalLayers:p>>3&7,temporalIdNested:p>>2&1,lengthSizeMinusOne:3&p,arrays:y}}catch(e){return console.error("Error deserializing HEVC Decoder Configuration Record:",e),null}},N=e=>{let t=new o._c(e);if(2!==t.readBits(2))return null;let r=t.readBits(1),i=(t.readBits(1)<<1)+r;if(3===i&&t.skipBits(1),1===t.readBits(1)||0!==t.readBits(1)||(t.skipBits(2),4817730!==t.readBits(24)))return null;let a=8;i>=2&&(a=t.readBits(1)?12:10);let n=t.readBits(3),l=0,c=0;if(7!==n){if(c=t.readBits(1),1===i||3===i){let e=t.readBits(1),r=t.readBits(1);l=e||r?e&&!r?2:1:3,t.skipBits(1)}else l=1}else l=3,c=1;let d=t.readBits(16),u=(d+1)*(t.readBits(16)+1),h=(0,o._g)(s.ye).level;for(let e of s.ye)if(u<=e.maxPictureSize){h=e.level;break}return{profile:i,level:h,bitDepth:a,chromaSubsampling:l,videoFullRangeFlag:c,colourPrimaries:2===n?1:1===n?6:2,transferCharacteristics:2===n?1:1===n?6:2,matrixCoefficients:7===n?0:2===n?1:1===n?6:2}},_=function*(e){let t=new o._c(e),r=()=>{let e=0;for(let r=0;r<8;r++){let i=t.readAlignedByte();if(e|=(127&i)<<7*r,!(128&i))break;if(7===r&&128&i)return null}return e>=0x100000000-1?null:e};for(;t.getBitsLeft()>=8;){let i;t.skipBits(1);let a=t.readBits(4),n=t.readBits(1),s=t.readBits(1);if(t.skipBits(1),n&&t.skipBits(8),s){let e=r();if(null===e)return;i=e}else i=Math.floor(t.getBitsLeft()/8);(0,o.vA)(t.pos%8==0),yield{type:a,data:e.subarray(t.pos/8,t.pos/8+i)},t.skipBits(8*i)}},z=e=>{for(let{type:t,data:r}of _(e)){if(1!==t)continue;let e=new o._c(r),i=e.readBits(3);e.readBits(1);let a=e.readBits(1),n=0,s=0,l=0;if(a)n=e.readBits(5);else{if(e.readBits(1)&&(e.skipBits(32),e.skipBits(32),e.readBits(1)))return null;let t=e.readBits(1);t&&(l=e.readBits(5),e.skipBits(32),e.skipBits(5),e.skipBits(5));let r=e.readBits(5);for(let i=0;i<=r;i++){e.skipBits(12);let r=e.readBits(5);if(0===i&&(n=r),r>7){let t=e.readBits(1);0===i&&(s=t)}if(t&&e.readBits(1)){let t=l+1;e.skipBits(t),e.skipBits(t),e.skipBits(1)}e.readBits(1)&&e.skipBits(4)}}let c=e.readBits(4),d=e.readBits(4),u=c+1;e.skipBits(u);let h=d+1;e.skipBits(h);let f=0;if((a?0:e.readBits(1))&&(e.skipBits(4),e.skipBits(3)),e.skipBits(1),e.skipBits(1),e.skipBits(1),!a){e.skipBits(1),e.skipBits(1),e.skipBits(1),e.skipBits(1);let t=e.readBits(1);t&&(e.skipBits(1),e.skipBits(1));let r=e.readBits(1),i=0;(r?2:e.readBits(1))>0&&!e.readBits(1)&&e.skipBits(1),t&&e.skipBits(3)}e.skipBits(1),e.skipBits(1),e.skipBits(1);let m=e.readBits(1),p=8;2===i&&m?p=e.readBits(1)?12:10:i<=2&&(p=m?10:8);let g=0;1!==i&&(g=e.readBits(1));let y=1,b=1,k=0;return!g&&(0===i?(y=1,b=1):1===i?(y=0,b=0):12===p&&(y=e.readBits(1))&&(b=e.readBits(1)),y&&b&&(k=e.readBits(2))),{profile:i,level:n,tier:s,bitDepth:p,monochrome:g,chromaSubsamplingX:y,chromaSubsamplingY:b,chromaSamplePosition:k}}return null},O=e=>{let t=(0,o.Zc)(e),r=t.getUint8(9),i=t.getUint16(10,!0),a=t.getUint32(12,!0),n=t.getInt16(16,!0),s=t.getUint8(18),l=null;return s&&(l=e.subarray(19,21+r)),{outputChannelCount:r,preSkip:i,inputSampleRate:a,outputGain:n,channelMappingFamily:s,channelMappingTable:l}},V=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960],$=e=>({durationInSamples:V[e[0]>>3]}),j=e=>{if(e.length<7)throw Error("Setup header is too short.");if(5!==e[0])throw Error("Wrong packet type in Setup header.");if("vorbis"!==String.fromCharCode(...e.slice(1,7)))throw Error("Invalid packet signature in Setup header.");let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e[t-1-i];let i=new o._c(r),a=0;for(;i.getBitsLeft()>97;)if(1===i.readBits(1)){a=i.pos;break}if(0===a)throw Error("Invalid Setup header: framing bit not found.");let n=0,s=!1,l=0;for(;i.getBitsLeft()>=97;){let e=i.pos,t=i.readBits(8),r=i.readBits(16),a=i.readBits(16);if(t>63||0!==r||0!==a){i.pos=e;break}if(i.skipBits(1),++n>64)break;i.clone().readBits(6)+1===n&&(s=!0,l=n)}if(!s)throw Error("Invalid Setup header: mode header not found.");if(l>63)throw Error(`Unsupported mode count: ${l}.`);let c=l;i.pos=0,i.skipBits(a);let d=Array(c).fill(0);for(let e=c-1;e>=0;e--)i.skipBits(40),d[e]=i.readBits(1);return{modeBlockflags:d}},H=(e,t,r)=>{switch(e){case"avc":for(let e of d(r,t)){let t=h(r[e.offset]);if(t>=i.NON_IDR_SLICE&&t<=i.SLICE_DPC)break;if(t===i.IDR)return"key";if(t===i.SEI&&(!(0,o.F2)()||(0,o.zp)()>=144)){let t=f(r.subarray(e.offset,e.offset+e.length)),i=1;do{let e=0;for(;;){let r=t[i++];if(void 0===r||(e+=r,r<255))break}let r=0;for(;;){let e=t[i++];if(void 0===e||(r+=e,e<255))break}if(6===e){let e=new o._c(t);e.pos=8*i;let r=(0,o.IP)(e),a=e.readBits(1);if(0===r&&1===a)return"key"}i+=r}while(i<t.length-1)}}return"delta";case"hevc":for(let e of T(r,t)){let t=C(r[e.offset]);if(t<a.BLA_W_LP)break;if(t<=a.RSV_IRAP_VCL23)return"key"}return"delta";case"vp8":return 0==(1&r[0])?"key":"delta";case"vp9":{let e=new o._c(r);if(2!==e.readBits(2))return null;let t=e.readBits(1);if(3===(e.readBits(1)<<1)+t&&e.skipBits(1),e.readBits(1))return null;return 0===e.readBits(1)?"key":"delta"}case"av1":{let e=!1;for(let{type:t,data:i}of _(r))if(1===t){let t=new o._c(i);t.skipBits(4),e=!!t.readBits(1)}else if(3===t||6===t||7===t){if(e)return"key";let t=new o._c(i);if(t.readBits(1))return null;return 0===t.readBits(2)?"key":"delta"}return null}default:(0,o.xb)(e),(0,o.vA)(!1)}};!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.PICTURE=6]="PICTURE"}(n||(n={}));let q=(e,t)=>{let r=(0,o.Zc)(e),i=0,a=r.getUint32(i,!0);i+=4;let n=o.su.decode(e.subarray(i,i+a));i+=a,a>0&&(t.raw??={},t.raw.vendor??=n);let s=r.getUint32(i,!0);i+=4;for(let a=0;a<s;a++){let a=r.getUint32(i,!0);i+=4;let n=o.su.decode(e.subarray(i,i+a));i+=a;let s=n.indexOf("=");if(-1===s)continue;let l=n.slice(0,s).toUpperCase(),c=n.slice(s+1);switch(t.raw??={},t.raw[l]??=c,l){case"TITLE":t.title??=c;break;case"DESCRIPTION":t.description??=c;break;case"ARTIST":t.artist??=c;break;case"ALBUM":t.album??=c;break;case"ALBUMARTIST":t.albumArtist??=c;break;case"COMMENT":t.comment??=c;break;case"LYRICS":t.lyrics??=c;break;case"TRACKNUMBER":{let e=c.split("/"),r=Number.parseInt(e[0],10),i=e[1]&&Number.parseInt(e[1],10);Number.isInteger(r)&&r>0&&(t.trackNumber??=r),i&&Number.isInteger(i)&&i>0&&(t.tracksTotal??=i)}break;case"TRACKTOTAL":{let e=Number.parseInt(c,10);Number.isInteger(e)&&e>0&&(t.tracksTotal??=e)}break;case"DISCNUMBER":{let e=c.split("/"),r=Number.parseInt(e[0],10),i=e[1]&&Number.parseInt(e[1],10);Number.isInteger(r)&&r>0&&(t.discNumber??=r),i&&Number.isInteger(i)&&i>0&&(t.discsTotal??=i)}break;case"DISCTOTAL":{let e=Number.parseInt(c,10);Number.isInteger(e)&&e>0&&(t.discsTotal??=e)}break;case"DATE":{let e=new Date(c);Number.isNaN(e.getTime())||(t.date??=e)}break;case"GENRE":t.genre??=c;break;case"METADATA_BLOCK_PICTURE":{let e=(0,o.Kp)(c),r=(0,o.Zc)(e),i=r.getUint32(0,!1),a=r.getUint32(4,!1),n=String.fromCharCode(...e.subarray(8,8+a)),s=r.getUint32(8+a,!1),l=o.su.decode(e.subarray(12+a,12+a+s)),d=r.getUint32(a+s+28),u=e.subarray(a+s+32,a+s+32+d);t.images??=[],t.images.push({data:u,mimeType:n,kind:3===i?"coverFront":4===i?"coverBack":"unknown",name:void 0,description:l||void 0})}}}},K=(e,t,r)=>{let i=[e],a=o.UG.encode("Mediabunny"),n=new Uint8Array(4+a.length),s=new DataView(n.buffer);s.setUint32(0,a.length,!0),n.set(a,4),i.push(n);let l=new Set,c=(e,t)=>{let r=`${e}=${t}`,a=o.UG.encode(r);(s=new DataView((n=new Uint8Array(4+a.length)).buffer)).setUint32(0,a.length,!0),n.set(a,4),i.push(n),l.add(e)};for(let{key:e,value:i}of(0,o.rk)(t))switch(e){case"title":c("TITLE",i);break;case"description":c("DESCRIPTION",i);break;case"artist":c("ARTIST",i);break;case"album":c("ALBUM",i);break;case"albumArtist":c("ALBUMARTIST",i);break;case"genre":c("GENRE",i);break;case"date":{let e=t.raw?.DATE??t.raw?.date;c("DATE",e&&"string"==typeof e?e:i.toISOString().slice(0,10))}break;case"comment":c("COMMENT",i);break;case"lyrics":c("LYRICS",i);break;case"trackNumber":c("TRACKNUMBER",i.toString());break;case"tracksTotal":c("TRACKTOTAL",i.toString());break;case"discNumber":c("DISCNUMBER",i.toString());break;case"discsTotal":c("DISCTOTAL",i.toString());break;case"images":if(!r)break;for(let e of i){let t="coverFront"===e.kind?3:4*("coverBack"===e.kind),r=new Uint8Array(e.mimeType.length);for(let t=0;t<e.mimeType.length;t++)r[t]=e.mimeType.charCodeAt(t);let i=o.UG.encode(e.description??""),a=new Uint8Array(8+r.length+4+i.length+16+4+e.data.length),n=(0,o.Zc)(a);n.setUint32(0,t,!1),n.setUint32(4,r.length,!1),a.set(r,8),n.setUint32(8+r.length,i.length,!1),a.set(i,12+r.length),n.setUint32(28+r.length+i.length,e.data.length,!1),a.set(e.data,32+r.length+i.length),c("METADATA_BLOCK_PICTURE",(0,o.if)(a))}break;case"raw":break;default:(0,o.xb)(e)}if(t.raw)for(let e in t.raw){let r=t.raw[e]??t.raw[e.toLowerCase()];!("vendor"===e||null==r||l.has(e))&&"string"==typeof r&&c(e,r)}let d=new Uint8Array(4);(0,o.Zc)(d).setUint32(0,l.size,!0),i.splice(2,0,d);let u=new Uint8Array(i.reduce((e,t)=>e+t.length,0)),h=0;for(let e of i)u.set(e,h),h+=e.length;return u}},5854:(e,t,r)=>{r.d(t,{T:()=>a,Z:()=>n});var i=r(8734);let a=new Uint8Array(0);class n{constructor(e,t,r,i,n=-1,s,o){if(this.data=e,this.type=t,this.timestamp=r,this.duration=i,this.sequenceNumber=n,e===a&&void 0===s)throw Error("Internal error: byteLength must be explicitly provided when constructing metadata-only packets.");if(void 0===s&&(s=e.byteLength),!(e instanceof Uint8Array))throw TypeError("data must be a Uint8Array.");if("key"!==t&&"delta"!==t)throw TypeError('type must be either "key" or "delta".');if(!Number.isFinite(r))throw TypeError("timestamp must be a number.");if(!Number.isFinite(i)||i<0)throw TypeError("duration must be a non-negative number.");if(!Number.isFinite(n))throw TypeError("sequenceNumber must be a number.");if(!Number.isInteger(s)||s<0)throw TypeError("byteLength must be a non-negative integer.");if(void 0!==o&&("object"!=typeof o||!o))throw TypeError("sideData, when provided, must be an object.");if(o?.alpha!==void 0&&!(o.alpha instanceof Uint8Array))throw TypeError("sideData.alpha, when provided, must be a Uint8Array.");if(o?.alphaByteLength!==void 0&&(!Number.isInteger(o.alphaByteLength)||o.alphaByteLength<0))throw TypeError("sideData.alphaByteLength, when provided, must be a non-negative integer.");this.byteLength=s,this.sideData=o??{},this.sideData.alpha&&void 0===this.sideData.alphaByteLength&&(this.sideData.alphaByteLength=this.sideData.alpha.byteLength)}get isMetadataOnly(){return this.data===a}get microsecondTimestamp(){return Math.trunc(i.MW*this.timestamp)}get microsecondDuration(){return Math.trunc(i.MW*this.duration)}toEncodedVideoChunk(){if(this.isMetadataOnly)throw TypeError("Metadata-only packets cannot be converted to a video chunk.");if("undefined"==typeof EncodedVideoChunk)throw Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}alphaToEncodedVideoChunk(e=this.type){if(!this.sideData.alpha)throw TypeError("This packet does not contain alpha side data.");if(this.isMetadataOnly)throw TypeError("Metadata-only packets cannot be converted to a video chunk.");if("undefined"==typeof EncodedVideoChunk)throw Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.sideData.alpha,type:e,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}toEncodedAudioChunk(){if(this.isMetadataOnly)throw TypeError("Metadata-only packets cannot be converted to an audio chunk.");if("undefined"==typeof EncodedAudioChunk)throw Error("Your browser does not support EncodedAudioChunk.");return new EncodedAudioChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}static fromEncodedChunk(e,t){if(!(e instanceof EncodedVideoChunk||e instanceof EncodedAudioChunk))throw TypeError("chunk must be an EncodedVideoChunk or EncodedAudioChunk.");let r=new Uint8Array(e.byteLength);return e.copyTo(r),new n(r,e.type,e.timestamp/1e6,(e.duration??0)/1e6,void 0,void 0,t)}clone(e){if(void 0!==e&&("object"!=typeof e||null===e))throw TypeError("options, when provided, must be an object.");if(e?.data!==void 0&&!(e.data instanceof Uint8Array))throw TypeError("options.data, when provided, must be a Uint8Array.");if(e?.type!==void 0&&"key"!==e.type&&"delta"!==e.type)throw TypeError('options.type, when provided, must be either "key" or "delta".');if(e?.timestamp!==void 0&&!Number.isFinite(e.timestamp))throw TypeError("options.timestamp, when provided, must be a number.");if(e?.duration!==void 0&&!Number.isFinite(e.duration))throw TypeError("options.duration, when provided, must be a number.");if(e?.sequenceNumber!==void 0&&!Number.isFinite(e.sequenceNumber))throw TypeError("options.sequenceNumber, when provided, must be a number.");if(e?.sideData!==void 0&&("object"!=typeof e.sideData||null===e.sideData))throw TypeError("options.sideData, when provided, must be an object.");return new n(e?.data??this.data,e?.type??this.type,e?.timestamp??this.timestamp,e?.duration??this.duration,e?.sequenceNumber??this.sequenceNumber,this.byteLength,e?.sideData??this.sideData)}}},6194:(e,t,r)=>{r.d(t,{Q:()=>l,p:()=>o});var i=r(4947),a=r(8734),n=r(8113),s=r(5247);(0,a.XQ)();class o{get disposed(){return this._disposed}constructor(e){if(this._demuxerPromise=null,this._format=null,this._disposed=!1,!e||"object"!=typeof e)throw TypeError("options must be an object.");if(!Array.isArray(e.formats)||e.formats.some(e=>!(e instanceof i.CW)))throw TypeError("options.formats must be an array of InputFormat.");if(!(e.source instanceof s.kL))throw TypeError("options.source must be a Source.");if(e.source._disposed)throw Error("options.source must not be disposed.");this._formats=e.formats,this._source=e.source,this._reader=new n.mP(e.source)}_getDemuxer(){return this._demuxerPromise??=(async()=>{for(let e of(this._reader.fileSize=await this._source.getSizeOrNull(),this._formats))if(await e._canReadInput(this))return this._format=e,e._createDemuxer(this);throw Error("Input has an unsupported or unrecognizable format.")})()}get source(){return this._source}async getFormat(){return await this._getDemuxer(),(0,a.vA)(this._format),this._format}async computeDuration(){return(await this._getDemuxer()).computeDuration()}async getFirstTimestamp(){let e=await this.getTracks();return 0===e.length?0:Math.min(...await Promise.all(e.map(e=>e.getFirstTimestamp())))}async getTracks(){return(await this._getDemuxer()).getTracks()}async getVideoTracks(){return(await this.getTracks()).filter(e=>e.isVideoTrack())}async getAudioTracks(){return(await this.getTracks()).filter(e=>e.isAudioTrack())}async getPrimaryVideoTrack(){return(await this.getTracks()).find(e=>e.isVideoTrack())??null}async getPrimaryAudioTrack(){return(await this.getTracks()).find(e=>e.isAudioTrack())??null}async getMimeType(){return(await this._getDemuxer()).getMimeType()}async getMetadataTags(){return(await this._getDemuxer()).getMetadataTags()}dispose(){!this._disposed&&(this._disposed=!0,this._source._disposed=!0,this._source._dispose())}[Symbol.dispose](){this.dispose()}}class l extends Error{constructor(e="Input has been disposed."){super(e),this.name="InputDisposedError"}}},7354:(e,t,r)=>{r.d(t,{B:()=>i});class i{constructor(e){this.input=e}}},7408:(e,t,r)=>{r.d(t,{Ob:()=>c,Zk:()=>n,_S:()=>o,nL:()=>l});var i=r(5799),a=r(8734);let n=0x5367674f,s=new Uint32Array(256);for(let e=0;e<256;e++){let t=e<<24;for(let e=0;e<8;e++)t=0x80000000&t?t<<1^0x4c11db7:t<<1;s[e]=t>>>0&0xffffffff}let o=e=>{let t=(0,a.Zc)(e),r=t.getUint32(22,!0);t.setUint32(22,0,!0);let i=0;for(let t=0;t<e.length;t++)i=(i<<8^s[i>>>24^e[t]])>>>0;return t.setUint32(22,r,!0),i},l=(e,t,r)=>{let n=0,s=null;if(e.length>0){if("vorbis"===t.codec){(0,a.vA)(t.vorbisInfo);let i=t.vorbisInfo.modeBlockflags.length,o=(1<<(0,a.al)(i-1))-1<<1,l=(e[0]&o)>>1;if(l>=t.vorbisInfo.modeBlockflags.length)throw Error("Invalid mode number.");let c=r,d=t.vorbisInfo.modeBlockflags[l];if(s=t.vorbisInfo.blocksizes[d],1===d){let r=e[0]&(1|o)+1?1:0;c=t.vorbisInfo.blocksizes[r]}n=null!==c?c+s>>2:0}else"opus"===t.codec&&(n=(0,i.ls)(e).durationInSamples)}return{durationInSamples:n,vorbisBlockSize:s}},c=e=>{let t="audio/ogg";if(e.codecStrings){let r=[...new Set(e.codecStrings)];t+=`; codecs="${r.join(", ")}"`}return t}},7914:(e,t,r)=>{r.d(t,{aw:()=>s,qS:()=>a,vX:()=>i,xq:()=>n});let i=e=>{let t=e,r=4096,i=0,a=12,n=0;for(t<0&&(t=-t,i=128),(t+=33)>8191&&(t=8191);(t&r)!==r&&a>=5;)r>>=1,a--;return n=t>>a-4&15,255&~(i|a-5<<4|n)},a=e=>{let t=0,r=0,i=~e;128&i&&(i&=-129,t=-1);let a=(1<<(r=((240&i)>>4)+5)|(15&i)<<r-4|1<<r-5)-33;return 0===t?a:-a},n=e=>{let t=2048,r=0,i=11,a=0,n=e;for(n<0&&(n=-n,r=128),n>4095&&(n=4095);(n&t)!==t&&i>=5;)t>>=1,i--;return a=n>>(4===i?1:i-4)&15,(r|i-4<<4|a)^85},s=e=>{let t=0,r=0,i=85^e;128&i&&(i&=-129,t=-1);let a=0;return a=4!=(r=((240&i)>>4)+4)?1<<r|(15&i)<<r-4|1<<r-5:i<<1|1,0===t?a:-a}},8113:(e,t,r)=>{r.d(t,{Ar:()=>y,B5:()=>v,IM:()=>k,IT:()=>C,Jk:()=>T,PF:()=>m,TH:()=>x,Vv:()=>d,_3:()=>S,aJ:()=>g,cN:()=>p,eo:()=>c,iH:()=>f,io:()=>l,mH:()=>u,mP:()=>n,n2:()=>h,th:()=>w,x$:()=>s});var i=r(6194),a=r(8734);class n{constructor(e){this.source=e}requestSlice(e,t){if(this.source._disposed)throw new i.Q;if(e<0||null!==this.fileSize&&e+t>this.fileSize)return null;let r=e+t,a=this.source._read(e,r);return a instanceof Promise?a.then(t=>t?new s(t.bytes,t.view,t.offset,e,r):null):a?new s(a.bytes,a.view,a.offset,e,r):null}requestSliceRange(e,t,r){if(this.source._disposed)throw new i.Q;if(e<0)return null;if(null!==this.fileSize)return this.requestSlice(e,(0,a.qE)(this.fileSize-e,t,r));{let i=this.requestSlice(e,r),n=i=>{if(i)return i;let n=i=>((0,a.vA)(null!==i),this.requestSlice(e,(0,a.qE)(i-e,t,r))),s=this.source._retrieveSize();return s instanceof Promise?s.then(n):n(s)};return i instanceof Promise?i.then(n):n(i)}}}class s{constructor(e,t,r,i,a){this.bytes=e,this.view=t,this.offset=r,this.start=i,this.end=a,this.bufferPos=i-r}static tempFromBytes(e){return new s(e,(0,a.Zc)(e),0,0,e.length)}get length(){return this.end-this.start}get filePos(){return this.offset+this.bufferPos}set filePos(e){this.bufferPos=e-this.offset}get remainingLength(){return Math.max(this.end-this.filePos,0)}skip(e){this.bufferPos+=e}slice(e,t=this.end-e){if(e<this.start||e+t>this.end)throw RangeError("Slicing outside of original slice.");return new s(this.bytes,this.view,this.offset,e,e+t)}}let o=(e,t)=>{if(e.filePos<e.start||e.filePos+t>e.end)throw RangeError(`Tried reading [${e.filePos}, ${e.filePos+t}), but slice is [${e.start}, ${e.end}). This is likely an internal error, please report it alongside the file that caused it.`)},l=(e,t)=>{o(e,t);let r=e.bytes.subarray(e.bufferPos,e.bufferPos+t);return e.bufferPos+=t,r},c=e=>(o(e,1),e.view.getUint8(e.bufferPos++)),d=(e,t)=>{o(e,2);let r=e.view.getUint16(e.bufferPos,t);return e.bufferPos+=2,r},u=e=>{o(e,2);let t=e.view.getUint16(e.bufferPos,!1);return e.bufferPos+=2,t},h=e=>{o(e,3);let t=(0,a.dq)(e.view,e.bufferPos,!1);return e.bufferPos+=3,t},f=e=>{o(e,2);let t=e.view.getInt16(e.bufferPos,!1);return e.bufferPos+=2,t},m=(e,t)=>{o(e,4);let r=e.view.getUint32(e.bufferPos,t);return e.bufferPos+=4,r},p=e=>{o(e,4);let t=e.view.getUint32(e.bufferPos,!1);return e.bufferPos+=4,t},g=e=>{o(e,4);let t=e.view.getUint32(e.bufferPos,!0);return e.bufferPos+=4,t},y=e=>{o(e,4);let t=e.view.getInt32(e.bufferPos,!1);return e.bufferPos+=4,t},b=e=>{o(e,4);let t=e.view.getInt32(e.bufferPos,!0);return e.bufferPos+=4,t},k=(e,t)=>{let r,i;return t?(r=m(e,!0),i=m(e,!0)):(i=m(e,!1),r=m(e,!1)),0x100000000*i+r},w=e=>0x100000000*p(e)+p(e),v=e=>0x100000000*y(e)+p(e),x=e=>{let t=g(e);return 0x100000000*b(e)+t},T=e=>{o(e,4);let t=e.view.getFloat32(e.bufferPos,!1);return e.bufferPos+=4,t},S=e=>{o(e,8);let t=e.view.getFloat64(e.bufferPos,!1);return e.bufferPos+=8,t},C=(e,t)=>{o(e,t);let r="";for(let i=0;i<t;i++)r+=String.fromCharCode(e.bytes[e.bufferPos++]);return r}},8195:(e,t,r)=>{r.d(t,{BF:()=>l,H4:()=>o,H9:()=>s,b0:()=>n,v5:()=>c});var i=r(8113),a=r(7408);let n=27,s=282,o=65307,l=e=>{let t=e.filePos;if((0,i.aJ)(e)!==a.Zk)return null;e.skip(1);let r=(0,i.eo)(e),n=(0,i.TH)(e),s=(0,i.aJ)(e),o=(0,i.aJ)(e),l=(0,i.aJ)(e),c=(0,i.eo)(e),d=new Uint8Array(c);for(let t=0;t<c;t++)d[t]=(0,i.eo)(e);let u=27+c,h=d.reduce((e,t)=>e+t,0);return{headerStartPos:t,totalSize:u+h,dataStartPos:t+u,dataSize:h,headerType:r,granulePosition:n,serialNumber:s,sequenceNumber:o,checksum:l,lacingValues:d}},c=(e,t)=>{for(;e.filePos<t-3;){let t=(0,i.aJ)(e),r=255&t,n=t>>>8&255,s=t>>>16&255,o=t>>>24&255;if(79===r||79===n||79===s||79===o){if(e.skip(-4),t===a.Zk)return!0;e.skip(1)}}return!1}},8244:(e,t,r)=>{r.d(t,{Kh:()=>l,N0:()=>c,Yi:()=>d});var i=r(5799),a=r(2925),n=r(1154),s=r(8734),o=r(5854);class l{constructor(e,t){this.input=e,this._backing=t}isVideoTrack(){return this instanceof c}isAudioTrack(){return this instanceof d}get id(){return this._backing.getId()}get internalCodecId(){return this._backing.getInternalCodecId()}get languageCode(){return this._backing.getLanguageCode()}get name(){return this._backing.getName()}get timeResolution(){return this._backing.getTimeResolution()}get disposition(){return this._backing.getDisposition()}getFirstTimestamp(){return this._backing.getFirstTimestamp()}computeDuration(){return this._backing.computeDuration()}async computePacketStats(e=1/0){let t=new n.kQ(this),r=1/0,i=-1/0,a=0,s=0;for await(let n of t.packets(void 0,void 0,{metadataOnly:!0})){if(a>=e&&n.timestamp>=i)break;r=Math.min(r,n.timestamp),i=Math.max(i,n.timestamp+n.duration),a++,s+=n.byteLength}return{packetCount:a,averagePacketRate:a?Number((a/(i-r)).toPrecision(16)):0,averageBitrate:a?Number((8*s/(i-r)).toPrecision(16)):0}}}class c extends l{constructor(e,t){super(e,t),this._backing=t}get type(){return"video"}get codec(){return this._backing.getCodec()}get codedWidth(){return this._backing.getCodedWidth()}get codedHeight(){return this._backing.getCodedHeight()}get rotation(){return this._backing.getRotation()}get displayWidth(){return this._backing.getRotation()%180==0?this._backing.getCodedWidth():this._backing.getCodedHeight()}get displayHeight(){return this._backing.getRotation()%180==0?this._backing.getCodedHeight():this._backing.getCodedWidth()}getColorSpace(){return this._backing.getColorSpace()}async hasHighDynamicRange(){let e=await this._backing.getColorSpace();return"bt2020"===e.primaries||"smpte432"===e.primaries||"pg"===e.transfer||"hlg"===e.transfer||"bt2020-ncl"===e.matrix}canBeTransparent(){return this._backing.canBeTransparent()}getDecoderConfig(){return this._backing.getDecoderConfig()}async getCodecParameterString(){let e=await this._backing.getDecoderConfig();return e?.codec??null}async canDecode(){try{let e=await this._backing.getDecoderConfig();if(!e)return!1;let t=this._backing.getCodec();if((0,s.vA)(null!==t),a.wb.some(r=>r.supports(t,e)))return!0;if("undefined"==typeof VideoDecoder)return!1;let r=await VideoDecoder.isConfigSupported(e);return!0===r.supported}catch(e){return console.error("Error during decodability check:",e),!1}}async determinePacketType(e){if(!(e instanceof o.Z))throw TypeError("packet must be an EncodedPacket.");if(e.isMetadataOnly)throw TypeError("packet must not be metadata-only to determine its type.");if(null===this.codec)return null;let t=await this.getDecoderConfig();return(0,s.vA)(t),(0,i.PR)(this.codec,t,e.data)}}class d extends l{constructor(e,t){super(e,t),this._backing=t}get type(){return"audio"}get codec(){return this._backing.getCodec()}get numberOfChannels(){return this._backing.getNumberOfChannels()}get sampleRate(){return this._backing.getSampleRate()}getDecoderConfig(){return this._backing.getDecoderConfig()}async getCodecParameterString(){let e=await this._backing.getDecoderConfig();return e?.codec??null}async canDecode(){try{let e=await this._backing.getDecoderConfig();if(!e)return!1;let t=this._backing.getCodec();if((0,s.vA)(null!==t),a.zx.some(r=>r.supports(t,e))||e.codec.startsWith("pcm-"))return!0;{if("undefined"==typeof AudioDecoder)return!1;let t=await AudioDecoder.isConfigSupported(e);return!0===t.supported}}catch(e){return console.error("Error during decodability check:",e),!1}}async determinePacketType(e){if(!(e instanceof o.Z))throw TypeError("packet must be an EncodedPacket.");return null===this.codec?null:"key"}}},8734:(e,t,r)=>{function i(e){if(!e)throw Error("Assertion failed.")}r.d(t,{Au:()=>v,BL:()=>b,Br:()=>P,D5:()=>R,Et:()=>eb,F2:()=>eo,Fo:()=>u,G8:()=>Y,H9:()=>p,HV:()=>T,IP:()=>l,IR:()=>H,KY:()=>$,Kl:()=>L,Kp:()=>em,MW:()=>J,Nu:()=>Q,OO:()=>c,P5:()=>I,SM:()=>S,Sf:()=>ed,Tc:()=>ei,UG:()=>m,Uk:()=>B,Wh:()=>_,Wo:()=>d,XQ:()=>ey,Zc:()=>h,_c:()=>o,_g:()=>n,_h:()=>Z,_j:()=>V,aD:()=>C,aI:()=>q,al:()=>W,b_:()=>ee,dY:()=>et,dq:()=>N,eE:()=>A,fl:()=>x,gm:()=>en,h8:()=>M,i1:()=>U,iP:()=>O,if:()=>ep,in:()=>K,jD:()=>z,ju:()=>eg,nJ:()=>F,oX:()=>eu,pl:()=>E,qE:()=>j,qT:()=>a,rk:()=>eh,sX:()=>ef,su:()=>f,uN:()=>k,vA:()=>i,vv:()=>s,wd:()=>y,x_:()=>w,xb:()=>D,zp:()=>ec});let a=e=>{let t=(e%360+360)%360;if(0===t||90===t||180===t||270===t)return t;throw Error(`Invalid rotation ${e}.`)},n=e=>e&&e[e.length-1],s=e=>e>=0&&e<0x100000000;class o{constructor(e){this.bytes=e,this.pos=0}seekToByte(e){this.pos=8*e}readBit(){let e=Math.floor(this.pos/8),t=this.bytes[e]??0,r=7-(7&this.pos);return this.pos++,(t&1<<r)>>r}readBits(e){if(1===e)return this.readBit();let t=0;for(let r=0;r<e;r++)t<<=1,t|=this.readBit();return t}writeBits(e,t){let r=this.pos+e;for(let e=this.pos;e<r;e++){let i=Math.floor(e/8),a=this.bytes[i],n=7-(7&e);a&=~(1<<n),a|=(t&1<<r-e-1)>>r-e-1<<n,this.bytes[i]=a}this.pos=r}readAlignedByte(){if(this.pos%8!=0)throw Error("Bitstream is not byte-aligned.");let e=this.pos/8,t=this.bytes[e]??0;return this.pos+=8,t}skipBits(e){this.pos+=e}getBitsLeft(){return 8*this.bytes.length-this.pos}clone(){let e=new o(this.bytes);return e.pos=this.pos,e}}let l=e=>{let t=0;for(;0===e.readBits(1)&&t<32;)t++;if(t>=32)throw Error("Invalid exponential-Golomb code.");return(1<<t)-1+e.readBits(t)},c=e=>{let t=l(e);return(1&t)==0?-(t>>1):t+1>>1},d=(e,t,r,i)=>{for(let a=t;a<r;a++){let t=Math.floor(a/8),n=e[t],s=7-(7&a);n&=~(1<<s),n|=(i&1<<r-a-1)>>r-a-1<<s,e[t]=n}},u=e=>e.constructor===Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),h=e=>e.constructor===DataView?e:ArrayBuffer.isView(e)?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(e),f=new TextDecoder,m=new TextEncoder,p=e=>{for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0},g=e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[t,e])),y={bt709:1,bt470bg:5,smpte170m:6,bt2020:9,smpte432:12},b=g(y),k={bt709:1,smpte170m:6,linear:8,"iec61966-2-1":13,pq:16,hlg:18},w=g(k),v={rgb:0,bt709:1,bt470bg:5,smpte170m:6,"bt2020-ncl":9},x=g(v),T=e=>!!e&&!!e.primaries&&!!e.transfer&&!!e.matrix&&void 0!==e.fullRange,S=e=>e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer||ArrayBuffer.isView(e);class C{constructor(){this.currentPromise=Promise.resolve(),this.pending=0}async acquire(){let e;let t=new Promise(t=>{let r=!1;e=()=>{!r&&(t(),this.pending--,r=!0)}}),r=this.currentPromise;return this.currentPromise=t,this.pending++,await r,e}}let P=e=>[...e].map(e=>e.toString(16).padStart(2,"0")).join(""),I=e=>(e=(e=(e=(e=(e=e>>1&0x55555555|(0x55555555&e)<<1)>>2&0x33333333|(0x33333333&e)<<2)>>4&0xf0f0f0f|(0xf0f0f0f&e)<<4)>>8&0xff00ff|(0xff00ff&e)<<8)>>16&65535|(65535&e)<<16)>>>0,E=(e,t,r)=>{let i=0,a=e.length-1,n=-1;for(;i<=a;){let s=i+a>>1,o=r(e[s]);o===t?(n=s,a=s-1):o<t?i=s+1:a=s-1}return n},A=(e,t,r)=>{let i=0,a=e.length-1,n=-1;for(;i<=a;){let s=i+(a-i+1)/2|0;r(e[s])<=t?(n=s,i=s+1):a=s-1}return n},M=(e,t,r)=>{let i=A(e,r(t),r);e.splice(i+1,0,t)},F=()=>{let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}},B=(e,t)=>{for(let r=e.length-1;r>=0;r--)if(t(e[r]))return e[r]},L=(e,t)=>{for(let r=e.length-1;r>=0;r--)if(t(e[r]))return r;return -1},U=async function*(e){Symbol.iterator in e?yield*e[Symbol.iterator]():yield*e[Symbol.asyncIterator]()},R=e=>{if(!(Symbol.iterator in e)&&!(Symbol.asyncIterator in e))throw TypeError("Argument must be an iterable or async iterable.")},D=e=>{throw Error(`Unexpected value: ${e}`)},N=(e,t,r)=>{let i=e.getUint8(t),a=e.getUint8(t+1),n=e.getUint8(t+2);return r?i|a<<8|n<<16:i<<16|a<<8|n},_=(e,t,r)=>N(e,t,r)<<8>>8,z=(e,t,r,i)=>{r>>>=0,r&=0xffffff,i?(e.setUint8(t,255&r),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,r>>>16&255)):(e.setUint8(t,r>>>16&255),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,255&r))},O=(e,t,r,i)=>{(r=j(r,-8388608,8388607))<0&&(r=r+0x1000000&0xffffff),z(e,t,r,i)},V=(e,t,r,i)=>{i?(e.setUint32(t+0,r,!0),e.setInt32(t+4,Math.floor(r/0x100000000),!0)):(e.setInt32(t+0,Math.floor(r/0x100000000),!0),e.setUint32(t+4,r,!0))},$=(e,t)=>({async next(){let r=await e.next();return r.done?{value:void 0,done:!0}:{value:t(r.value),done:!1}},return:()=>e.return(),throw:t=>e.throw(t),[Symbol.asyncIterator](){return this}}),j=(e,t,r)=>Math.max(t,Math.min(r,e)),H="und",q=e=>{let t=Math.round(e);return Math.abs(e/t-1)<10*Number.EPSILON?t:e},K=(e,t)=>Math.round(e/t)*t,W=e=>{let t=0;for(;e;)t++,e>>=1;return t},X=/^[a-z]{3}$/,Q=e=>X.test(e),J=1e6*(1+Number.EPSILON),Z=(e,t)=>{let r={...e,...t};if(e.headers||t.headers){let i=e.headers?G(e.headers):{},a=t.headers?G(t.headers):{},n={...i};Object.entries(a).forEach(([e,t])=>{let r=Object.keys(n).find(t=>t.toLowerCase()===e.toLowerCase());r&&delete n[r],n[e]=t}),r.headers=n}return r},G=e=>{if(e instanceof Headers){let t={};return e.forEach((e,r)=>{t[r]=e}),t}if(Array.isArray(e)){let t={};return e.forEach(([e,r])=>{t[e]=r}),t}return e},Y=async(e,t,r,i,a)=>{let n=0;for(;;)try{return await e(t,r)}catch(r){if(a())throw r;let e=i(++n,r,t);if(null===e)throw r;if(console.error("Retrying failed fetch. Error:",r),!Number.isFinite(e)||e<0)throw TypeError("Retry delay must be a non-negative finite number.");if(e>0&&await new Promise(t=>setTimeout(t,1e3*e)),a())throw r}},ee=(e,t)=>{let r=e<0?-1:1,i=0,a=1,n=1,s=0,o=e=Math.abs(e);for(;;){let e=Math.floor(o),r=e*n+i,l=e*s+a;if(l>t||(i=n,a=s,n=r,s=l,!isFinite(o=1/(o-e))))break}return{numerator:r*n,denominator:s}};class et{constructor(){this.currentPromise=Promise.resolve()}call(e){return this.currentPromise=this.currentPromise.then(e)}}let er=null,ei=()=>null!==er?er:er=!!("undefined"!=typeof navigator&&(navigator.vendor?.match(/apple/i)||/AppleWebKit/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)||/\b(iPad|iPhone|iPod)\b/.test(navigator.userAgent))),ea=null,en=()=>null!==ea?ea:ea="undefined"!=typeof navigator&&navigator.userAgent?.includes("Firefox"),es=null,eo=()=>null!==es?es:es=!!("undefined"!=typeof navigator&&(navigator.vendor?.includes("Google Inc")||/Chrome/.test(navigator.userAgent))),el=null,ec=()=>{if(null!==el)return el;if("undefined"==typeof navigator)return null;let e=/\bChrome\/(\d+)/.exec(navigator.userAgent);return e?el=Number(e[1]):null},ed=(e,t)=>-1!==e?e:t,eu=(e,t,r,i)=>e<=i&&r<=t,eh=function*(e){for(let t in e){let r=e[t];void 0!==r&&(yield{key:t,value:r})}},ef=e=>{switch(e.toLowerCase()){case"image/jpeg":case"image/jpg":return".jpg";case"image/png":return".png";case"image/gif":return".gif";case"image/webp":return".webp";case"image/bmp":return".bmp";case"image/svg+xml":return".svg";case"image/tiff":return".tiff";case"image/avif":return".avif";case"image/x-icon":case"image/vnd.microsoft.icon":return".ico";default:return null}},em=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},ep=e=>{let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)},eg=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},ey=()=>{Symbol.dispose??=Symbol("Symbol.dispose")},eb=e=>"number"==typeof e&&!Number.isNaN(e)},9044:(e,t,r)=>{r.d(t,{IX:()=>f,Ov:()=>g,aU:()=>l,cG:()=>m,p_:()=>u,sY:()=>c});var i,a,n=r(4700),s=r(8734),o=r(8113);!function(e){e[e.Unsynchronisation=128]="Unsynchronisation",e[e.ExtendedHeader=64]="ExtendedHeader",e[e.ExperimentalIndicator=32]="ExperimentalIndicator",e[e.Footer=16]="Footer"}(i||(i={})),function(e){e[e.ISO_8859_1=0]="ISO_8859_1",e[e.UTF_16_WITH_BOM=1]="UTF_16_WITH_BOM",e[e.UTF_16_BE_NO_BOM=2]="UTF_16_BE_NO_BOM",e[e.UTF_8=3]="UTF_8"}(a||(a={}));let l=128,c=10,d=["Blues","Classic rock","Country","Dance","Disco","Funk","Grunge","Hip-hop","Jazz","Metal","New age","Oldies","Other","Pop","Rhythm and blues","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death metal","Pranks","Soundtrack","Euro-techno","Ambient","Trip-hop","Vocal","Jazz & funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound clip","Gospel","Noise","Alternative rock","Bass","Soul","Punk","Space","Meditative","Instrumental pop","Instrumental rock","Ethnic","Gothic","Darkwave","Techno-industrial","Electronic","Pop-folk","Eurodance","Dream","Southern rock","Comedy","Cult","Gangsta","Top 40","Christian rap","Pop/funk","Jungle music","Native US","Cabaret","New wave","Psychedelic","Rave","Showtunes","Trailer","Lo-fi","Tribal","Acid punk","Acid jazz","Polka","Retro","Musical","Rock 'n' roll","Hard rock","Folk","Folk rock","National folk","Swing","Fast fusion","Bebop","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic rock","Progressive rock","Psychedelic rock","Symphonic rock","Slow rock","Big band","Chorus","Easy listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber music","Sonata","Symphony","Booty bass","Primus","Porn groove","Satire","Slow jam","Club","Tango","Samba","Folklore","Ballad","Power ballad","Rhythmic Soul","Freestyle","Duet","Punk rock","Drum solo","A cappella","Euro-house","Dance hall","Goa music","Drum & bass","Club-house","Hardcore techno","Terror","Indie","Britpop","Negerpunk","Polsk punk","Beat","Christian gangsta rap","Heavy metal","Black metal","Crossover","Contemporary Christian","Christian rock","Merengue","Salsa","Thrash metal","Anime","Jpop","Synthpop","Christmas","Art rock","Baroque","Bhangra","Big beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math rock","New romantic","Nu-breakz","Post-punk","Post-rock","Psytrance","Shoegaze","Space rock","Trop rock","World music","Neoclassical","Audiobook","Audio theatre","Neue Deutsche Welle","Podcast","Indie rock","G-Funk","Dubstep","Garage rock","Psybient"],u=(e,t)=>{let r;let i=e.filePos;t.raw??={},t.raw.TAG??=(0,o.io)(e,l-3),e.filePos=i;let a=h(e,30);a&&(t.title??=a);let n=h(e,30);n&&(t.artist??=n);let s=h(e,30);s&&(t.album??=s);let c=Number.parseInt(h(e,4),10);Number.isInteger(c)&&c>0&&(t.date??=new Date(c,0,1));let u=(0,o.io)(e,30);if(0===u[28]&&0!==u[29]){let i=u[29];i>0&&(t.trackNumber??=i),e.skip(-30),r=h(e,28),e.skip(2)}else e.skip(-30),r=h(e,30);r&&(t.comment??=r);let f=(0,o.eo)(e);f<d.length&&(t.genre??=d[f])},h=(e,t)=>{let r=(0,o.io)(e,t),i=(0,s.Sf)(r.indexOf(0),r.length),a=r.subarray(0,i),n="";for(let e=0;e<a.length;e++)n+=String.fromCharCode(a[e]);return n.trimEnd()},f=e=>{let t=e.filePos,r=(0,o.IT)(e,3),i=(0,o.eo)(e),a=(0,o.eo)(e),s=(0,o.eo)(e),l=(0,o.cN)(e);return"ID3"!==r||255===i||255===a||(0x80808080&l)!=0?(e.filePos=t,null):{majorVersion:i,revision:a,flags:s,size:(0,n.Fm)(l)}},m=(e,t,r)=>{if(![2,3,4].includes(t.majorVersion)){console.warn(`Unsupported ID3v2 major version: ${t.majorVersion}`);return}let a=(0,o.io)(e,t.size),n=new p(t,a);if(t.flags&i.Footer&&n.removeFooter(),t.flags&i.Unsynchronisation&&3===t.majorVersion&&n.ununsynchronizeAll(),t.flags&i.ExtendedHeader){let e=n.readU32();3===t.majorVersion?n.pos+=e:n.pos+=e-4}for(;n.pos<=n.bytes.length-n.frameHeaderSize();){let e=n.readId3V2Frame();if(!e)break;let a=n.pos,s=n.pos+e.size,o=!1,l=!1,c=!1;if(3===t.majorVersion?(o=!!(64&e.flags),l=!!(128&e.flags)):4===t.majorVersion&&(o=!!(4&e.flags),l=!!(8&e.flags),c=!!(2&e.flags)||!!(t.flags&i.Unsynchronisation)),o){console.warn(`Skipping encrypted ID3v2 frame ${e.id}`),n.pos=s;continue}if(l){console.warn(`Skipping compressed ID3v2 frame ${e.id}`),n.pos=s;continue}switch(c&&n.ununsynchronizeRegion(n.pos,s),r.raw??={},"T"===e.id[0]?r.raw[e.id]??=n.readId3V2EncodingAndText(s):r.raw[e.id]??=n.readBytes(e.size),n.pos=a,e.id){case"TIT2":case"TT2":r.title??=n.readId3V2EncodingAndText(s);break;case"TIT3":case"TT3":r.description??=n.readId3V2EncodingAndText(s);break;case"TPE1":case"TP1":r.artist??=n.readId3V2EncodingAndText(s);break;case"TALB":case"TAL":r.album??=n.readId3V2EncodingAndText(s);break;case"TPE2":case"TP2":r.albumArtist??=n.readId3V2EncodingAndText(s);break;case"TRCK":case"TRK":{let e=n.readId3V2EncodingAndText(s).split("/"),t=Number.parseInt(e[0],10),i=e[1]&&Number.parseInt(e[1],10);Number.isInteger(t)&&t>0&&(r.trackNumber??=t),i&&Number.isInteger(i)&&i>0&&(r.tracksTotal??=i)}break;case"TPOS":case"TPA":{let e=n.readId3V2EncodingAndText(s).split("/"),t=Number.parseInt(e[0],10),i=e[1]&&Number.parseInt(e[1],10);Number.isInteger(t)&&t>0&&(r.discNumber??=t),i&&Number.isInteger(i)&&i>0&&(r.discsTotal??=i)}break;case"TCON":case"TCO":{let e=n.readId3V2EncodingAndText(s),t=/^\((\d+)\)/.exec(e);if(t){let e=Number.parseInt(t[1]);if(void 0!==d[e]){r.genre??=d[e];break}}if(t=/^\d+$/.exec(e)){let e=Number.parseInt(t[0]);if(void 0!==d[e]){r.genre??=d[e];break}}r.genre??=e}break;case"TDRC":case"TDAT":{let e=new Date(n.readId3V2EncodingAndText(s));Number.isNaN(e.getTime())||(r.date??=e)}break;case"TYER":case"TYE":{let e=Number.parseInt(n.readId3V2EncodingAndText(s),10);Number.isInteger(e)&&(r.date??=new Date(e,0,1))}break;case"USLT":case"ULT":{let e=n.readU8();n.pos+=3,n.readId3V2Text(e,s),r.lyrics??=n.readId3V2Text(e,s)}break;case"COMM":case"COM":{let e=n.readU8();n.pos+=3,n.readId3V2Text(e,s),r.comment??=n.readId3V2Text(e,s)}break;case"APIC":case"PIC":{let e;let i=n.readId3V2TextEncoding();if(2===t.majorVersion){let t=n.readAscii(3);e="PNG"===t?"image/png":"JPG"===t?"image/jpeg":"image/*"}else e=n.readId3V2Text(i,s);let a=n.readU8(),o=n.readId3V2Text(i,s).trimEnd(),l=s-n.pos;if(l>=0){let t=n.readBytes(l);r.images||(r.images=[]),r.images.push({data:t,mimeType:e,kind:3===a?"coverFront":4===a?"coverBack":"unknown",description:o})}}break;default:n.pos+=e.size}n.pos=s}};class p{constructor(e,t){this.header=e,this.bytes=t,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength)}frameHeaderSize(){return 2===this.header.majorVersion?6:10}ununsynchronizeAll(){let e=[];for(let t=0;t<this.bytes.length;t++){let r=this.bytes[t];e.push(r),255===r&&t!==this.bytes.length-1&&0===this.bytes[t]&&t++}this.bytes=new Uint8Array(e),this.view=new DataView(this.bytes.buffer)}ununsynchronizeRegion(e,t){let r=[];for(let i=e;i<t;i++){let e=this.bytes[i];r.push(e),255===e&&i!==t-1&&0===this.bytes[i+1]&&i++}let i=this.bytes.subarray(0,e),a=this.bytes.subarray(t);this.bytes=new Uint8Array(i.length+r.length+a.length),this.bytes.set(i,0),this.bytes.set(r,i.length),this.bytes.set(a,i.length+r.length),this.view=new DataView(this.bytes.buffer)}removeFooter(){this.bytes=this.bytes.subarray(0,this.bytes.length-c),this.view=new DataView(this.bytes.buffer)}readBytes(e){let t=this.bytes.subarray(this.pos,this.pos+e);return this.pos+=e,t}readU8(){let e=this.view.getUint8(this.pos);return this.pos+=1,e}readU16(){let e=this.view.getUint16(this.pos,!1);return this.pos+=2,e}readU24(){let e=this.view.getUint16(this.pos,!1),t=this.view.getUint8(this.pos+1);return this.pos+=3,256*e+t}readU32(){let e=this.view.getUint32(this.pos,!1);return this.pos+=4,e}readAscii(e){let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(this.view.getUint8(this.pos+r));return this.pos+=e,t}readId3V2Frame(){if(2===this.header.majorVersion){let e=this.readAscii(3);return"\0\0\0"===e?null:{id:e,size:this.readU24(),flags:0}}{let e=this.readAscii(4);if("\0\0\0\0"===e)return null;let t=this.readU32(),r=4===this.header.majorVersion?(0,n.Fm)(t):t,i=this.readU16(),a=this.pos,s=e=>{let t=this.pos+e;if(t>this.bytes.length)return!1;if(t<=this.bytes.length-this.frameHeaderSize()){this.pos+=e;let t=this.readAscii(4);if("\0\0\0\0"!==t&&!/[0-9A-Z]{4}/.test(t))return!1}return!0};if(!s(r)){let e=4===this.header.majorVersion?t:(0,n.Fm)(t);s(e)&&(r=e)}return this.pos=a,{id:e,size:r,flags:i}}}readId3V2TextEncoding(){let e=this.readU8();if(e>3)throw Error(`Unsupported text encoding: ${e}`);return e}readId3V2Text(e,t){let r=this.pos,i=this.readBytes(t-this.pos);switch(e){case a.ISO_8859_1:{let e="";for(let t=0;t<i.length;t++){let a=i[t];if(0===a){this.pos=r+t+1;break}e+=String.fromCharCode(a)}return e}case a.UTF_16_WITH_BOM:if(255===i[0]&&254===i[1]){let e=new TextDecoder("utf-16le"),t=(0,s.Sf)(i.findIndex((e,t)=>0===e&&0===i[t+1]&&t%2==0),i.length);return this.pos=r+Math.min(t+2,i.length),e.decode(i.subarray(2,t))}if(254===i[0]&&255===i[1]){let e=new TextDecoder("utf-16be"),t=(0,s.Sf)(i.findIndex((e,t)=>0===e&&0===i[t+1]&&t%2==0),i.length);return this.pos=r+Math.min(t+2,i.length),e.decode(i.subarray(2,t))}{let e=(0,s.Sf)(i.findIndex(e=>0===e),i.length);return this.pos=r+Math.min(e+1,i.length),s.su.decode(i.subarray(0,e))}case a.UTF_16_BE_NO_BOM:{let e=new TextDecoder("utf-16be"),t=(0,s.Sf)(i.findIndex((e,t)=>0===e&&0===i[t+1]&&t%2==0),i.length);return this.pos=r+Math.min(t+2,i.length),e.decode(i.subarray(0,t))}case a.UTF_8:{let e=(0,s.Sf)(i.findIndex(e=>0===e),i.length);return this.pos=r+Math.min(e+1,i.length),s.su.decode(i.subarray(0,e))}}}readId3V2EncodingAndText(e){if(this.pos>=e)return"";let t=this.readId3V2TextEncoding();return this.readId3V2Text(t,e)}}class g{constructor(e){this.helper=new Uint8Array(8),this.helperView=(0,s.Zc)(this.helper),this.writer=e}writeId3V2Tag(e){let t=this.writer.getPos();this.writeAscii("ID3"),this.writeU8(4),this.writeU8(0),this.writeU8(0),this.writeSynchsafeU32(0);let r=this.writer.getPos(),i=new Set;for(let{key:t,value:r}of(0,s.rk)(e))switch(t){case"title":this.writeId3V2TextFrame("TIT2",r),i.add("TIT2");break;case"description":this.writeId3V2TextFrame("TIT3",r),i.add("TIT3");break;case"artist":this.writeId3V2TextFrame("TPE1",r),i.add("TPE1");break;case"album":this.writeId3V2TextFrame("TALB",r),i.add("TALB");break;case"albumArtist":this.writeId3V2TextFrame("TPE2",r),i.add("TPE2");break;case"trackNumber":{let t=void 0!==e.tracksTotal?`${r}/${e.tracksTotal}`:r.toString();this.writeId3V2TextFrame("TRCK",t),i.add("TRCK")}break;case"discNumber":{let t=void 0!==e.discsTotal?`${r}/${e.discsTotal}`:r.toString();this.writeId3V2TextFrame("TPOS",t),i.add("TPOS")}break;case"genre":this.writeId3V2TextFrame("TCON",r),i.add("TCON");break;case"date":this.writeId3V2TextFrame("TDRC",r.toISOString().slice(0,10)),i.add("TDRC");break;case"lyrics":this.writeId3V2LyricsFrame(r),i.add("USLT");break;case"comment":this.writeId3V2CommentFrame(r),i.add("COMM");break;case"images":{let e={coverFront:3,coverBack:4,unknown:0};for(let t of r){let r=e[t.kind]??0,i=t.description??"";this.writeId3V2ApicFrame(t.mimeType,r,i,t.data)}}break;case"tracksTotal":case"discsTotal":case"raw":break;default:(0,s.xb)(t)}if(e.raw)for(let t in e.raw){let r;let n=e.raw[t];if(!(null==n||4!==t.length||i.has(t))){if("string"==typeof n){let e=s.UG.encode(n);(r=new Uint8Array(e.byteLength+2))[0]=a.UTF_8,r.set(e,1)}else{if(!(n instanceof Uint8Array))continue;r=n}this.writeAscii(t),this.writeSynchsafeU32(r.byteLength),this.writeU16(0),this.writer.write(r)}}let n=this.writer.getPos(),o=n-r;return this.writer.seek(t+6),this.writeSynchsafeU32(o),this.writer.seek(n),o+10}writeU8(e){this.helper[0]=e,this.writer.write(this.helper.subarray(0,1))}writeU16(e){this.helperView.setUint16(0,e,!1),this.writer.write(this.helper.subarray(0,2))}writeU32(e){this.helperView.setUint32(0,e,!1),this.writer.write(this.helper.subarray(0,4))}writeAscii(e){for(let t=0;t<e.length;t++)this.helper[t]=e.charCodeAt(t);this.writer.write(this.helper.subarray(0,e.length))}writeSynchsafeU32(e){this.writeU32((0,n.Pj)(e))}writeIsoString(e){let t=new Uint8Array(e.length+1);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);t[e.length]=0,this.writer.write(t)}writeUtf8String(e){let t=s.UG.encode(e);this.writer.write(t),this.writeU8(0)}writeId3V2TextFrame(e,t){let r=(0,s.H9)(t),i=r?t.length:s.UG.encode(t).byteLength;this.writeAscii(e),this.writeSynchsafeU32(1+i+1),this.writeU16(0),this.writeU8(r?a.ISO_8859_1:a.UTF_8),r?this.writeIsoString(t):this.writeUtf8String(t)}writeId3V2LyricsFrame(e){let t=(0,s.H9)(e),r=5+e.length+1;this.writeAscii("USLT"),this.writeSynchsafeU32(r),this.writeU16(0),this.writeU8(t?a.ISO_8859_1:a.UTF_8),this.writeAscii("und"),t?(this.writeIsoString(""),this.writeIsoString(e)):(this.writeUtf8String(""),this.writeUtf8String(e))}writeId3V2CommentFrame(e){let t=(0,s.H9)(e),r=t?e.length:s.UG.encode(e).byteLength;this.writeAscii("COMM"),this.writeSynchsafeU32(5+r+1),this.writeU16(0),this.writeU8(t?a.ISO_8859_1:a.UTF_8),this.writeU8(117),this.writeU8(110),this.writeU8(100),t?(this.writeIsoString(""),this.writeIsoString(e)):(this.writeUtf8String(""),this.writeUtf8String(e))}writeId3V2ApicFrame(e,t,r,i){let n=(0,s.H9)(e)&&(0,s.H9)(r),o=n?r.length:s.UG.encode(r).byteLength,l=1+e.length+1+1+o+1+i.byteLength;this.writeAscii("APIC"),this.writeSynchsafeU32(l),this.writeU16(0),this.writeU8(n?a.ISO_8859_1:a.UTF_8),n?this.writeIsoString(e):this.writeUtf8String(e),this.writeU8(t),n?this.writeIsoString(r):this.writeUtf8String(r),this.writer.write(i)}}},9313:(e,t,r)=>{r.d(t,{Y$:()=>s,gc:()=>n,lh:()=>o});var i=r(8734),a=r(8113);let n=7,s=9,o=e=>{let t=e.filePos,r=(0,a.io)(e,9),n=new i._c(r);if(4095!==n.readBits(12)||(n.skipBits(1),0!==n.readBits(2)))return null;let s=n.readBits(1),o=n.readBits(2)+1,l=n.readBits(4);if(15===l)return null;n.skipBits(1);let c=n.readBits(3);if(0===c)throw Error("ADTS frames with channel configuration 0 are not supported.");n.skipBits(1),n.skipBits(1),n.skipBits(1),n.skipBits(1);let d=n.readBits(13);n.skipBits(11);let u=n.readBits(2)+1;if(1!==u)throw Error("ADTS frames with more than one AAC frame are not supported.");let h=null;return 1===s?e.filePos-=2:h=n.readBits(16),{objectType:o,samplingFrequencyIndex:l,channelConfiguration:c,frameLength:d,numberOfAacFrames:u,crcCheck:h,startPos:t}}},9688:(e,t,r)=>{r.d(t,{QP:()=>eu});let i=e=>{let t=o(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:e=>{let r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),a(r,t)||s(e)},getConflictingClassGroupIds:(e,t)=>{let a=r[e]||[];return t&&i[e]?[...a,...i[e]]:a}}},a=(e,t)=>{if(0===e.length)return t.classGroupId;let r=e[0],i=t.nextPart.get(r),n=i?a(e.slice(1),i):void 0;if(n)return n;if(0===t.validators.length)return;let s=e.join("-");return t.validators.find(({validator:e})=>e(s))?.classGroupId},n=/^\[(.+)\]$/,s=e=>{if(n.test(e)){let t=n.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},o=e=>{let{theme:t,classGroups:r}=e,i={nextPart:new Map,validators:[]};for(let e in r)l(r[e],i,e,t);return i},l=(e,t,r,i)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:c(t,e)).classGroupId=r;return}if("function"==typeof e){if(d(e)){l(e(i),t,r,i);return}t.validators.push({validator:e,classGroupId:r});return}Object.entries(e).forEach(([e,a])=>{l(a,c(t,e),r,i)})})},c=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},d=e=>e.isThemeGetter,u=e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=new Map,i=new Map,a=(a,n)=>{r.set(a,n),++t>e&&(t=0,i=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=i.get(e))?(a(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):a(e,t)}}},h=e=>{let{prefix:t,experimentalParseClassName:r}=e,i=e=>{let t;let r=[],i=0,a=0,n=0;for(let s=0;s<e.length;s++){let o=e[s];if(0===i&&0===a){if(":"===o){r.push(e.slice(n,s)),n=s+1;continue}if("/"===o){t=s;continue}}"["===o?i++:"]"===o?i--:"("===o?a++:")"===o&&a--}let s=0===r.length?e:e.substring(n),o=f(s);return{modifiers:r,hasImportantModifier:o!==s,baseClassName:o,maybePostfixModifierPosition:t&&t>n?t-n:void 0}};if(t){let e=t+":",r=i;i=t=>t.startsWith(e)?r(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(r){let e=i;i=t=>r({className:t,parseClassName:e})}return i},f=e=>e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e,m=e=>{let t=Object.fromEntries(e.orderSensitiveModifiers.map(e=>[e,!0]));return e=>{if(e.length<=1)return e;let r=[],i=[];return e.forEach(e=>{"["===e[0]||t[e]?(r.push(...i.sort(),e),i=[]):i.push(e)}),r.push(...i.sort()),r}},p=e=>({cache:u(e.cacheSize),parseClassName:h(e),sortModifiers:m(e),...i(e)}),g=/\s+/,y=(e,t)=>{let{parseClassName:r,getClassGroupId:i,getConflictingClassGroupIds:a,sortModifiers:n}=t,s=[],o=e.trim().split(g),l="";for(let e=o.length-1;e>=0;e-=1){let t=o[e],{isExternal:c,modifiers:d,hasImportantModifier:u,baseClassName:h,maybePostfixModifierPosition:f}=r(t);if(c){l=t+(l.length>0?" "+l:l);continue}let m=!!f,p=i(m?h.substring(0,f):h);if(!p){if(!m||!(p=i(h))){l=t+(l.length>0?" "+l:l);continue}m=!1}let g=n(d).join(":"),y=u?g+"!":g,b=y+p;if(s.includes(b))continue;s.push(b);let k=a(p,m);for(let e=0;e<k.length;++e){let t=k[e];s.push(y+t)}l=t+(l.length>0?" "+l:l)}return l};function b(){let e,t,r=0,i="";for(;r<arguments.length;)(e=arguments[r++])&&(t=k(e))&&(i&&(i+=" "),i+=t);return i}let k=e=>{let t;if("string"==typeof e)return e;let r="";for(let i=0;i<e.length;i++)e[i]&&(t=k(e[i]))&&(r&&(r+=" "),r+=t);return r},w=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},v=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,x=/^\((?:(\w[\w-]*):)?(.+)\)$/i,T=/^\d+\/\d+$/,S=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,C=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,P=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,I=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,E=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,A=e=>T.test(e),M=e=>!!e&&!Number.isNaN(Number(e)),F=e=>!!e&&Number.isInteger(Number(e)),B=e=>e.endsWith("%")&&M(e.slice(0,-1)),L=e=>S.test(e),U=()=>!0,R=e=>C.test(e)&&!P.test(e),D=()=>!1,N=e=>I.test(e),_=e=>E.test(e),z=e=>!V(e)&&!W(e),O=e=>ee(e,es,D),V=e=>v.test(e),$=e=>ee(e,eo,R),j=e=>ee(e,el,M),H=e=>ee(e,er,D),q=e=>ee(e,ea,_),K=e=>ee(e,D,N),W=e=>x.test(e),X=e=>et(e,eo),Q=e=>et(e,ec),J=e=>et(e,er),Z=e=>et(e,es),G=e=>et(e,ea),Y=e=>et(e,ed,!0),ee=(e,t,r)=>{let i=v.exec(e);return!!i&&(i[1]?t(i[1]):r(i[2]))},et=(e,t,r=!1)=>{let i=x.exec(e);return!!i&&(i[1]?t(i[1]):r)},er=e=>"position"===e,ei=new Set(["image","url"]),ea=e=>ei.has(e),en=new Set(["length","size","percentage"]),es=e=>en.has(e),eo=e=>"length"===e,el=e=>"number"===e,ec=e=>"family-name"===e,ed=e=>"shadow"===e;Symbol.toStringTag;let eu=function(e,...t){let r,i,a;let n=function(o){return i=(r=p(t.reduce((e,t)=>t(e),e()))).cache.get,a=r.cache.set,n=s,s(o)};function s(e){let t=i(e);if(t)return t;let n=y(e,r);return a(e,n),n}return function(){return n(b.apply(null,arguments))}}(()=>{let e=w("color"),t=w("font"),r=w("text"),i=w("font-weight"),a=w("tracking"),n=w("leading"),s=w("breakpoint"),o=w("container"),l=w("spacing"),c=w("radius"),d=w("shadow"),u=w("inset-shadow"),h=w("drop-shadow"),f=w("blur"),m=w("perspective"),p=w("aspect"),g=w("ease"),y=w("animate"),b=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],v=()=>["auto","hidden","clip","visible","scroll"],x=()=>["auto","contain","none"],T=()=>[A,"px","full","auto",W,V,l],S=()=>[F,"none","subgrid",W,V],C=()=>["auto",{span:["full",F,W,V]},W,V],P=()=>[F,"auto",W,V],I=()=>["auto","min","max","fr",W,V],E=()=>[W,V,l],R=()=>["start","end","center","between","around","evenly","stretch","baseline"],D=()=>["start","end","center","stretch"],N=()=>[W,V,l],_=()=>["px",...N()],ee=()=>["px","auto",...N()],et=()=>[A,"auto","px","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",W,V,l],er=()=>[e,W,V],ei=()=>[B,$],ea=()=>["","none","full",c,W,V],en=()=>["",M,X,$],es=()=>["solid","dashed","dotted","double"],eo=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],el=()=>["","none",f,W,V],ec=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",W,V],ed=()=>["none",M,W,V],eu=()=>["none",M,W,V],eh=()=>[M,W,V],ef=()=>[A,"full","px",W,V,l];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[L],breakpoint:[L],color:[U],container:[L],"drop-shadow":[L],ease:["in","out","in-out"],font:[z],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[L],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[L],shadow:[L],spacing:[M],text:[L],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",A,V,W,p]}],container:["container"],columns:[{columns:[M,V,W,o]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...k(),V,W]}],overflow:[{overflow:v()}],"overflow-x":[{"overflow-x":v()}],"overflow-y":[{"overflow-y":v()}],overscroll:[{overscroll:x()}],"overscroll-x":[{"overscroll-x":x()}],"overscroll-y":[{"overscroll-y":x()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:T()}],"inset-x":[{"inset-x":T()}],"inset-y":[{"inset-y":T()}],start:[{start:T()}],end:[{end:T()}],top:[{top:T()}],right:[{right:T()}],bottom:[{bottom:T()}],left:[{left:T()}],visibility:["visible","invisible","collapse"],z:[{z:[F,"auto",W,V]}],basis:[{basis:[A,"full","auto",W,V,o,l]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[M,A,"auto","initial","none",V]}],grow:[{grow:["",M,W,V]}],shrink:[{shrink:["",M,W,V]}],order:[{order:[F,"first","last","none",W,V]}],"grid-cols":[{"grid-cols":S()}],"col-start-end":[{col:C()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":S()}],"row-start-end":[{row:C()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":I()}],"auto-rows":[{"auto-rows":I()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...R(),"normal"]}],"justify-items":[{"justify-items":[...D(),"normal"]}],"justify-self":[{"justify-self":["auto",...D()]}],"align-content":[{content:["normal",...R()]}],"align-items":[{items:[...D(),"baseline"]}],"align-self":[{self:["auto",...D(),"baseline"]}],"place-content":[{"place-content":R()}],"place-items":[{"place-items":[...D(),"baseline"]}],"place-self":[{"place-self":["auto",...D()]}],p:[{p:_()}],px:[{px:_()}],py:[{py:_()}],ps:[{ps:_()}],pe:[{pe:_()}],pt:[{pt:_()}],pr:[{pr:_()}],pb:[{pb:_()}],pl:[{pl:_()}],m:[{m:ee()}],mx:[{mx:ee()}],my:[{my:ee()}],ms:[{ms:ee()}],me:[{me:ee()}],mt:[{mt:ee()}],mr:[{mr:ee()}],mb:[{mb:ee()}],ml:[{ml:ee()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:et()}],w:[{w:[o,"screen",...et()]}],"min-w":[{"min-w":[o,"screen","none",...et()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[s]},...et()]}],h:[{h:["screen",...et()]}],"min-h":[{"min-h":["screen","none",...et()]}],"max-h":[{"max-h":["screen",...et()]}],"font-size":[{text:["base",r,X,$]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,W,j]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",B,V]}],"font-family":[{font:[Q,V,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,W,V]}],"line-clamp":[{"line-clamp":[M,"none",W,j]}],leading:[{leading:[W,V,n,l]}],"list-image":[{"list-image":["none",W,V]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",W,V]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:er()}],"text-color":[{text:er()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...es(),"wavy"]}],"text-decoration-thickness":[{decoration:[M,"from-font","auto",W,$]}],"text-decoration-color":[{decoration:er()}],"underline-offset":[{"underline-offset":[M,"auto",W,V]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:["px",...N()]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",W,V]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",W,V]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...k(),J,H]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",Z,O]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},F,W,V],radial:["",W,V],conic:[F,W,V]},G,q]}],"bg-color":[{bg:er()}],"gradient-from-pos":[{from:ei()}],"gradient-via-pos":[{via:ei()}],"gradient-to-pos":[{to:ei()}],"gradient-from":[{from:er()}],"gradient-via":[{via:er()}],"gradient-to":[{to:er()}],rounded:[{rounded:ea()}],"rounded-s":[{"rounded-s":ea()}],"rounded-e":[{"rounded-e":ea()}],"rounded-t":[{"rounded-t":ea()}],"rounded-r":[{"rounded-r":ea()}],"rounded-b":[{"rounded-b":ea()}],"rounded-l":[{"rounded-l":ea()}],"rounded-ss":[{"rounded-ss":ea()}],"rounded-se":[{"rounded-se":ea()}],"rounded-ee":[{"rounded-ee":ea()}],"rounded-es":[{"rounded-es":ea()}],"rounded-tl":[{"rounded-tl":ea()}],"rounded-tr":[{"rounded-tr":ea()}],"rounded-br":[{"rounded-br":ea()}],"rounded-bl":[{"rounded-bl":ea()}],"border-w":[{border:en()}],"border-w-x":[{"border-x":en()}],"border-w-y":[{"border-y":en()}],"border-w-s":[{"border-s":en()}],"border-w-e":[{"border-e":en()}],"border-w-t":[{"border-t":en()}],"border-w-r":[{"border-r":en()}],"border-w-b":[{"border-b":en()}],"border-w-l":[{"border-l":en()}],"divide-x":[{"divide-x":en()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":en()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...es(),"hidden","none"]}],"divide-style":[{divide:[...es(),"hidden","none"]}],"border-color":[{border:er()}],"border-color-x":[{"border-x":er()}],"border-color-y":[{"border-y":er()}],"border-color-s":[{"border-s":er()}],"border-color-e":[{"border-e":er()}],"border-color-t":[{"border-t":er()}],"border-color-r":[{"border-r":er()}],"border-color-b":[{"border-b":er()}],"border-color-l":[{"border-l":er()}],"divide-color":[{divide:er()}],"outline-style":[{outline:[...es(),"none","hidden"]}],"outline-offset":[{"outline-offset":[M,W,V]}],"outline-w":[{outline:["",M,X,$]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",d,Y,K]}],"shadow-color":[{shadow:er()}],"inset-shadow":[{"inset-shadow":["none",W,V,u]}],"inset-shadow-color":[{"inset-shadow":er()}],"ring-w":[{ring:en()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:er()}],"ring-offset-w":[{"ring-offset":[M,$]}],"ring-offset-color":[{"ring-offset":er()}],"inset-ring-w":[{"inset-ring":en()}],"inset-ring-color":[{"inset-ring":er()}],opacity:[{opacity:[M,W,V]}],"mix-blend":[{"mix-blend":[...eo(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":eo()}],filter:[{filter:["","none",W,V]}],blur:[{blur:el()}],brightness:[{brightness:[M,W,V]}],contrast:[{contrast:[M,W,V]}],"drop-shadow":[{"drop-shadow":["","none",h,W,V]}],grayscale:[{grayscale:["",M,W,V]}],"hue-rotate":[{"hue-rotate":[M,W,V]}],invert:[{invert:["",M,W,V]}],saturate:[{saturate:[M,W,V]}],sepia:[{sepia:["",M,W,V]}],"backdrop-filter":[{"backdrop-filter":["","none",W,V]}],"backdrop-blur":[{"backdrop-blur":el()}],"backdrop-brightness":[{"backdrop-brightness":[M,W,V]}],"backdrop-contrast":[{"backdrop-contrast":[M,W,V]}],"backdrop-grayscale":[{"backdrop-grayscale":["",M,W,V]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[M,W,V]}],"backdrop-invert":[{"backdrop-invert":["",M,W,V]}],"backdrop-opacity":[{"backdrop-opacity":[M,W,V]}],"backdrop-saturate":[{"backdrop-saturate":[M,W,V]}],"backdrop-sepia":[{"backdrop-sepia":["",M,W,V]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",W,V]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[M,"initial",W,V]}],ease:[{ease:["linear","initial",g,W,V]}],delay:[{delay:[M,W,V]}],animate:[{animate:["none",y,W,V]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[m,W,V]}],"perspective-origin":[{"perspective-origin":ec()}],rotate:[{rotate:ed()}],"rotate-x":[{"rotate-x":ed()}],"rotate-y":[{"rotate-y":ed()}],"rotate-z":[{"rotate-z":ed()}],scale:[{scale:eu()}],"scale-x":[{"scale-x":eu()}],"scale-y":[{"scale-y":eu()}],"scale-z":[{"scale-z":eu()}],"scale-3d":["scale-3d"],skew:[{skew:eh()}],"skew-x":[{"skew-x":eh()}],"skew-y":[{"skew-y":eh()}],transform:[{transform:[W,V,"","none","gpu","cpu"]}],"transform-origin":[{origin:ec()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ef()}],"translate-x":[{"translate-x":ef()}],"translate-y":[{"translate-y":ef()}],"translate-z":[{"translate-z":ef()}],"translate-none":["translate-none"],accent:[{accent:er()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:er()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",W,V]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",W,V]}],fill:[{fill:["none",...er()]}],"stroke-w":[{stroke:[M,X,$,j]}],stroke:[{stroke:["none",...er()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}})},9732:(e,t,r)=>{r.d(t,{ON:()=>Y,Yf:()=>B,Z7:()=>W});var i=({instruction:e,lastPoint:t,progress:r})=>({type:"L",x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r});function a(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}}var n=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],s=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],o=[[1],[1,1],[1,2,1],[1,3,3,1]],l=(e,t,r)=>({x:(1-r)*(1-r)*(1-r)*e[0]+3*(1-r)*(1-r)*r*e[1]+3*(1-r)*r*r*e[2]+r*r*r*e[3],y:(1-r)*(1-r)*(1-r)*t[0]+3*(1-r)*(1-r)*r*t[1]+3*(1-r)*r*r*t[2]+r*r*r*t[3]}),c=(e,t,r)=>{let i;let a=r.length-1;if(0===a)return 0;if(0===e){i=0;for(let e=0;e<=a;e++)i+=o[a][e]*(1-t)**(a-e)*t**e*r[e];return i}let n=Array(a);for(let e=0;e<a;e++)n[e]=a*(r[e+1]-r[e]);return c(e-1,t,n)},d=({sx:e,sy:t,t:r})=>{let i;let a=r/2,o=0;for(let r=0;r<20;r++)i=a*n[20][r]+a,o+=s[20][r]*function(e,t,r){let i=c(1,r,e),a=c(1,r,t);return Math.sqrt(i*i+a*a)}(e,t,i);return a*o},u=(e,t,r)=>({x:(1-r)*(1-r)*e[0]+2*(1-r)*r*e[1]+r*r*e[2],y:(1-r)*(1-r)*t[0]+2*(1-r)*r*t[1]+r*r*t[2]}),h=(e,t,r)=>u([3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],[3*(t[1]-t[0]),3*(t[2]-t[1]),3*(t[3]-t[2])],r),f=(e,t,r)=>{void 0===r&&(r=1);let i=e[0]-2*e[1]+e[2],a=t[0]-2*t[1]+t[2],n=2*e[1]-2*e[0],s=2*t[1]-2*t[0],o=4*(i*i+a*a);if(0===o)return r*Math.sqrt((e[2]-e[0])**2+(t[2]-t[0])**2);let l=4*(i*n+a*s)/(2*o),c=r+l,d=(n*n+s*s)/o-l*l,u=c*c+d>0?Math.sqrt(c*c+d):0,h=l*l+d>0?Math.sqrt(l*l+d):0,f=l+Math.sqrt(l*l+d)===0?0:d*Math.log(Math.abs((c+u)/(l+h)));return Math.sqrt(o)/2*(c*u-l*h+f)},m=(e,t,r)=>({x:(1-r)*2*(e[1]-e[0])+2*r*(e[2]-e[1]),y:(1-r)*2*(t[1]-t[0])+2*r*(t[2]-t[1])}),p=({length:e,totalLength:t,func:r})=>{let i=1,a=e/t,n=(e-r(a))/t,s=0;for(;i>.001;){let o=Math.abs(e-r(a+n))/t;if(o<i)i=o,a+=n;else{let s=Math.abs(e-r(a-n))/t;s<i?(i=s,a-=n):n/=2}if(++s>500)break}return a},g=({startX:e,startY:t,cpx:r,cpy:i,x:a,y:n})=>{let s={x:e,y:t},o={x:r,y:i},l={x:a,y:n},c=f([s.x,o.x,l.x,0],[s.y,o.y,l.y,0],1);return{getPointAtLength:e=>{let t=[s.x,o.x,l.x,0],r=[s.y,o.y,l.y,0],i=p({length:e,totalLength:c,func:e=>f(t,r,e)});return u(t,r,i)},getTangentAtLength:e=>{let t;let r=[s.x,o.x,l.x,0],i=[s.y,o.y,l.y,0],a=p({length:e,totalLength:c,func:e=>f(r,i,e)}),n=m(r,i,a),d=Math.sqrt(n.x*n.x+n.y*n.y);return d>0?{x:n.x/d,y:n.y/d}:{x:0,y:0}},getTotalLength:()=>c,getC:()=>l,type:"quadratic-bezier",getD:()=>({x:0,y:0})}},y=({startX:e,startY:t,cp1x:r,cp1y:i,cp2x:a,cp2y:n,x:s,y:o})=>{let c={x:e,y:t},u={x:r,y:i},f={x:a,y:n},m={x:s,y:o},g=d({sx:[c.x,u.x,f.x,m.x],sy:[c.y,u.y,f.y,m.y],t:1});return{getPointAtLength:e=>{let t=[c.x,u.x,f.x,m.x],r=[c.y,u.y,f.y,m.y],i=p({length:e,totalLength:g,func:e=>d({sx:t,sy:r,t:e})});return l(t,r,i)},getTangentAtLength:e=>{let t;let r=[c.x,u.x,f.x,m.x],i=[c.y,u.y,f.y,m.y],a=p({length:e,totalLength:g,func:e=>d({sx:r,sy:i,t:e})}),n=h(r,i,a),s=Math.sqrt(n.x*n.x+n.y*n.y);return s>0?{x:n.x/s,y:n.y/s}:{x:0,y:0}},getTotalLength:()=>g,getC:()=>f,getD:()=>m,type:"cubic-bezier"}},b=({x0:e,x1:t,y0:r,y1:i})=>({getTotalLength:()=>Math.sqrt((e-t)**2+(r-i)**2),getPointAtLength:a=>{let n=a/Math.sqrt((e-t)**2+(r-i)**2),s=(t-e)*(n=Number.isNaN(n)?1:n),o=(i-r)*n;return{x:e+s,y:r+o}},getTangentAtLength:()=>{let a=Math.sqrt((t-e)*(t-e)+(i-r)*(i-r));return{x:(t-e)/a,y:(i-r)/a}},type:"linear"}),k={a:7,A:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0},w=(e,t)=>{let r=[],i=k[t];if(e.length%i!=0)throw Error(`Expected number of arguments of SVG instruction "${t} ${e.join(" ")}" to be a multiple of ${i}`);for(let t=0;t<e.length;t+=i)r.push(e.slice(t,t+i));return r},v=(e,t,r)=>w(e,t).map(e=>r(e)),x=/([astvzqmhlc])([^astvzqmhlc]*)/gi,T=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,S=(e,t)=>{let r=e.match(T);if(!r){if("Z"===t||"z"===t)return[];throw Error(`Malformed path data: ${t} was expected to have numbers afterwards`)}let i=k[t];if(r.length%i!=0)throw Error(`Malformed path data: ${t} was expected to have a multiple of ${i} numbers, but got "${t} ${r.join(" ")} instead"`);return r.map(Number)},C=e=>{if(!e)throw Error("No path provided");let t=e.match(x);if(!t)throw Error(`No path elements found in string ${e}`);return t.map(e=>{let t=e.charAt(0),r=S(e.substring(1),t);if("M"===t&&r.length>2){let e=[];return e.push({type:t,x:r[0],y:r[1]}),e.push(...v(r.slice(2),"L",e=>({type:"L",x:e[0],y:e[1]}))),e}if("m"===t&&r.length>2){let e=[];return e.push({type:t,dx:r[0],dy:r[1]}),e.push(...v(r.slice(2),"l",e=>({type:"l",dx:e[0],dy:e[1]}))),e}if("Z"===t||"z"===t)return[{type:"Z"}];if("A"===t)return v(r,t,e=>({type:t,rx:e[0],ry:e[1],xAxisRotation:e[2],largeArcFlag:1===e[3],sweepFlag:1===e[4],x:e[5],y:e[6]}));if("a"===t)return v(r,t,e=>({type:t,rx:e[0],ry:e[1],xAxisRotation:e[2],largeArcFlag:1===e[3],sweepFlag:1===e[4],dx:e[5],dy:e[6]}));if("C"===t)return v(r,t,e=>({type:t,cp1x:e[0],cp1y:e[1],cp2x:e[2],cp2y:e[3],x:e[4],y:e[5]}));if("c"===t)return v(r,t,e=>({type:t,cp1dx:e[0],cp1dy:e[1],cp2dx:e[2],cp2dy:e[3],dx:e[4],dy:e[5]}));if("S"===t)return v(r,t,e=>({type:t,cpx:e[0],cpy:e[1],x:e[2],y:e[3]}));if("s"===t)return v(r,t,e=>({type:t,cpdx:e[0],cpdy:e[1],dx:e[2],dy:e[3]}));if("H"===t)return v(r,t,e=>({type:t,x:e[0]}));if("h"===t)return v(r,t,e=>({type:t,dx:e[0]}));if("V"===t)return v(r,t,e=>({type:t,y:e[0]}));if("v"===t)return v(r,t,e=>({type:t,dy:e[0]}));if("L"===t||"M"===t)return v(r,t,e=>({type:t,x:e[0],y:e[1]}));if("m"===t||"l"===t)return v(r,t,e=>({type:t,dx:e[0],dy:e[1]}));if("Q"===t)return v(r,t,e=>({type:t,cpx:e[0],cpy:e[1],x:e[2],y:e[3]}));if("q"===t)return v(r,t,e=>({type:t,cpdx:e[0],cpdy:e[1],dx:e[2],dy:e[3]}));if("T"===t)return v(r,t,e=>({type:t,x:e[0],y:e[1]}));if("t"===t)return v(r,t,e=>({type:t,dx:e[0],dy:e[1]}));throw Error(`Invalid path element ${e}`)},[]).flat(1)},P=(e,t)=>{let r=t.x+2/3*(e.cpx-t.x),i=t.y+2/3*(e.cpy-t.y);return{type:"C",cp1x:r,cp1y:i,cp2x:e.x+2/3*(e.cpx-e.x),cp2y:e.y+2/3*(e.cpy-e.y),x:e.x,y:e.y}},I=({segments:e,iterate:t})=>{let r=0,i=0,a=0,n=0,s=null,o=null;return e.map((l,c)=>{let d=t({segment:l,x:r,y:i,prevSegment:e[c-1]??null,initialX:a,initialY:n,cpX:s,cpY:o});switch(l.type){case"M":a=l.x,n=l.y,r=l.x,i=l.y,s=null,o=null;break;case"Q":case"S":r=l.x,i=l.y,s=l.cpx,o=l.cpy;break;case"A":case"L":r=l.x,i=l.y,s=null,o=null;break;case"C":r=l.x,i=l.y,s=l.cp2x,o=l.cp2y;break;case"T":null!==s&&null!==o&&(s=r-(s-r),o=i-(o-i)),r=l.x,i=l.y;break;case"V":i=l.y,s=null,o=null;break;case"H":r=l.x,s=null,o=null;break;case"Z":r=a,i=n,s=null,o=null;break;default:throw Error(`Unexpected instruction ${l.type}`)}return d}).flat(1)},E=2*Math.PI;function A(e,t,r,i){let a=e*r+t*i;return a>1&&(a=1),a<-1&&(a=-1),(e*i-t*r<0?-1:1)*Math.acos(a)}var M=e=>I({segments:e,iterate:({segment:e,prevSegment:t,x:r,y:i,cpX:a,cpY:n})=>{if("H"===e.type)return[{type:"L",x:e.x,y:i}];if("V"===e.type)return[{type:"L",x:r,y:e.y}];if("A"===e.type){let t=function({x1:e,y1:t,x2:r,y2:i,largeArcFlag:a,sweepFlag:n,rx:s,ry:o,phi:l}){let c=Math.sin(l*E/360),d=Math.cos(l*E/360),u=d*(e-r)/2+c*(t-i)/2,h=-c*(e-r)/2+d*(t-i)/2;if(0===u&&0===h||0===s||0===o)return[];let f=u*u/((s=Math.abs(s))*s)+h*h/((o=Math.abs(o))*o);f>1&&(s*=Math.sqrt(f),o*=Math.sqrt(f));let m=function({x1:e,y1:t,x2:r,y2:i,largeArcFlag:a,sweepFlag:n,rx:s,ry:o,sin_phi:l,cos_phi:c}){let d=c*(e-r)/2+l*(t-i)/2,u=-l*(e-r)/2+c*(t-i)/2,h=s*s,f=o*o,m=d*d,p=u*u,g=h*f-h*p-f*m;g<0&&(g=0),g/=h*p+f*m;let y=(g=Math.sqrt(g)*(a===n?-1:1))*s/o*u,b=-(g*o)/s*d,k=(d-y)/s,w=(u-b)/o,v=A(1,0,k,w),x=A(k,w,(-d-y)/s,(-u-b)/o);return!1===n&&x>0&&(x-=E),!0===n&&x<0&&(x+=E),[c*y-l*b+(e+r)/2,l*y+c*b+(t+i)/2,v,x]}({x1:e,y1:t,x2:r,y2:i,largeArcFlag:a,sweepFlag:n,rx:s,ry:o,sin_phi:c,cos_phi:d}),p=[],g=m[2],y=m[3],b=Math.max(Math.ceil(Math.abs(y)/(E/4)),1);y/=b;for(let e=0;e<b;e++)p.push(function(e,t){let r=4/3*Math.tan(t/4),i=Math.cos(e),a=Math.sin(e),n=Math.cos(e+t),s=Math.sin(e+t);return[i,a,i-a*r,a+i*r,n+s*r,s-n*r,n,s]}(g,y)),g+=y;return p.map(e=>{for(let t=0;t<e.length;t+=2){let r=e[t+0],i=e[t+1],a=d*(r*=s)-c*(i*=o),n=c*r+d*i;e[t+0]=a+m[0],e[t+1]=n+m[1]}return e})}({x1:r,y1:i,x2:e.x,y2:e.y,largeArcFlag:e.largeArcFlag,sweepFlag:e.sweepFlag,rx:e.rx,ry:e.ry,phi:e.xAxisRotation});return 0===t.length?[{type:"L",x:e.x,y:e.y}]:t.map(e=>({type:"C",cp1x:e[2],cp1y:e[3],cp2x:e[4],cp2y:e[5],x:e[6],y:e[7]}))}if("T"===e.type){let s=0,o=0;t&&("Q"===t.type||"T"===t.type)?(s=a,o=n):(s=r,o=i);let l=s-r,c=o-i;return[P({type:"Q",cpx:r-l,cpy:i-c,x:e.x,y:e.y},{x:r,y:i})]}if("S"===e.type){let a=0,n=0;t&&"C"===t.type?(a=t.cp2x,n=t.cp2y):t&&"S"===t.type?(a=t.cpx,n=t.cpy):(a=r,n=i);let s=a-r,o=n-i;return[{type:"C",cp1x:r-s,cp1y:i-o,cp2x:e.cpx,cp2y:e.cpy,x:e.x,y:e.y}]}return"Q"===e.type?[P(e,{x:r,y:i})]:[e]}}),F=e=>{if("A"===e.type)return`A ${e.rx} ${e.ry} ${e.xAxisRotation} ${Number(e.largeArcFlag)} ${Number(e.sweepFlag)} ${e.x} ${e.y}`;if("a"===e.type)return`a ${e.rx} ${e.ry} ${e.xAxisRotation} ${Number(e.largeArcFlag)} ${Number(e.sweepFlag)} ${e.dx} ${e.dy}`;if("C"===e.type)return`C ${e.cp1x} ${e.cp1y} ${e.cp2x} ${e.cp2y} ${e.x} ${e.y}`;if("c"===e.type)return`c ${e.cp1dx} ${e.cp1dy} ${e.cp2dx} ${e.cp2dy} ${e.dx} ${e.dy}`;if("S"===e.type)return`S ${e.cpx} ${e.cpy} ${e.x} ${e.y}`;if("s"===e.type)return`s ${e.cpdx} ${e.cpdy} ${e.dx} ${e.dy}`;if("Q"===e.type)return`Q ${e.cpx} ${e.cpy} ${e.x} ${e.y}`;if("q"===e.type)return`q ${e.cpdx} ${e.cpdy} ${e.dx} ${e.dy}`;if("Z"===e.type)return"Z";if("H"===e.type)return`H ${e.x}`;if("h"===e.type)return`h ${e.dx}`;if("V"===e.type)return`V ${e.y}`;if("v"===e.type)return`v ${e.dy}`;if("L"===e.type)return`L ${e.x} ${e.y}`;if("l"===e.type)return`l ${e.dx} ${e.dy}`;if("M"===e.type)return`M ${e.x} ${e.y}`;if("m"===e.type)return`m ${e.dx} ${e.dy}`;if("T"===e.type)return`T ${e.x} ${e.y}`;if("t"===e.type)return`t ${e.dx} ${e.dy}`;throw Error(`Unknown instruction type: ${e.type}`)},B=e=>e.map(e=>F(e)).join(" "),L=e=>{let t=[],r=0,i=0,a=0,n=0;for(let s=0;s<e.length;s++){let o=e[s];if("M"===o.type?(a=o.x,n=o.y):"m"===o.type&&(a+=o.dx,n+=o.dy),"A"===o.type||"C"===o.type||"L"===o.type||"M"===o.type||"Q"===o.type||"S"===o.type||"T"===o.type){t.push(o),r=o.x,i=o.y;continue}if("a"===o.type||"c"===o.type||"l"===o.type||"m"===o.type||"q"===o.type||"s"===o.type||"t"===o.type){let e=r,a=i;if(r+=o.dx,i+=o.dy,"a"===o.type){t.push({type:"A",largeArcFlag:o.largeArcFlag,rx:o.rx,ry:o.ry,sweepFlag:o.sweepFlag,xAxisRotation:o.xAxisRotation,x:r,y:i});continue}if("c"===o.type){t.push({type:"C",cp1x:o.cp1dx+e,cp1y:o.cp1dy+a,cp2x:o.cp2dx+e,cp2y:o.cp2dy+a,x:r,y:i});continue}if("l"===o.type){t.push({type:"L",x:r,y:i});continue}if("m"===o.type){t.push({type:"M",x:r,y:i});continue}if("q"===o.type){t.push({type:"Q",cpx:o.cpdx+e,cpy:o.cpdy+a,x:r,y:i});continue}if("s"===o.type){t.push({type:"S",cpx:o.cpdx+e,cpy:o.cpdy+a,x:r,y:i});continue}if("t"===o.type){t.push({type:"T",x:r,y:i});continue}}if("H"===o.type){t.push(o),r=o.x;continue}if("V"===o.type){t.push(o),i=o.y;continue}if("Z"===o.type){t.push(o),r=a,i=n;continue}if("h"===o.type){r+=o.dx,t.push({type:"H",x:r});continue}if("v"===o.type){i+=o.dy,t.push({type:"V",y:i});continue}throw Error("Unknown instruction type: "+o.type)}return t};function U(e){let t=e[0]-3*e[1]+3*e[2]-e[3];if(1e-8>Math.abs(t))return e[0]===e[3]&&e[0]===e[1]?[e[0],e[3]]:function(e){let t=Math.min(e[0],e[2]),r=Math.max(e[0],e[2]);if(e[1]>e[0]?e[2]>=e[1]:e[2]<=e[1])return[t,r];let i=(e[0]*e[2]-e[1]*e[1])/(e[0]-2*e[1]+e[2]);return i<t?[i,r]:[t,i]}([e[0],-.5*e[0]+1.5*e[1],e[0]-3*e[1]+3*e[2]]);let r=-e[0]*e[2]+e[0]*e[3]-e[1]*e[2]-e[1]*e[3]+e[1]*e[1]+e[2]*e[2];if(r<=0)return[Math.min(e[0],e[3]),Math.max(e[0],e[3])];let i=Math.sqrt(r),a=Math.min(e[0],e[3]),n=Math.max(e[0],e[3]),s=e[0]-2*e[1]+e[2];for(let r=(s+i)/t,o=1;o<=2;r=(s-i)/t,o++)if(r>0&&r<1){let t=e[0]*(1-r)*(1-r)*(1-r)+3*e[1]*(1-r)*(1-r)*r+3*e[2]*(1-r)*r*r+e[3]*r*r*r;t<a&&(a=t),t>n&&(n=t)}return[a,n]}var R=e=>{let t=1/0,r=1/0,i=-1/0,a=-1/0,n=0,s=0,o=0,l=0;for(let c of e)switch(c.type){case"M":o=c.x,l=c.y,t>c.x&&(t=c.x),r>c.y&&(r=c.y),i<c.x&&(i=c.x),a<c.y&&(a=c.y),n=c.x,s=c.y;break;case"L":t>c.x&&(t=c.x),r>c.y&&(r=c.y),i<c.x&&(i=c.x),a<c.y&&(a=c.y),n=c.x,s=c.y;break;case"C":{let e=U([n,c.cp1x,c.cp2x,c.x]);t>e[0]&&(t=e[0]),i<e[1]&&(i=e[1]);let o=U([s,c.cp1y,c.cp2y,c.y]);r>o[0]&&(r=o[0]),a<o[1]&&(a=o[1]),n=c.x,s=c.y;break}case"Z":n=o,s=l;break;default:throw Error(`Unknown instruction ${c.type}`)}return{x1:t,y1:r,x2:i,y2:a,viewBox:`${t} ${r} ${i-t} ${a-r}`,width:i-t,height:a-r}},D=(e,t)=>(e%t+t)%t,N=e=>Math.PI/180*e,_=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),z=(e,t,r)=>Math.min(Math.max(e,t),r),O=(e,t)=>{let r=e.x*t.x+e.y*t.y,i=Math.sqrt((e.x**2+e.y**2)*(t.x**2+t.y**2));return(e.x*t.y-e.y*t.x<0?-1:1)*Math.acos(r/i)},V=({p0:e,rx:t,ry:r,xAxisRotation:i,largeArcFlag:a,sweepFlag:n,p1:s,t:o})=>{t=Math.abs(t),r=Math.abs(r);let l=N(i=D(i,360));if(e.x===s.x&&e.y===s.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(0===t||0===r)return{x:0,y:0,ellipticalArcAngle:0};let c=(e.x-s.x)/2,d=(e.y-s.y)/2,u={x:Math.cos(l)*c+Math.sin(l)*d,y:-Math.sin(l)*c+Math.cos(l)*d},h=u.x**2/t**2+u.y**2/r**2;h>1&&(t*=Math.sqrt(h),r*=Math.sqrt(h));let f=(t**2*r**2-t**2*u.y**2-r**2*u.x**2)/(t**2*u.y**2+r**2*u.x**2),m=(a===n?-1:1)*Math.sqrt(f=f<0?0:f),p={x:m*(t*u.y/r),y:m*(-(r*u.x)/t)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(e.x+s.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(e.y+s.y)/2},y={x:(u.x-p.x)/t,y:(u.y-p.y)/r},b=O({x:1,y:0},y),k=O(y,{x:(-u.x-p.x)/t,y:(-u.y-p.y)/r});!n&&k>0?k-=2*Math.PI:n&&k<0&&(k+=2*Math.PI);let w=b+(k%=2*Math.PI)*o,v=t*Math.cos(w),x=r*Math.sin(w);return{x:Math.cos(l)*v-Math.sin(l)*x+g.x,y:Math.sin(l)*v+Math.cos(l)*x+g.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+k,ellipticalArcAngle:w,ellipticalArcCenter:g,resultantRx:t,resultantRy:r}},$=(e,t)=>{let r;e=e||500;let i=0,a=[],n=[],s=t(0);for(let o=0;o<e;o++){let l=z(1/e*o,0,1);i+=_(s,r=t(l)),n.push([s,r]),a.push({t:l,arcLength:i}),s=r}return r=t(1),n.push([s,r]),i+=_(s,r),a.push({t:1,arcLength:i}),{arcLength:i,arcLengthMap:a,approximationLines:n}},j=({x0:e,y0:t,rx:r,ry:i,xAxisRotate:a,LargeArcFlag:n,SweepFlag:s,x1:o,y1:l})=>{let c=$(300,c=>V({p0:{x:e,y:t},rx:r,ry:i,xAxisRotation:a,largeArcFlag:n,sweepFlag:s,p1:{x:o,y:l},t:c})).arcLength,d=d=>{d<0?d=0:d>c&&(d=c);let u=V({p0:{x:e,y:t},rx:r,ry:i,xAxisRotation:a,largeArcFlag:n,sweepFlag:s,p1:{x:o,y:l},t:d/c});return{x:u.x,y:u.y}};return{getPointAtLength:d,getTangentAtLength:e=>{let t;e<0?e=0:e>c&&(e=c);let r=d(e);e<0?e=0:e>c&&(e=c);let i=(t=e<c-.05?d(e+.05):d(e-.05)).x-r.x,a=t.y-r.y,n=Math.sqrt(i*i+a*a);return e<c-.05?{x:-i/n,y:-a/n}:{x:i/n,y:a/n}},getTotalLength:()=>c,type:"arc"}},H=e=>{let t,r=0,i=[],a=[],n=null,s=[0,0],o=[0,0],l=[0,0],c=[];for(let d=0;d<e.length;d++){let u=e[d];if("m"!==u.type&&"M"!==u.type&&c.length>0&&c[c.length-1].push(u),"M"===u.type&&(l=[(s=[u.x,u.y])[0],s[1]],c.push([u]),a.push(null),0===d&&(n={x:u.x,y:u.y})),"m"===u.type&&(l=[(s=[u.dx+s[0],u.dy+s[1]])[0],s[1]],c.push([{type:"M",x:s[0],y:s[1]}]),a.push(null)),"L"===u.type&&(r+=Math.sqrt((s[0]-u.x)**2+(s[1]-u.y)**2),a.push(b({x0:s[0],x1:u.x,y0:s[1],y1:u.y})),s=[u.x,u.y]),"l"===u.type&&(r+=Math.sqrt(u.dx**2+u.dy**2),a.push(b({x0:s[0],x1:u.dx+s[0],y0:s[1],y1:u.dy+s[1]})),s=[u.dx+s[0],u.dy+s[1]]),"H"===u.type&&(r+=Math.abs(s[0]-u.x),a.push(b({x0:s[0],x1:u.x,y0:s[1],y1:s[1]})),s[0]=u.x),"h"===u.type?(r+=Math.abs(u.dx),a.push(b({x0:s[0],x1:s[0]+u.dx,y0:s[1],y1:s[1]})),s[0]=u.dx+s[0]):"V"===u.type&&(r+=Math.abs(s[1]-u.y),a.push(b({x0:s[0],x1:s[0],y0:s[1],y1:u.y})),s[1]=u.y),"v"===u.type?(r+=Math.abs(u.dy),a.push(b({x0:s[0],x1:s[0],y0:s[1],y1:s[1]+u.dy})),s[1]=u.dy+s[1]):"Z"===u.type&&(r+=Math.sqrt((l[0]-s[0])**2+(l[1]-s[1])**2),a.push(b({x0:s[0],x1:l[0],y0:s[1],y1:l[1]})),s=[l[0],l[1]]),"C"===u.type?(r+=(t=y({startX:s[0],startY:s[1],cp1x:u.cp1x,cp1y:u.cp1y,cp2x:u.cp2x,cp2y:u.cp2y,x:u.x,y:u.y})).getTotalLength(),s=[u.x,u.y],a.push(t)):"c"===u.type&&((t=y({startX:s[0],startY:s[1],cp1x:s[0]+u.cp1dx,cp1y:s[1]+u.cp1dy,cp2x:s[0]+u.cp2dx,cp2y:s[1]+u.cp2dy,x:s[0]+u.dx,y:s[1]+u.dy})).getTotalLength()>0?(r+=t.getTotalLength(),a.push(t),s=[u.dx+s[0],u.dy+s[1]]):a.push(b({x0:s[0],x1:s[0],y0:s[1],y1:s[1]}))),"S"===u.type){let i=e[d-1],n="C"===i.type||"c"===i.type||"S"===i.type||"s"===i.type;if(d>0&&n){if(t){let e=t.getC();t=y({startX:s[0],startY:s[1],cp1x:2*s[0]-e.x,cp1y:2*s[1]-e.y,cp2x:u.cpx,cp2y:u.cpy,x:u.x,y:u.y})}}else t=y({startX:s[0],startY:s[1],cp1x:s[0],cp1y:s[1],cp2x:u.cpx,cp2y:u.cpy,x:u.x,y:u.y});t&&(r+=t.getTotalLength(),s=[u.x,u.y],a.push(t))}if("s"===u.type){let i=e[d-1],n="C"===i.type||"c"===i.type||"S"===i.type||"s"===i.type;if(d>0&&n){if(t){let e=t.getC(),r=t.getD();t=y({startX:s[0],startY:s[1],cp1x:s[0]+r.x-e.x,cp1y:s[1]+r.y-e.y,cp2x:s[0]+u.cpdx,cp2y:s[1]+u.cpdy,x:s[0]+u.dx,y:s[1]+u.dy})}}else t=y({startX:s[0],startY:s[1],cp1x:s[0],cp1y:s[1],cp2x:s[0]+u.cpdx,cp2y:s[1]+u.cpdy,x:s[0]+u.dx,y:s[1]+u.dy});t&&(r+=t.getTotalLength(),s=[u.dx+s[0],u.dy+s[1]],a.push(t))}if("Q"===u.type){if(s[0]===u.cpx&&s[1]===u.cpy){let e=b({x0:u.cpx,x1:u.x,y0:u.cpy,y1:u.y});r+=e.getTotalLength(),a.push(e)}else r+=(t=g({startX:s[0],startY:s[1],cpx:u.cpx,cpy:u.cpy,x:u.x,y:u.y})).getTotalLength(),a.push(t);s=[u.x,u.y],o=[u.cpx,u.cpy]}if("q"===u.type){if(0===u.cpdx&&0===u.cpdy){let e=b({x0:s[0]+u.cpdx,x1:s[0]+u.cpdy,y0:s[1]+u.dx,y1:s[1]+u.dy});r+=e.getTotalLength(),a.push(e)}else r+=(t=g({startX:s[0],startY:s[1],cpx:s[0]+u.cpdx,cpy:s[1]+u.cpdy,x:s[0]+u.dx,y:s[1]+u.dy})).getTotalLength(),a.push(t);o=[s[0]+u.cpdx,s[1]+u.cpdy],s=[u.dx+s[0],u.dy+s[1]]}if("T"===u.type){let i=e[d-1],n="Q"===i.type||"q"===i.type||"T"===i.type||"t"===i.type;if(d>0&&n)t=g({startX:s[0],startY:s[1],cpx:2*s[0]-o[0],cpy:2*s[1]-o[1],x:u.x,y:u.y}),a.push(t),r+=t.getTotalLength();else{let e=b({x0:s[0],x1:u.x,y0:s[1],y1:u.y});a.push(e),r+=e.getTotalLength()}o=[2*s[0]-o[0],2*s[1]-o[1]],s=[u.x,u.y]}if("t"===u.type){let i=e[d-1],n="Q"===i.type||"q"===i.type||"T"===i.type||"t"===i.type;if(d>0&&n)r+=(t=g({startX:s[0],startY:s[1],cpx:2*s[0]-o[0],cpy:2*s[1]-o[1],x:s[0]+u.dx,y:s[1]+u.dy})).getTotalLength(),a.push(t);else{let e=b({x0:s[0],x1:s[0]+u.dx,y0:s[1],y1:s[1]+u.dy});r+=e.getTotalLength(),a.push(e)}o=[2*s[0]-o[0],2*s[1]-o[1]],s=[u.dx+s[0],u.dy+s[1]]}if("A"===u.type){let e=j({x0:s[0],y0:s[1],rx:u.rx,ry:u.ry,xAxisRotate:u.xAxisRotation,LargeArcFlag:u.largeArcFlag,SweepFlag:u.sweepFlag,x1:u.x,y1:u.y});r+=e.getTotalLength(),s=[u.x,u.y],a.push(e)}if("a"===u.type){let e=j({x0:s[0],y0:s[1],rx:u.rx,ry:u.ry,xAxisRotate:u.xAxisRotation,LargeArcFlag:u.largeArcFlag,SweepFlag:u.sweepFlag,x1:s[0]+u.dx,y1:s[1]+u.dy});r+=e.getTotalLength(),s=[s[0]+u.dx,s[1]+u.dy],a.push(e)}i.push(r)}return{segments:c,initialPoint:n,totalLength:r,partialLengths:i,functions:a}},q=e=>H(C(e)),K=e=>q(e).totalLength,W=(e,t)=>{let r=K(t);if(0===e){let e=1.5*r;return{strokeDasharray:`${e} ${e}`,strokeDashoffset:e}}return{strokeDasharray:`${r} ${r}`,strokeDashoffset:r-e*r}},X=(e,t,r,i)=>{let a=[[e,t]];return"Q"===r.type&&a.push([r.cpx,r.cpy]),"C"===r.type&&(a.push([r.cp1x,r.cp1y]),a.push([r.cp2x,r.cp2y])),a.push([r.x,r.y]),(function(e,t=2){let r=[],i=e,a=1/t;for(let e=0;e<t-1;e++){let t=function(e,t){let r=[],i=[];return e.length&&function e(t,a){if(1===t.length)r.push(t[0]),i.push(t[0]);else{let n=Array(t.length-1);for(let e=0;e<n.length;e++)0===e&&r.push(t[0]),e===n.length-1&&i.push(t[e+1]),n[e]=[(1-a)*t[e][0]+a*t[e+1][0],(1-a)*t[e][1]+a*t[e+1][1]];e(n,a)}}(e,t),{left:r,right:i.reverse()}}(i,a/(1-a*e));r.push(t.left),i=t.right}return r.push(i),r})(a,i).map(e=>(function(e){let t=e[e.length-1][0],r=e[e.length-1][1];if(4===e.length){let i=e[1][0],a=e[1][1];return{type:"C",cp1x:i,cp1y:a,cp2x:e[2][0],cp2y:e[2][1],x:t,y:r}}return 3===e.length?P({type:"Q",cpx:e[1][0],cpy:e[1][1],x:t,y:r},{x:e[0][0],y:e[0][1]}):{type:"L",x:t,y:r}})(e))},Q=(e,t,r)=>({type:"L",x:(1-e)*t.x+e*r.x,y:(1-e)*t.y+e*r.y}),J=(e,t,r)=>({type:"C",cp1x:(1-e)*t.cp1x+e*r.cp1x,cp2x:(1-e)*t.cp2x+e*r.cp2x,cp1y:(1-e)*t.cp1y+e*r.cp1y,cp2y:(1-e)*t.cp2y+e*r.cp2y,x:(1-e)*t.x+e*r.x,y:(1-e)*t.y+e*r.y}),Z=(e,t,r)=>({type:"M",x:(1-e)*t.x+e*r.x,y:(1-e)*t.y+e*r.y}),G=(e,t,r)=>e.map(e=>{if("a"===e.type||"c"===e.type||"v"===e.type||"s"===e.type||"h"===e.type||"l"===e.type||"m"===e.type||"q"===e.type||"t"===e.type)return e;if("V"===e.type)return{type:"V",y:e.y+r};if("H"===e.type)return{type:"H",x:e.x+t};if("A"===e.type)return{type:"A",rx:e.rx,ry:e.ry,largeArcFlag:e.largeArcFlag,sweepFlag:e.sweepFlag,xAxisRotation:e.xAxisRotation,x:e.x+t,y:e.y+r};if("Z"===e.type)return e;if("C"===e.type)return{type:"C",cp1x:e.cp1x+t,cp1y:e.cp1y+r,cp2x:e.cp2x+t,cp2y:e.cp2y+r,x:e.x+t,y:e.y+r};if("Q"===e.type)return{type:"Q",cpx:e.cpx+t,cpy:e.cpy+r,x:e.x+t,y:e.y+r};if("S"===e.type)return{type:"S",cpx:e.cpx+t,cpy:e.cpy+r,x:e.x+t,y:e.y+r};if("T"===e.type)return{type:"T",x:e.x+t,y:e.y+r};if("L"===e.type)return{type:"L",x:e.x+t,y:e.y+r};if("M"===e.type)return{type:"M",x:e.x+t,y:e.y+r};throw Error(`Unknown segment type: ${e.type}`)}),Y=(e,t,r)=>B(G(C(e),t,r))},9756:(e,t,r)=>{r.d(t,{Al:()=>u,mw:()=>d});var i=r(697),a=r(3722),n={},s=function(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}},o=e=>{let t=s(),r=setTimeout(()=>{t.reject(Error("Timed out loading Google Font"))},18e3);return Promise.race([e.load().then(()=>{clearTimeout(r)}),t.promise])},l=(e,t,r)=>{let s=Array.isArray(r?.weights)&&Array.isArray(r?.subsets)&&r.weights.length>0&&r.subsets.length>0;if(a.JC.ENABLE_V5_BREAKING_CHANGES&&!s)throw Error("Loading Google Fonts without specifying weights and subsets is not supported in Remotion v5. Please specify the weights and subsets you need.");let l=[],c=t?[t]:Object.keys(e.fonts),d=0;for(let t of c)if("undefined"!=typeof FontFace){if(!e.fonts[t])throw Error(`The font ${e.fontFamily} does not have a style ${t}`);for(let a of r?.weights??Object.keys(e.fonts[t])){if(!e.fonts[t][a])throw Error(`The font ${e.fontFamily} does not  have a weight ${a} in style ${t}`);for(let c of r?.subsets??Object.keys(e.fonts[t][a])){let u=e.fonts[t]?.[a]?.[c];if(!u)throw Error(`weight: ${a} subset: ${c} is not available for '${e.fontFamily}'`);let h=`${e.fontFamily}-${t}-${a}-${c}`,f=n[h];if(f){l.push(f);continue}let m=`Fetching ${e.fontFamily} font ${JSON.stringify({style:t,weight:a,subset:c})}`,p=s?m:`${m}. This might be caused by loading too many font variations. Read more: https://www.remotion.dev/docs/troubleshooting/font-loading-errors#render-timeout-when-loading-google-fonts`,g=(0,i.IH)(p,{timeoutInMilliseconds:6e4});d++;let y=new FontFace(e.fontFamily,`url(${u}) format('woff2')`,{weight:a,style:t,unicodeRange:e.unicodeRanges[c]}),b=2,k=()=>{if("loaded"===y.status){(0,i._8)(g);return}let e=o(y).then(()=>{(r?.document??document).fonts.add(y),(0,i._8)(g)}).catch(e=>{if(n[h]=void 0,0===b)throw e;b--,k()});n[h]=e,l.push(e)};k()}}d>20&&console.warn(`Made ${d} network requests to load fonts for ${e.fontFamily}. Consider loading fewer weights and subsets by passing options to loadFont(). Disable this warning by passing "ignoreTooManyRequestsWarning: true" to "options".`)}return{fontFamily:e.fontFamily,fonts:e.fonts,unicodeRanges:e.unicodeRanges,waitUntilDone:()=>Promise.all(l).then(()=>{})}},c=()=>({fontFamily:"Inter",importName:"Inter",version:"v20",url:"https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900",unicodeRanges:{"cyrillic-ext":"U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F",cyrillic:"U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116","greek-ext":"U+1F00-1FFF",greek:"U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF",vietnamese:"U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB","latin-ext":"U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF",latin:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"},fonts:{italic:{100:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},200:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},300:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},400:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},500:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},600:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},700:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},800:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"},900:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L0UUMJng.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L9UUMJng.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L1UUMJng.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L6UUMJng.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L2UUMJng.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L3UUMJng.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC53FwrK3iLTcvneQg7Ca725JhhKnNqk6L5UUM.woff2"}},normal:{100:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},200:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},300:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},400:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},500:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},600:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},700:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},800:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"},900:{"cyrillic-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2JL7SUc.woff2",cyrillic:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa0ZL7SUc.woff2","greek-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2ZL7SUc.woff2",greek:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1pL7SUc.woff2",vietnamese:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa2pL7SUc.woff2","latin-ext":"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa25L7SUc.woff2",latin:"https://fonts.gstatic.com/s/inter/v20/UcC73FwrK3iLTeHuS_nVMrMxCp50SjIa1ZL7.woff2"}}},subsets:["cyrillic","cyrillic-ext","greek","greek-ext","latin","latin-ext","vietnamese"]}),d="Inter",u=(e,t)=>l(c(),e,t)}}]);